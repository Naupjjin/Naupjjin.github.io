
  <!DOCTYPE html>
  <html lang="en"  >
  <head>
  <meta charset="utf-8">
  

  

  

  <script>window.REIMU_CONFIG = {};window.REIMU_CONFIG.icon_font = '4552607_bq08450reo';window.REIMU_CONFIG.clipboard_tips = {"success":"copy success(*^▽^*)","fail":"copy failed (ﾟ⊿ﾟ)ﾂ","copyright":{"enable":false,"count":50,"content":"Naup"}};window.REIMU_CONFIG.code_block = {"expand":true};</script>
  
  <title>
    HITCON CTF Final 2024 record |
    
    堇姬 Naup&#39;s Blog
  </title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin><link rel="preload" as="style" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7CNoto%20Serif%20SC:400,400italic,700,700italic&display=swap" media="print" onload="this.media&#x3D;&#39;all&#39;">
  
    <link rel="preload" href="//at.alicdn.com/t/c/font_4552607_bq08450reo.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  
  
    
<link rel="stylesheet" href="/css/loader.css">

  
  
    <meta name="description" content="HITCON CTF Final 2024 Author: 堇姬Naup   Team: Starburst Beef Stir-Fried BambooFoxRank: r.k.10 &amp; Taiwan Star  前言這是是跟台灣大聯隊-Starburst Beef Stir-Fried BambooFox，一起參加的，只有四個人在現場打，我是在飯店remote支援(有在會場附近國聯大飯">
<meta property="og:type" content="article">
<meta property="og:title" content="HITCON CTF Final 2024 record">
<meta property="og:url" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/index.html">
<meta property="og:site_name" content="堇姬 Naup&#39;s Blog">
<meta property="og:description" content="HITCON CTF Final 2024 Author: 堇姬Naup   Team: Starburst Beef Stir-Fried BambooFoxRank: r.k.10 &amp; Taiwan Star  前言這是是跟台灣大聯隊-Starburst Beef Stir-Fried BambooFox，一起參加的，只有四個人在現場打，我是在飯店remote支援(有在會場附近國聯大飯">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/1.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/2.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/3.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/4.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/5_0.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/5.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/6.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/7.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/8.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/9.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/10.png">
<meta property="og:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/11.png">
<meta property="article:published_time" content="2024-11-11T10:53:02.000Z">
<meta property="article:modified_time" content="2025-01-21T12:44:57.387Z">
<meta property="article:author" content="Naup堇姬">
<meta property="article:tag" content="web">
<meta property="article:tag" content="CTF">
<meta property="article:tag" content="writeup">
<meta property="article:tag" content="HITCON">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/2024/11/11/HITCON-CTF-Final-2024/1.png">
  
  
    <link rel="alternate" href="/atom.xml" title="堇姬 Naup's Blog" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/images/fav.ico">
  
  
<link rel="stylesheet" href="/css/style.css">

  <link rel="preload" href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
  
  
  
  
    
<script src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js" integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script>

  
  
    
<link rel="stylesheet" href="https://npm.webcache.cn/@reimujs/aos@0.1.0/dist/aos.css">

  
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 7.1.1"></head>

  <body>
    
  <div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi">
        
          <svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
           M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg>
        
      </div>
      <div class="loading-word">Naup...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script>

<div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>


    <div id="container">
      <div id="wrap">
        <div id="header-nav">
  <nav id="main-nav">
    
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/">Home</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/archives">Archives</a>
        </span>
      
        <span class="main-nav-link-wrap">
          <div class="main-nav-icon icon rotate">
            &#xe62b;
          </div>
          <a class="main-nav-link" href="/about">About</a>
        </span>
      
    
    <a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed" target="_blank"></a>
    
    
    
  </nav>
</div>
<header id="header">
  
    <picture></picture>
    <img fetchpriority="high" src="/images/posts_cover/HITCON-CTF-Final-2024/HITCON-CTF-Final-2024.webp" alt="HITCON CTF Final 2024 record">
  
  <div id="header-outer">
    <div id="header-title">
      
        
        
          <a href="/" id="logo">
            <h1 data-aos="slide-up">HITCON CTF Final 2024 record</h1>
          </a>
        
      
      
        
        <h2 id="subtitle-wrap" data-aos="slide-down">
          
        </h2>
      
    </div>
  </div>
</header>

        <div id="content"  class="sidebar-right" >
          <aside id="sidebar">
  
  
  <div class="sidebar-wrapper wrap-sticky">
    <div class="sidebar-wrap" data-aos="fade-up">
      
        <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HITCON-CTF-Final-2024"><span class="toc-number">1.</span> <span class="toc-text">HITCON CTF Final 2024</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day1"><span class="toc-number">1.2.</span> <span class="toc-text">Day1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#attack"><span class="toc-number">1.2.1.</span> <span class="toc-text">attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#patch%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">patch方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#auto-patch"><span class="toc-number">1.2.3.</span> <span class="toc-text">auto patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B7%B7%E6%B7%86-%E7%9C%8B%E5%88%A5%E5%B0%8Dpatch"><span class="toc-number">1.2.4.</span> <span class="toc-text">解混淆(看別對patch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A4%A9-Score-board"><span class="toc-number">1.2.5.</span> <span class="toc-text">第一天 Score board</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAY-2"><span class="toc-number">1.3.</span> <span class="toc-text">DAY 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%96%8B%E8%B3%BD"><span class="toc-number">1.3.1.</span> <span class="toc-text">開賽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BE%E4%B8%80%E4%BA%9B%E6%88%91%E5%80%91%E4%B8%8A%E7%9A%84patch"><span class="toc-number">1.3.2.</span> <span class="toc-text">放一些我們上的patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E8%AE%8A%E7%AD%96%E7%95%A5"><span class="toc-number">1.3.3.</span> <span class="toc-text">改變策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B7%E6%B7%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A4%A9score-board"><span class="toc-number">1.3.5.</span> <span class="toc-text">第二天score board</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%8C%E8%A8%98"><span class="toc-number">1.4.</span> <span class="toc-text">後記</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Naup堇姬" class="lazyload">
  <div class="sidebar-author-name">Naup堇姬</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">57</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=naup96721@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/Naupjjin itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
      
      
        <div class="sidebar-btn-wrapper" style="position:static">
          <div class="sidebar-toc-btn current"></div>
          <div class="sidebar-common-btn"></div>
        </div>
      
    </div>
  </div>

  <div class="sidebar-widget">
  
  </div>
</aside>

          <section id="main"><article id="post-HITCON-CTF-Final-2024" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-inner" data-aos="fade-up">
    <div class="article-meta">
      <div class="article-date">
  <a href="/2024/11/11/HITCON-CTF-Final-2024/" class="article-date-link" data-aos="zoom-in">
    <time datetime="2024-11-11T10:53:02.000Z" itemprop="datePublished">2024-11-11</time>
    <time style="display: none;" id="post-update-time">2025-01-21</time>
  </a>
</div>

      

    </div>
    <div class="hr-line"></div>
    

    <div class="e-content article-entry" itemprop="articleBody">
      
      
        <h1 id="HITCON-CTF-Final-2024"><a href="#HITCON-CTF-Final-2024" class="headerlink" title="HITCON CTF Final 2024"></a>HITCON CTF Final 2024</h1><blockquote>
<p>Author: 堇姬Naup</p>
</blockquote>
<blockquote>
<p>Team: Starburst Beef Stir-Fried BambooFox<br>Rank: r.k.10 &amp; Taiwan Star</p>
</blockquote>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>這是是跟台灣大聯隊-Starburst Beef Stir-Fried BambooFox，一起參加的，只有四個人在現場打，我是在飯店remote支援(有在會場附近國聯大飯店、交大、一些線上的人)</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/1.png" class="">

<p>賽程在這裡</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/2.png" class="">


<p>先說一下這次的結果<br>我們是第10名及拿到了Taiwan star<br>接下來開始講講這兩天的過程吧</p>
<h2 id="Day1"><a href="#Day1" class="headerlink" title="Day1"></a>Day1</h2><p>第一天一開始主辦方infra貌似直接燒起來，延後了半小時開賽<br>開賽後先放出了一題KoH一題A&amp;D，之後又放出了一題<br>KoH-ed25519<br>A&amp;D-ucontex<br>A&amp;D-fulu</p>
<p>我這兩天幾乎都花時間在第一題KoH上，另外我也是第一題第一天下半場的PM(caleb那時候跑去看其他題了)</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/3.png" class="">


<p>先來介紹一下第一題(我有留提敘)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line">About</span><br><span class="line">There are 2 main tasks to do in this challenge:</span><br><span class="line"></span><br><span class="line">Creating challenges: Write a Python program (which embeds a private key) that signs arbitrary input using Ed25519.</span><br><span class="line">Breaking challenges: Extract the private key from other teams&#x27; program.</span><br><span class="line"></span><br><span class="line">Here, a challenge consists of a program and a corresponding public key.</span><br><span class="line">A program is a Python script that contains a sign(data: bytes) -&gt; bytes function, which signs the input data using the embedded private key with Ed25519 and returns the signature.</span><br><span class="line">And the public key, a base64-encoded 32-bytes value, must correspond to the private key embedded in the program.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In this challenge, most of the operations will be done using the CLI. You can also directly interact with the API of this challenge, the docs can be found here.</span><br><span class="line"></span><br><span class="line">Creating challenges</span><br><span class="line">To create a challenge, you would first generate a Ed25519 keypair, and write a Python program with sign(data: bytes) -&gt; bytes function that signs the input data using the private key. And you would need to make it as hard as possible for others to extract the private key from the program.</span><br><span class="line">To submit a challenge, you would need to provide the public key and the program and our system will check if the generated signature is correct. (Actually, you also need a proof to show that you know the private key to the public key, which will be explained later.)</span><br><span class="line">Note: Creating a challenge only means it is now uploaded to the server, but it is still not public for others to break. You still have a create a patch from the challenge (by providing challenge id) to actually deploy it. See the later sections for more details.</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">In checker.zip, you can find some valid example programs in the example directory.</span><br><span class="line">env.Dockerfile documents the environment that the programs will run in, and the check.py can be used to verify if your program matches the public key locally (our system also uses the same code to check if a challenge is valid).</span><br><span class="line"></span><br><span class="line">The signing function should not be to slow: it should be able to create 3 signatures in ~3 seconds. The max size limit of the entire program is ~10MB (minus some other data needed to POST /api/challenge/ api).</span><br><span class="line"></span><br><span class="line">Proof</span><br><span class="line">To prevent teams from directly reusing challenges made by others, we require a proof to show that the submitter knows the private key to the public key. The proof here is actually a Schnorr signature, but you don&#x27;t really need to understand what it is.</span><br><span class="line">In the provided CLI file, there is a proofs folder which contains a Go program that generates the proofs for you. Either one of the following two combinations can be used to generate a proof:</span><br><span class="line"></span><br><span class="line">Public key + Private key</span><br><span class="line">Public key + Multiplier</span><br><span class="line">The multiplier is a number, which is the discrete logarithm between the public key and the Ed25519 base point. Per EdDSA specification, the multiplier is a hash of the private key.</span><br><span class="line">Breaking challenges</span><br><span class="line">Breaking challenges involves the following steps:</span><br><span class="line"></span><br><span class="line">Download others teams challenges (which contains the public key and the program) using CLI or API.</span><br><span class="line">Extract the private key (or the multiplier) from other teams&#x27; programs by reversing it.</span><br><span class="line">Use the extracted values to generate a proof and submit it to the system.</span><br><span class="line">How the game works</span><br><span class="line">First of all, the is a KoTH challenge, so every round your team will have a ranking which contributes some scores to the entire CTF competition. The points at every round are independent of each other, and teams with higher points will have a higher ranking.</span><br><span class="line"></span><br><span class="line">Patch</span><br><span class="line">Patch is simply a reference to an existing challenge that you have created before. Every team will only have one active patch at any given round, which correspond to a challenge that everyone can try to break.</span><br><span class="line">When you create a patch (by providing a existing challenge id) at round n, then it will be available for others to break at round n+1 (becomes the active patch of your team). At the same time, your team will be deducted 500 points for round n+1 as a penalty.</span><br><span class="line"></span><br><span class="line">For example, Team 1 creates a patch at round 3 with challenge id 1337 and create another patch at round 5 with challenge id 7331. Then the active patch (challenge) for Team 1 would be:</span><br><span class="line"></span><br><span class="line">Round	1	2	3*	4	5*	6	7</span><br><span class="line">Active Patch	Initial	Initial	Initial	1337	1337	7331	7331</span><br><span class="line">Note: The * indicates the round where the patch is submitted.</span><br><span class="line">Initial means the initial (trivial) challenge that is generated by the system for every team at the start, which is also available for other teams to break.</span><br><span class="line"></span><br><span class="line">Attack</span><br><span class="line">Submitting a correct proof for an active patch is called an attack, and you can attack any active patch at any round.</span><br><span class="line">On round n, if you attack other team&#x27;s active patch at round m, you would gain s=1000*exp(-(n-m)/24) points for round n, and the team being attacked would lose s*0.3 points at round n. (Decimals are rounded to the nearest integer)</span><br><span class="line">Note: If an attack succeeds, you can no longer attack the same patch again (solely determined by team id and round number), so you carefully decide whether an attack is worth it or not.</span><br><span class="line"></span><br><span class="line">For example, on round 8, Team 2 may attack Team 1&#x27;s active patch at round 4 and gain some points on round 8.</span><br><span class="line">Next round at round 9, Team 2 can attack Team 1&#x27;s active patch at round 5 and gain some points on round 9. While both active patches refer to the same challenge 1337, they are considered different patches because the round number is different.</span><br><span class="line"></span><br><span class="line">Scoring</span><br><span class="line">Every teams score will always be non-negative, and the final ranking recorded by the CTF platform only includes the teams with non-zero scores in that round (i.e. Getting 0 score will not give you any points). Please refer to the CTF rules for the CTF score (not the score for the challenge) you will actually get for each ranking.</span><br></pre></td></tr></table></figure>
<p>有一些檔案比較重要的</p>
<ul>
<li>proof: 這資料夾底下裡面有負責驗證你的patch是否滿足條件的檔案，下載下來需要先裝golang編譯他。之後要用可以直接調用他提供的check.py來去驗證你的patch</li>
<li>check.zip: 裡面有一些example、dockerfile、check.py、genkey.py來說說後面兩個</li>
<li>genkey.py會生成一對<br>Public key + Private key 或是<br>Public key + Multiplier<br>你需要將後面的塞到你的patch裡面，對他做混淆來隱藏key</li>
<li>check.py: 可以在本地去做patch check<br><code>python check.py -s yourpatch.py -p pub.key</code><br>另外他需要你提供一對鑰匙來去驗證，這樣你在無法破解其他隊伍的狀況下無法直接抄patch，然後我們要嘗試把私鑰塞進去他會去做<br>裡面也有seccomp掉一些syscall是無法用跟可以用的<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">SECCOMP = <span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">from seccomp import *</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">f = SyscallFilter(defaction=KILL)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;access&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;arch_prctl&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;brk&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;close&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;dup2&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;epoll_create1&#x27;)</span></span><br><span class="line"><span class="string">f.add_rule(ALLOW, &#x27;faccessat2&#x27;)</span></span><br><span class="line"><span class="string">...</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure></li>
<li>client.py: 可以去上patch、攻擊等等的</li>
</ul>
<p>回來看到題目介面，他有4個，重要的有三個</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/4.png" class="">

<ul>
<li>score board: 每round都會計分，並排出名次了加到總積分上，規則如下<img src="/2024/11/11/HITCON-CTF-Final-2024/5_0.png" class=""></li>
<li>patch: 可以找到每round的patch，並把他載下來分析<img src="/2024/11/11/HITCON-CTF-Final-2024/5.png" class=""></li>
<li>attack: 會看到你在哪輪有打通哪輪對伍的patch<img src="/2024/11/11/HITCON-CTF-Final-2024/6.png" class=""></li>
</ul>
<h3 id="attack"><a href="#attack" class="headerlink" title="attack"></a>attack</h3><p>主要要調的就是round數、隊伍id和key</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># attack1.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.ed25519 <span class="keyword">import</span> Ed25519PrivateKey</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"></span><br><span class="line">keys = &#123;</span><br><span class="line">    <span class="number">5</span>: <span class="string">&quot;SszuK1VXBDVWyZ5F9sfhiiYVmWd9oiylpzI1X1V5NhY=&quot;</span>, <span class="comment">#31</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">round</span> = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;round&quot;</span>])</span><br><span class="line"><span class="built_in">round</span> = <span class="built_in">int</span>(<span class="built_in">round</span>.split(<span class="string">b&quot;Round: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">fail = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">13</span>,<span class="number">14</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;round: &quot;</span>,<span class="built_in">str</span>(i))</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> keys:</span><br><span class="line">        privkey = keys[t]</span><br><span class="line">        sk = Ed25519PrivateKey.from_private_bytes(b64decode(privkey))</span><br><span class="line">        pubkey = b64encode(sk.public_key().public_bytes_raw())</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            r = subprocess.check_output([<span class="string">&quot;./proofs/bin/prove&quot;</span>, <span class="string">&quot;-sk&quot;</span>, privkey, <span class="string">&quot;-pk&quot;</span>, pubkey])</span><br><span class="line">            r = r.decode()</span><br><span class="line">            r = <span class="built_in">str</span>.strip(r)</span><br><span class="line">            <span class="built_in">print</span>(<span class="string">f&quot;== <span class="subst">&#123;t&#125;</span> ==&quot;</span>)</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                res = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;attack&quot;</span>, <span class="built_in">str</span>(i), <span class="built_in">str</span>(t), r])</span><br><span class="line">                <span class="built_in">print</span>(res.decode())</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                fail.append(t)</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            fail.append(t)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span> fail <span class="subst">&#123;fail&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># attack2.py</span></span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.ed25519 <span class="keyword">import</span> Ed25519PrivateKey</span><br><span class="line"></span><br><span class="line">keys = &#123;</span><br><span class="line">    <span class="number">9</span>: [<span class="string">&quot;KR/PivJHqNeK3BDuwq1KGQi0sak6m1tMVYwp1hRv9AU=&quot;</span>, <span class="string">&quot;0x62a0c5fc36bc300d0676705be4d7562853b633c3cc142414a5833a70439e1101&quot;</span>]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="built_in">round</span> = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;round&quot;</span>])</span><br><span class="line"><span class="built_in">round</span> = <span class="built_in">int</span>(<span class="built_in">round</span>.split(<span class="string">b&quot;Round: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span>&quot;</span>)</span><br><span class="line"></span><br><span class="line">fail = []</span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> keys:</span><br><span class="line">    <span class="comment"># privkey = keys[t]</span></span><br><span class="line">    <span class="comment"># sk = Ed25519PrivateKey.from_private_bytes(b64decode(privkey))</span></span><br><span class="line">    <span class="comment"># pubkey = b64encode(sk.public_key().public_bytes_raw())</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        r = subprocess.check_output([<span class="string">&quot;./proofs/bin/prove&quot;</span>, <span class="string">&quot;-pk&quot;</span>, keys[t][<span class="number">0</span>], <span class="string">&quot;-mul&quot;</span>, keys[t][<span class="number">1</span>]])</span><br><span class="line">        r = r.decode()</span><br><span class="line">        r = <span class="built_in">str</span>.strip(r)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;== <span class="subst">&#123;t&#125;</span> ==&quot;</span>)</span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            res = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;attack&quot;</span>, <span class="built_in">str</span>(<span class="number">81</span>), <span class="built_in">str</span>(t), r])</span><br><span class="line">            <span class="built_in">print</span>(res.decode())</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            fail.append(t)</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        fail.append(t)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;round <span class="subst">&#123;<span class="built_in">round</span>&#125;</span> fail <span class="subst">&#123;fail&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># attack3.py</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.ed25519 <span class="keyword">import</span> Ed25519PrivateKey, Ed25519PublicKey</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;keys.json&quot;</span>,<span class="string">&quot;r&quot;</span>)</span><br><span class="line">keys = json.load(f)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">save</span>():</span><br><span class="line">    f = <span class="built_in">open</span>(<span class="string">&quot;keys.json&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">    json.dump(keys, f, indent=<span class="number">2</span>)</span><br><span class="line">    f.close()</span><br><span class="line">    exit(<span class="number">0</span>)</span><br><span class="line"><span class="built_in">round</span> = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;round&quot;</span>])</span><br><span class="line"><span class="built_in">round</span> = <span class="built_in">int</span>(<span class="built_in">round</span>.decode().split(<span class="string">&quot;Round: &quot;</span>)[<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line">success_cnt = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> t <span class="keyword">in</span> keys:</span><br><span class="line">    k = keys[t]</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> k:</span><br><span class="line">        active = key[<span class="string">&quot;active&quot;</span>]</span><br><span class="line">        last = key[<span class="string">&quot;last&quot;</span>]</span><br><span class="line">        sk = Ed25519PrivateKey.from_private_bytes(b64decode(key[<span class="string">&quot;key&quot;</span>]))</span><br><span class="line">        pubkey = b64encode(sk.public_key().public_bytes_raw())</span><br><span class="line"></span><br><span class="line">        r = subprocess.check_output([<span class="string">&quot;./proofs/bin/prove&quot;</span>,<span class="string">&quot;-sk&quot;</span>,key[<span class="string">&quot;key&quot;</span>],<span class="string">&quot;-pk&quot;</span>,pubkey], stderr=subprocess.DEVNULL)</span><br><span class="line">        r = r.decode()</span><br><span class="line">        r = <span class="built_in">str</span>.strip(r)</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> last == -<span class="number">1</span>:</span><br><span class="line">            max_round = <span class="built_in">round</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            max_round = last - <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(active, max_round+<span class="number">1</span>):</span><br><span class="line">            <span class="keyword">if</span> i <span class="keyword">in</span> key[<span class="string">&quot;used&quot;</span>]:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> success_cnt &gt; <span class="number">8</span>:</span><br><span class="line">                save()</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                res = subprocess.check_output([<span class="string">&quot;python3&quot;</span>,<span class="string">&quot;client.py&quot;</span>,<span class="string">&quot;attack&quot;</span>, <span class="built_in">str</span>(i), <span class="built_in">str</span>(t), r])</span><br><span class="line">                <span class="keyword">if</span> <span class="string">b&#x27;success&#x27;</span> <span class="keyword">in</span> res:</span><br><span class="line">                    <span class="keyword">if</span> <span class="string">b&#x27;already&#x27;</span> <span class="keyword">not</span> <span class="keyword">in</span> res:</span><br><span class="line">                        success_cnt += <span class="number">1</span></span><br><span class="line">                        <span class="built_in">print</span>(res)</span><br><span class="line">                    key[<span class="string">&quot;used&quot;</span>].append(i)</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                key[<span class="string">&quot;last&quot;</span>] = i</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">save()</span><br></pre></td></tr></table></figure>
<p>有沒有打通都會告訴你</p>
<h3 id="patch方法"><a href="#patch方法" class="headerlink" title="patch方法"></a>patch方法</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python3 genkey.py -s PRIVATE_KEY -p PUBLICKEY</span><br><span class="line"></span><br><span class="line">python3 client.py chal create -s private_key -p public_key --program sign_obfued.py</span><br><span class="line"></span><br><span class="line">python3 client.py patch create &#123;challenge_id&#125;</span><br></pre></td></tr></table></figure>

<h3 id="auto-patch"><a href="#auto-patch" class="headerlink" title="auto patch"></a>auto patch</h3><p>我們對伍 triangle snake一開始有寫了一個auto patch，裡面有寫簡單的混淆跟自動上patch的工具，第一天就靠這東西一路到底</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">os.popen(<span class="string">&quot;python3 genkey.py -s private_key -p public_key&quot;</span>)</span><br><span class="line"></span><br><span class="line">time.sleep(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">private_key = <span class="built_in">open</span>(<span class="string">&quot;private_key&quot;</span>, <span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">base64 = private_key</span><br><span class="line"></span><br><span class="line">lst = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">len</span>(base64) // <span class="number">26</span> == <span class="number">0</span>:</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">            lst.append(<span class="string">f&quot;<span class="subst">&#123;string.ascii_lowercase[i]&#125;</span> = &#x27;<span class="subst">&#123;base64[i]&#125;</span>&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">            lst.append(<span class="string">f&quot;<span class="subst">&#123;string.ascii_lowercase[i]&#125;</span> = &#x27;&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line"></span><br><span class="line">        lst.append(<span class="string">f&quot;<span class="subst">&#123;string.ascii_lowercase[i]&#125;</span> = &#x27;<span class="subst">&#123;base64[(<span class="built_in">len</span>(base64)//<span class="number">26</span>+<span class="number">1</span>)*i:(<span class="built_in">len</span>(base64)//<span class="number">26</span>+<span class="number">1</span>)*(i+<span class="number">1</span>)]&#125;</span>&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line"></span><br><span class="line">        lst.append(<span class="string">f&quot;<span class="subst">&#123;string.ascii_lowercase[i]&#125;</span> = &#x27;&#x27;&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">random.shuffle(lst)</span><br><span class="line"></span><br><span class="line">data = <span class="string">&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> lst:</span><br><span class="line"></span><br><span class="line">    data+=i+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(random.randint(<span class="number">10</span>, <span class="number">26</span>)):</span><br><span class="line"></span><br><span class="line">    fake_key = <span class="built_in">list</span>(string.ascii_lowercase)</span><br><span class="line"></span><br><span class="line">    random.shuffle(fake_key)</span><br><span class="line"></span><br><span class="line">    data += <span class="string">f&quot;fake<span class="subst">&#123;i&#125;</span> = &quot;</span>+<span class="string">&quot;+&quot;</span>.join(fake_key[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>))+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">data += <span class="string">&quot;key = a+b+c+d+e+f+g+h+i+j+k+l+m+n+o+p+q+r+s+t+u+v+w+x+y+z\n&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(random.randint(<span class="number">10</span>, <span class="number">26</span>)):</span><br><span class="line"></span><br><span class="line">    fake_key = <span class="built_in">list</span>(string.ascii_lowercase)</span><br><span class="line"></span><br><span class="line">    random.shuffle(fake_key)</span><br><span class="line"></span><br><span class="line">    data += <span class="string">f&quot;fake<span class="subst">&#123;i&#125;</span> = &quot;</span>+<span class="string">&quot;+&quot;</span>.join(fake_key[j] <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">26</span>))+<span class="string">&quot;\n&quot;</span></span><br><span class="line"></span><br><span class="line">sign = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">import base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">from cryptography.hazmat.primitives.asymmetric.ed25519 import Ed25519PrivateKey</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="subst">&#123;data&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">private = base64.b64decode(key)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def sign(data: bytes) -&gt; bytes:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    key = Ed25519PrivateKey.from_private_bytes(private)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return key.sign(data)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">sign = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">__all__ = []</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">import base64</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">from cryptography.hazmat.primitives.asymmetric.ed25519 import Ed25519PrivateKey</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"><span class="subst">&#123;data&#125;</span></span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">gen_sign_func</span>(<span class="params">fake,pointer</span>):</span><br><span class="line"></span><br><span class="line">    sign_func = <span class="string">f&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    def FAKE<span class="subst">&#123;fake&#125;</span>(data: bytes) -&gt; bytes:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        def sign(data: bytes) -&gt; bytes:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            key = Ed25519PrivateKey.from_private_bytes(base64.b64decode(fake<span class="subst">&#123;fake&#125;</span>))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">            return <span class="subst">&#123;pointer&#125;</span>.sign(data)        </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        key = Ed25519PrivateKey.from_private_bytes(base64.b64decode(fake<span class="subst">&#123;fake&#125;</span>))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">        return <span class="subst">&#123;pointer&#125;</span>.sign(data)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    &quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">sign_func = []</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">20</span>):</span><br><span class="line"></span><br><span class="line">    sign_func.append(gen_sign_func(i,<span class="string">f&quot;fake<span class="subst">&#123;i+<span class="number">1</span>&#125;</span>&quot;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#這邊沒寫完</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sign.py&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">    f.write(sign)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">data+=<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def sign(data: bytes) -&gt; bytes:</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    key = Ed25519PrivateKey.from_private_bytes(base64.b64decode(key))</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    return FAKE19.sign(data)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> obfu <span class="keyword">import</span> obfu</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;sign_obfued.py&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line"></span><br><span class="line">    f.write(obfu())</span><br><span class="line"></span><br><span class="line">res = os.popen(<span class="string">&quot;python3 client.py chal create -s private_key -p public_key --program sign_obfued.py&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">res = res.splitlines()</span><br><span class="line"></span><br><span class="line">challenge_id = res[<span class="number">1</span>].split(<span class="string">&quot;:&quot;</span>)[<span class="number">1</span>].strip()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(challenge_id)</span><br><span class="line"></span><br><span class="line">res = os.popen(<span class="string">f&quot;python3 client.py patch create <span class="subst">&#123;challenge_id&#125;</span>&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(res)</span><br></pre></td></tr></table></figure>

<h3 id="解混淆-看別對patch"><a href="#解混淆-看別對patch" class="headerlink" title="解混淆(看別對patch)"></a>解混淆(看別對patch)</h3><p>第一天開始的patch都還沒很噁心，所以跟隊友就在每輪都可以拆出一些對伍的patch<br>其中有幾對我比較印象深刻的<br>首先是 thehackerscrew 的patch</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode;<span class="keyword">import</span> pickle, random;pickle.loads(b64decode(<span class="string">b&#x27;gASVTAAAAAAAAACMCWltcG9ydGxpYowNaW1wb3J0X21vZHVsZZOUjAZyYW5kb22FUpSMCGJ1aWx0aW5zjAdnZXRhdHRyk5RoAYwEc2VlZIZSTdyshVIu&#x27;</span>))</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.ed25519 <span class="keyword">import</span> Ed25519PrivateKey</span><br><span class="line"></span><br><span class="line">keys = [&lt;一堆怪怪的key&gt;]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(random.randrange(<span class="number">0</span>, <span class="built_in">len</span>(keys)))</span><br><span class="line">sk = Ed25519PrivateKey.from_private_bytes(b64decode(keys[random.randrange(<span class="number">0</span>, <span class="built_in">len</span>(keys))])[::-<span class="number">1</span>])</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> sk.sign(data)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = sys.stdin.buffer.read()</span><br><span class="line">    sys.stdout.buffer.write(sign(data))</span><br></pre></td></tr></table></figure>
<p>他塞了一堆怪怪的key，並且用pickle的方式序列化一串random有關的code，實際執行就會發現每次random出來的都一樣，但是我們一開始挖出來的key都不正確。後來我跟隊友猜測是因為環境問題，苦惱了一陣子，因為不知道要怎麼知道主辦方環境，後來才發現主辦方有給docker，所以直接開一個container然後進去抓key就行了。</p>
<p>另外一隊 defunqt 也是一樣的概念</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> b64decode, b64encode</span><br><span class="line"><span class="keyword">from</span> hashlib <span class="keyword">import</span> sha256</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> cryptography.hazmat.primitives.asymmetric.ed25519 <span class="keyword">import</span> Ed25519PrivateKey</span><br><span class="line"></span><br><span class="line">k = b64decode(<span class="string">&#x27;4P71LIODawc9SAw=&#x27;</span>)</span><br><span class="line">ct = b64decode(<span class="string">&#x27;fzFOKR3m8V+ckY4=&#x27;</span>)</span><br><span class="line"></span><br><span class="line">VVVWVVVWVVWWVVWVWVWV = <span class="string">&quot;VVVVWWWVWWWVVVWVWVWV&quot;</span></span><br><span class="line">VVVVWWWVWWWVVVWVWVWV = <span class="string">&quot;VVWVWVWWVVWWWWWVVVVW&quot;</span></span><br><span class="line">VVWVWVWWVVWWWWWVVVVW = <span class="string">&quot;WWWVVVVVWVVWWVVVWWWW&quot;</span></span><br><span class="line">WWWVVVVVWVVWWVVVWWWW = <span class="string">&quot;VVVWVVVWVVWWVVWVWVWV&quot;</span></span><br><span class="line">VVVVWWWVWWWVVVWVWVWV = <span class="string">&quot;VVWVWVWWVVWWWWWVVVVW&quot;</span></span><br><span class="line">VVWVWVWWVVWWWWWVVVVW = VVVWVVVWVVWWVVWVWVWV</span><br><span class="line">VVVWVVVWVVWWVVWVWVWV = <span class="string">&quot;VVVVWWWVWWWVVVWVWVWV&quot;</span></span><br><span class="line">VVWVWVWWVVWWWWWVVVVW = <span class="string">&quot;WWWVVVVVWVVWWVVVWWWW&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">skb64 = b64encode(sha256(<span class="built_in">eval</span>(<span class="built_in">bytes</span>(a ^ b <span class="keyword">for</span> a, b <span class="keyword">in</span> <span class="built_in">zip</span>(ct, k[::-<span class="number">1</span>]))).encode() + (VVVWVVVWVVWWVVWVWVWV + VVVVWWWVWWWVVVWVWVWV + VVWVWVWWVVWWWWWVVVVW + WWWVVVVVWVVWWVVVWWWW).encode()).digest())</span><br><span class="line">sk = Ed25519PrivateKey.from_private_bytes(b64decode(skb64))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="keyword">return</span> sk.sign(data)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = sys.stdin.buffer.read()</span><br><span class="line">    sys.stdout.buffer.write(sign(data))</span><br></pre></td></tr></table></figure>
<p>中間那段混淆是用<code>sys.version</code>去做混淆的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.10.12 (main, Sep 11 2024, 15:47:36) [GCC 11.4.0]</span><br></pre></td></tr></table></figure>
<p>這裡面有python版本跟python甚麼時候被編譯的還有GCC的版本。<br>知道有docker後直接進去抓一樣能抓到</p>
<p>接下來開始看到一些對伍用線上的混淆器<br><a target="_blank" rel="noopener" href="https://freecodingtools.org/">https://freecodingtools.org/</a><br>混淆出來大概長這樣</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_ = <span class="keyword">lambda</span> __ : <span class="built_in">__import__</span>(<span class="string">&#x27;zlib&#x27;</span>).decompress(<span class="built_in">__import__</span>(<span class="string">&#x27;base64&#x27;</span>).b64decode(__[::-<span class="number">1</span>]));<span class="built_in">exec</span>((_)(<span class="string">b&#x27;=g29Plx/f/+98r1p4LTx5y1EEeOtO24TZL0vOYyGH7jTumL2aA3A5R2ztUxfDQP9C5MRkgkeIACWIASEoDwJa+56gkMHjhKH10HPhr3Dvc6rSZS+IHYCedM7ofOa/OOv5egN1RJeALe6V6swriO6N5H9DHaXmXv8LoJ29Fg0zwlx29gkon9PitnRGT3mn9tQ00a4BAdosRc/</span></span><br></pre></td></tr></table></figure>

<p>解開的方法很簡單，把他的<code>exec(_)</code>改成<code>s=</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">50</span>):</span><br><span class="line">    s = (_)(s)[<span class="number">11</span>:-<span class="number">3</span>]</span><br></pre></td></tr></table></figure>
<p>然後印出來就可以解反混淆了<br>之後就是用bytecode相關的混淆了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> marshal,zlib;<span class="built_in">exec</span>(marshal.loads(zlib.decompress(base64.b64decode(<span class="string">&#x27;eNp1eLnvPVty1/f73gMNA8GTSCBDzkZXfr1vkm3Re9/e903Ij+7by+19u72KYAL4ExAOiZAQIudPICCYsUYy+qVEZINM5ATu78lGM5Y5fbpKpe6qUzpddepT/T8+fmf8vb/mf4m+yb/7yD7+9U...&#x27;</span>))</span><br></pre></td></tr></table></figure>

<p>抓出來就行了<br>就這樣第一天我們在最後一輪(78 round)時新patch掉了五隊，不過有七隊是可以打通的</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/7.png" class="">

<p>這邊來放一些我們沒打出來的隊伍如何做混淆的<br>先是TokyoWestern</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TWTW</span>():</span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">__decode__</span>(<span class="params">self:<span class="built_in">object</span>,_execute:<span class="built_in">str</span></span>)-&gt;<span class="built_in">exec</span>:<span class="keyword">return</span>(<span class="literal">None</span>,self._bits(_execute))[<span class="number">0</span>]</span><br><span class="line"> <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self:<span class="built_in">object</span>,_delete:<span class="built_in">int</span>=<span class="literal">False</span>,_encode:<span class="built_in">bool</span>=<span class="number">0</span>,*_tw:<span class="built_in">int</span>,**_system:<span class="built_in">int</span></span>)-&gt;<span class="built_in">exec</span>:</span><br><span class="line">  self._<span class="built_in">exec</span>,self._exit,self._bits,_delete,self._<span class="built_in">eval</span>,_system[_encode]=<span class="keyword">lambda</span> _decode:<span class="string">&quot;&quot;</span>.join(<span class="built_in">__import__</span>(self._<span class="built_in">eval</span>[<span class="number">1</span>]+self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">0</span>]+self._<span class="built_in">eval</span>[<span class="number">18</span>]+self._<span class="built_in">eval</span>[<span class="number">2</span>]+self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">8</span>]).unhexlify(<span class="built_in">str</span>(_bit)).decode()<span class="keyword">for</span> _bit <span class="keyword">in</span> <span class="built_in">str</span>(_decode).split(<span class="string">&#x27;/&#x27;</span>)),<span class="keyword">lambda</span> _delete:<span class="built_in">str</span>(_system[_encode](<span class="string">f&quot;<span class="subst">&#123;self._<span class="built_in">eval</span>[<span class="number">4</span>]+self._<span class="built_in">eval</span>[-<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">4</span>]+self._<span class="built_in">eval</span>[<span class="number">2</span>]&#125;</span>(&#x27;&#x27;.join(%s),<span class="subst">&#123;self._<span class="built_in">eval</span>[<span class="number">6</span>]+self._<span class="built_in">eval</span>[<span class="number">11</span>]+self._<span class="built_in">eval</span>[<span class="number">14</span>]+self._<span class="built_in">eval</span>[<span class="number">1</span>]+self._<span class="built_in">eval</span>[<span class="number">0</span>]+self._<span class="built_in">eval</span>[<span class="number">11</span>]+self._<span class="built_in">eval</span>[<span class="number">18</span>]&#125;</span>())&quot;</span>%<span class="built_in">list</span>(_delete))).encode(self._<span class="built_in">eval</span>[<span class="number">20</span>]+self._<span class="built_in">eval</span>[<span class="number">19</span>]+self._<span class="built_in">eval</span>[<span class="number">5</span>]+self._<span class="built_in">eval</span>[<span class="number">34</span>])<span class="keyword">if</span> _system[_encode]==<span class="built_in">eval</span> <span class="keyword">else</span> exit(),<span class="keyword">lambda</span> _rasputin:self._exit(_delete(_rasputin)),<span class="keyword">lambda</span> _delete:exit()<span class="keyword">if</span> self._<span class="built_in">eval</span>[<span class="number">15</span>]+self._<span class="built_in">eval</span>[<span class="number">17</span>]+self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">19</span>] <span class="keyword">in</span> <span class="built_in">open</span>(__file__, errors=self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">6</span>]+self._<span class="built_in">eval</span>[<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">14</span>]+self._<span class="built_in">eval</span>[<span class="number">17</span>]+self._<span class="built_in">eval</span>[<span class="number">4</span>]).read() <span class="keyword">or</span> self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">15</span>]+self._<span class="built_in">eval</span>[<span class="number">20</span>]+self._<span class="built_in">eval</span>[<span class="number">19</span>] <span class="keyword">in</span> <span class="built_in">open</span>(__file__, errors=self._<span class="built_in">eval</span>[<span class="number">8</span>]+self._<span class="built_in">eval</span>[<span class="number">6</span>]+self._<span class="built_in">eval</span>[<span class="number">13</span>]+self._<span class="built_in">eval</span>[<span class="number">14</span>]+self._<span class="built_in">eval</span>[<span class="number">17</span>]+self._<span class="built_in">eval</span>[<span class="number">4</span>]).read()<span class="keyword">else</span><span class="string">&quot;&quot;</span>.join(_delete <span class="keyword">if</span> _delete <span class="keyword">not</span> <span class="keyword">in</span> self._<span class="built_in">eval</span> <span class="keyword">else</span> self._<span class="built_in">eval</span>[self._<span class="built_in">eval</span>.index(_delete)+<span class="number">1</span> <span class="keyword">if</span> self._<span class="built_in">eval</span>.index(_delete)+<span class="number">1</span>&lt;<span class="built_in">len</span>(self._<span class="built_in">eval</span>)<span class="keyword">else</span> <span class="number">0</span>]<span class="keyword">for</span> _delete <span class="keyword">in</span> <span class="string">&quot;&quot;</span>.join(<span class="built_in">chr</span>(<span class="built_in">ord</span>(t)-<span class="number">894930</span>)<span class="keyword">if</span> t!=<span class="string">&quot;ζ&quot;</span><span class="keyword">else</span><span class="string">&quot;\n&quot;</span><span class="keyword">for</span> t <span class="keyword">in</span> self._<span class="built_in">exec</span>(_delete))),exit()<span class="keyword">if</span> _delete <span class="keyword">else</span><span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789&#x27;</span>,<span class="built_in">eval</span></span><br><span class="line">  <span class="keyword">return</span> self.__decode__(_system[(self._<span class="built_in">eval</span>[-<span class="number">1</span>]+<span class="string">&#x27;_&#x27;</span>)[-<span class="number">1</span>]+self._<span class="built_in">eval</span>[<span class="number">18</span>]+self._<span class="built_in">eval</span>[<span class="number">15</span>]+self._<span class="built_in">eval</span>[<span class="number">0</span>]+self._<span class="built_in">eval</span>[<span class="number">17</span>]+self._<span class="built_in">eval</span>[<span class="number">10</span>]+self._<span class="built_in">eval</span>[<span class="number">11</span>]+self._<span class="built_in">eval</span>[<span class="number">4</span>]])</span><br><span class="line">TWTW(_delete=<span class="literal">False</span>,_encode=<span class="literal">False</span>,_sparkle=<span class="string">&#x27;&#x27;&#x27;f39aa0ba/f39aa0be/f39aa181/</span></span><br></pre></td></tr></table></figure>

<p>跟YAATN</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    <span class="built_in">open</span>(<span class="string">&quot;/dev/shm/data&quot;</span>, <span class="string">&quot;wb&quot;</span>).write(data)</span><br><span class="line">    (oˆ_ˆo)=_=<span class="number">33</span>;o=(ˆωˆ)=(oˆ_ˆo)-(oˆ_ˆo);c=(ŎдŎ)=(ŏ_ŏ)=(oˆ_ˆo)// (oˆ_ˆo);(oˆ_ˆo)=(c^_^o);ヾˆ_ˆノ=(ì_í)=(ŏ_ŏ)+(ŎдŎ);(oˇ罒ˇo)=(ì_í)+ヾˆ_ˆノ;(눈_눈)=ヾˆ_ˆノ*(oˇ罒ˇo);(乛д乛)=(oˆ_ˆo)//ヾˆ_ˆノ;(ಠ_ಠ)=ヾˆ_ˆノ*(oˆ_ˆo);(ಥ_ಥ)=ᕕᐛᕗ=ヾˆ_ˆノ*(ಠ_ಠ);(O_o)=(o^_^o)+(ಠ_ಠ);(oェo)=(ì_í)+(ŏ_ŏ);(Θ３Θ)=(ŏ_ŏ)+(oˇ罒ˇo);(OÅO)=ヾˆ_ˆノ*(ಥ_ಥ);(TAT)=(ì_í)+(Θ３Θ);(QAQ)=(Θ３Θ)+(O_o)+(눈_눈);(ŎдŎ)=&#123;(ˆωˆ):(<span class="string">&#x27;c&#x27;</span>),(ŏ_ŏ):<span class="string">&#x27;%&gt;_&lt;%&#x27;</span>[ˆωˆ]&#125;;(ÒωÓױ)=<span class="built_in">exec</span>;(ÒωÓױ)(<span class="string">&#x27;(ˆωˆ)&#x27;</span>+<span class="string">&#x27;=&#x27;</span>+(ŎдŎ)[ˆωˆ]+((ŎдŎ)[ŏ_ŏ]+(ŎдŎ)[ˆωˆ])%((ヾˆ_ˆノ+(o^_^o)+ヾˆ_ˆノ*(oˆ_ˆo)+(oˇ罒ˇo)+(ŏ_ŏ)))+((ŎдŎ)[ŏ_ŏ]+(ŎдŎ)[ˆωˆ])%(((乛д乛)+(ŏ_ŏ)+(o^_^o)+(ಠ_ಠ))),(ŎдŎ));(ŎдŎ)[ˆωˆ]=(ŎдŎ)[<span class="string">&#x27;ˆωˆ&#x27;</span>];(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>]=(ŎдŎ)[ˆωˆ](c^_^o);(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]=(ŎдŎ)[ˆωˆ]((oˇ罒ˇo)+(O_o));(ŎдŎ)[((ì_í))]=(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[ˆωˆ](((乛д乛)+(ŏ_ŏ)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(乛д乛)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(乛д乛)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((乛д乛)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(乛д乛)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((乛д乛)+(ಠ_ಠ)))+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(QAQ)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(O_o)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(QAQ)))+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(QAQ)+(ŏ_ŏ)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((눈_눈)+(ಠ_ಠ)+(oェo)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((눈_눈)+(QAQ)+(oェo)));(ŎдŎ)[((oェo))]=(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(O_o)))+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(O_o)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((QAQ)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((O_o)+(oェo)));(ŎдŎ)[((Θ３Θ))]=(ŎдŎ)[((ì_í))]+(ŎдŎ)[ˆωˆ](((ì_í)+(눈_눈)));(ŎдŎ)[((TAT))]=(ŎдŎ)[ˆωˆ](((눈_눈)+ヾˆ_ˆノ))+(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((눈_눈)+(oェo)+(O_o)))+(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>];(ŎдŎ)[((눈_눈))]=(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[ˆωˆ](((QAQ)+(ì_í)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((QAQ)))+(ŎдŎ)[ˆωˆ](((TAT)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(ŏ_ŏ)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(눈_눈)+(ŏ_ŏ)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((QAQ)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(o^_^o)+(ŏ_ŏ)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(QAQ)))+(ŎдŎ)[ˆωˆ](((TAT)+(O_o)))+(ŎдŎ)[ˆωˆ](((O_o)+(oˇ罒ˇo)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(Θ３Θ)+(눈_눈)+(o^_^o)));(ŎдŎ)[((乛д乛))]=(<span class="string">&#x27;_&#x27;</span>)+(<span class="string">&#x27;_&#x27;</span>)+(ŎдŎ)[ˆωˆ](((O_o)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(oˇ罒ˇo)+(O_o)))+(ŎдŎ)[ˆωˆ](((QAQ)+ヾˆ_ˆノ))+(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(QAQ)))+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(QAQ)+(Θ３Θ)))+(<span class="string">&#x27;_&#x27;</span>)+(<span class="string">&#x27;_&#x27;</span>)+(ŎдŎ)[ˆωˆ](((TAT)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(o^_^o)+(ŏ_ŏ)));(ŎдŎ)[((oˇ罒ˇo))]=(ŎдŎ)[ˆωˆ](((O_o)+(oェo)))+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)+(ŏ_ŏ)))+(ŎдŎ)[ˆωˆ](((O_o)));(ŎдŎ)[((oˆ_ˆo))]=(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>]+(<span class="string">&#x27;=&#x27;</span>)+(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>];(ŎдŎ)[((o^_^o))]=(ŎдŎ)[ˆωˆ]((ヾˆ_ˆノ+(QAQ)))+(ŎдŎ)[ˆωˆ](((QAQ)+(oˇ罒ˇo)))+(ŎдŎ)[ˆωˆ](((O_o)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(QAQ)));(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]=(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(Θ３Θ)+(o^_^o)));(ŎдŎ)[((눈_눈)+(ŏ_ŏ))]=(ŎдŎ)[ˆωˆ](((o^_^o)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((ì_í)+(눈_눈)));(ŎдŎ)[((눈_눈)+(ì_í))]=(ŎдŎ)[ˆωˆ](((Θ３Θ)+(눈_눈)+(o^_^o)));(ŎдŎ)[((oェo)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((TAT)+(o^_^o)));(ŎдŎ)[((Θ３Θ)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(O_o)))+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(눈_눈)))+(ŎдŎ)[((눈_눈)+(ì_í))];(ŎдŎ)[((TAT)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((Θ３Θ)+(O_o)))+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(QAQ)))+(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(눈_눈)+(O_o)));(ŎдŎ)[((乛д乛)+(ŏ_ŏ))]=(ŎдŎ)[ˆωˆ](((o^_^o)+(ŏ_ŏ)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(oェo)+(눈_눈)))+(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>]+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(o^_^o)));(ŎдŎ)[((乛д乛)+ヾˆ_ˆノ)]=(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((ì_í)+(눈_눈)+(O_o)));(ŎдŎ)[((oェo)+(乛д乛))]=(ŎдŎ)[ˆωˆ](((ì_í)+(QAQ)));(ŎдŎ)[((Θ３Θ)+(乛д乛))]=(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(QAQ)));(ŎдŎ)[((oˇ罒ˇo)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((Θ３Θ)+(ŏ_ŏ)+(QAQ)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>];(ŎдŎ)[((oˇ罒ˇo)+(乛д乛))]=(ŎдŎ)[ˆωˆ](((QAQ)+(눈_눈)+(oェo)));(ŎдŎ)[((ŏ_ŏ)+(o^_^o))]=(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(눈_눈)+(QAQ)))+(ŎдŎ)[ˆωˆ](((O_o)+(oˇ罒ˇo)+(눈_눈)));(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]=(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(Θ３Θ)+(QAQ)));(ŎдŎ)[((Θ３Θ)+(o^_^o))]=(ŎдŎ)[((Θ３Θ)+(乛д乛))]+(ŎдŎ)[ˆωˆ](((눈_눈)+(O_o)));(ŎдŎ)[((o^_^o)+(TAT))]=(ŎдŎ)[ˆωˆ](((O_o)+(ŏ_ŏ)));(ŎдŎ)[((눈_눈)+(o^_^o))]=(ŎдŎ)[ˆωˆ](((TAT)+(O_o)));(ŎдŎ)[((oˇ罒ˇo)+(o^_^o))]=(ŎдŎ)[ˆωˆ](((o^_^o)+(Θ３Θ)+(乛д乛)))+(ŎдŎ)[ˆωˆ](((oェo)+(o^_^o)+(乛д乛)));(ŎдŎ)[((ŏ_ŏ)+(눈_눈)+(Θ３Θ))]=(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(ಠ_ಠ)+(乛д乛)));(ŎдŎ)[((ŏ_ŏ)+(乛д乛)+(Θ３Θ))]=(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>];(ŎдŎ)[((눈_눈)+(乛д乛)+(ì_í))]=(ŎдŎ)[ˆωˆ](((o^_^o)+(눈_눈)))+(ŎдŎ)[((눈_눈)+(ì_í))];(ŎдŎ)[((乛д乛)+(눈_눈)+(oェo))]=(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(QAQ)));(ŎдŎ)[((눈_눈)+(Θ３Θ)+(乛д乛))]=(ŎдŎ)[ˆωˆ](((Θ３Θ)+(눈_눈)+(ŏ_ŏ)+(ಠ_ಠ)));(ŎдŎ)[((乛д乛)+(TAT)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(눈_눈)+(QAQ)));(ŎдŎ)[((Θ３Θ)+(o^_^o)+(ŏ_ŏ))]=(ŎдŎ)[ˆωˆ](((Θ３Θ)+(ಠ_ಠ)+(ŏ_ŏ)));(ŎдŎ)[((o^_^o)+(ŏ_ŏ)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(Θ３Θ)+(눈_눈)));(ŎдŎ)[((o^_^o)+(oェo)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(o^_^o)+(乛д乛)));(ŎдŎ)[((Θ３Θ)+(o^_^o)+(눈_눈))]=(ŎдŎ)[ˆωˆ](((O_o)+(oˇ罒ˇo)+(눈_눈)));(ŎдŎ)[((o^_^o)+(눈_눈)+(oˇ罒ˇo))]=(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(Θ３Θ)+(ŏ_ŏ)+(乛д乛)));(ÒωÓױ)((ŎдŎ)[((o^_^o))]+(ŎдŎ)[((oˆ_ˆo))]+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[((눈_눈)+(Θ３Θ)+(乛д乛))]+(ŎдŎ)[((Θ３Θ)+(o^_^o)+(ŏ_ŏ))]+(ŎдŎ)[ˆωˆ](((TAT)+(ಠ_ಠ)))+(ŎдŎ)[ˆωˆ]((ヾˆ_ˆノ+(ಠ_ಠ)))+(ŎдŎ)[ˆωˆ](((QAQ)+(oェo)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(乛д乛)))+(<span class="string">&#x27;0&#x27;</span>)+(ŎдŎ)[((ŏ_ŏ)+(눈_눈)+(Θ３Θ))]+(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(乛д乛)))+(ŎдŎ)[ˆωˆ](((ì_í)+(乛д乛)+(ಠ_ಠ)))+(ŎдŎ)[((눈_눈)+(o^_^o))]+(ŎдŎ)[((o^_^o)+(눈_눈)+(oˇ罒ˇo))]+(ŎдŎ)[ˆωˆ](((ì_í)+(눈_눈)+(O_o)))+(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(TAT)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(ŏ_ŏ)+(눈_눈)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)))+(<span class="string">&#x27;O&#x27;</span>)+(<span class="string">&#x27;+&#x27;</span>)+(ŎдŎ)[((o^_^o)+(oェo)+(눈_눈))]+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[((o^_^o)+(oェo)+(눈_눈))]+(ŎдŎ)[ˆωˆ](((QAQ)))+(ŎдŎ)[((ŏ_ŏ)+(눈_눈)+(Θ３Θ))]+(ŎдŎ)[ˆωˆ](((oェo)+(ಠ_ಠ)+(乛д乛)))+(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[((ŏ_ŏ)+(눈_눈)+(Θ３Θ))]+(ŎдŎ)[ˆωˆ](((乛д乛)+(o^_^o)+(TAT)))+(ŎдŎ)[ˆωˆ](((乛д乛)+(Θ３Θ)+(ಠ_ಠ)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(oェo)+(乛д乛)))+(ŎдŎ)[ˆωˆ](((oˇ罒ˇo)+(ಠ_ಠ)))+(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(ŏ_ŏ)))+(ŎдŎ)[ˆωˆ](((QAQ)))+(ŎдŎ)[((o^_^o)+(ŏ_ŏ)+(눈_눈))]+(ŎдŎ)[((oェo)+(乛д乛))]+(ŎдŎ)[ˆωˆ](((乛д乛)+(ಠ_ಠ)+(ŏ_ŏ)))+(ŎдŎ)[((눈_눈)+(Θ３Θ)+(乛д乛))]+(ŎдŎ)[((o^_^o)+(눈_눈)+(oˇ罒ˇo))]+(ŎдŎ)[((o^_^o)+(ŏ_ŏ)+(눈_눈))]+(ŎдŎ)[((ŏ_ŏ)+(o^_^o))]+(ŎдŎ)[((Θ３Θ)+(o^_^o)+(ŏ_ŏ))]+(ŎдŎ)[ˆωˆ](((TAT)+(QAQ)))+(ŎдŎ)[ˆωˆ](((ಠ_ಠ)+(눈_눈)+(ŏ_ŏ)+(乛д乛)))+(<span class="string">&#x27;=&#x27;</span>)+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[ˆωˆ](((눈_눈)+(ì_í)))+(ŎдŎ)[((ì_í))]+(ŎдŎ)[((oˆ_ˆo))]+(ŎдŎ)[((乛д乛))]+(<span class="string">&#x27;c&#x27;</span>)+(ŎдŎ)[((Θ３Θ)+(乛д乛))]+(ŎдŎ)[((oˇ罒ˇo)+(乛д乛))]+(ŎдŎ)[((oェo)+(乛д乛))]+(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]+(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[ˆωˆ](((ŏ_ŏ)+(O_o)+(Θ３Θ)))+(ŎдŎ)[((Θ３Θ)+(乛д乛))]+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[((oェo)+(乛д乛))]+(ŎдŎ)[((눈_눈)+(o^_^o))]+(ŎдŎ)[((oˇ罒ˇo)+(乛д乛))]+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[((눈_눈)+(o^_^o))]+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[((ŏ_ŏ)+(o^_^o))]+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[((oェo)+(乛д乛))]+(ŎдŎ)[((Θ３Θ)+(o^_^o))]+(ŎдŎ)[((Θ３Θ)+(o^_^o)+(눈_눈))]+(ŎдŎ)[ˆωˆ](((O_o)+(눈_눈)))+(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]+(ŎдŎ)[ˆωˆ](((눈_눈)+(O_o)))+(ŎдŎ)[ˆωˆ](((QAQ)+(눈_눈)))+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)))+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[((乛д乛)+(눈_눈)+(oェo))]+(ŎдŎ)[((oˇ罒ˇo)+(乛д乛))]+(ŎдŎ)[((Θ３Θ)+(o^_^o)+(눈_눈))]+(ŎдŎ)[((Θ３Θ)+(o^_^o)+(눈_눈))]+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]+(ŎдŎ)[((Θ３Θ)+(o^_^o))]+(<span class="string">&#x27;c&#x27;</span>)+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[((o^_^o)+(oェo)+(눈_눈))]+(ŎдŎ)[ˆωˆ](((乛д乛)+(oˇ罒ˇo)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((o^_^o)+(oˇ罒ˇo)+(乛д乛)))+(ŎдŎ)[ˆωˆ](((乛д乛)+(o^_^o)))+(ŎдŎ)[ˆωˆ](((눈_눈)+(o^_^o)+(乛д乛)))+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[ˆωˆ](((oェo)+(o^_^o)+(눈_눈)))+(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>]+(ŎдŎ)[((TAT)+(눈_눈))]+(ŎдŎ)[ˆωˆ](((눈_눈)+(oェo)+(O_o)))+(ŎдŎ)[ˆωˆ](((O_o)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(QAQ)))+(ŎдŎ)[(ヾˆ_ˆノ+(o^_^o))]+(<span class="string">&#x27;=&#x27;</span>)+(ŎдŎ)[ˆωˆ](((oェo)+(乛д乛)+(ಠ_ಠ)+(눈_눈)))+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[((ì_í))]+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[ˆωˆ](((乛д乛)+(ಠ_ಠ)+(Θ３Θ)+(눈_눈)))+(ŎдŎ)[((눈_눈)+(乛д乛)+(ì_í))]+(ŎдŎ)[((Θ３Θ))]+(ŎдŎ)[((乛д乛)+ヾˆ_ˆノ)]+(ŎдŎ)[((oˆ_ˆo))]+(ŎдŎ)[((ì_í))]+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[((TAT)+(눈_눈))]+(<span class="string">&#x27;_&#x27;</span>)+(ŎдŎ)[((o^_^o))]+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[((oˇ罒ˇo)+(눈_눈))]+(<span class="string">&#x27;_&#x27;</span>)+(ŎдŎ)[((o^_^o)+(TAT))]+(ŎдŎ)[((oˇ罒ˇo)+(乛д乛))]+(ŎдŎ)[((oˇ罒ˇo)+(눈_눈))]+(ŎдŎ)[ˆωˆ](((Θ３Θ)+(QAQ)))+(ŎдŎ)[((oェo)+(눈_눈))]+(ŎдŎ)[((乛д乛))]+(ŎдŎ)[((o^_^o)+(TAT))]+(ŎдŎ)[((乛д乛)+(눈_눈)+(oェo))]+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[((oˇ罒ˇo)+(o^_^o))]+(ŎдŎ)[((Θ３Θ)+(ŏ_ŏ))]+(ŎдŎ)[((눈_눈)+(乛д乛)+(ì_í))]+(ŎдŎ)[((o^_^o)+(TAT))]+(ŎдŎ)[((oˇ罒ˇo)+(o^_^o))]+(ŎдŎ)[((ŏ_ŏ)+(乛д乛)+(Θ３Θ))]+(<span class="string">&#x27;c&#x27;</span>)+(<span class="string">&#x27;o&#x27;</span>)+(ŎдŎ)[((ŏ_ŏ)+(乛д乛)+(Θ３Θ))]+(ŎдŎ)[((oェo)+(눈_눈))]+(ŎдŎ)[((o^_^o))]+(ŎдŎ)[ˆωˆ](((o^_^o)+(눈_눈)))+(ŎдŎ)[((눈_눈)+(ŏ_ŏ))]+(ŎдŎ)[((oˇ罒ˇo))]+(ŎдŎ)[((oˆ_ˆo))]+(ŎдŎ)[((눈_눈))]+(ŎдŎ)[((oˇ罒ˇo))]+(ŎдŎ)[((乛д乛)+(ŏ_ŏ))]+(ŎдŎ)[((Θ３Θ)+(乛д乛))]+(ŎдŎ)[((Θ３Θ)+(눈_눈))]+(ŎдŎ)[((Θ３Θ)+(乛д乛))]+(ŎдŎ)[<span class="string">&#x27;QAQ&#x27;</span>]+(ŎдŎ)[ˆωˆ](((O_o)))+(ŎдŎ)[ˆωˆ](((oェo)+(O_o)))+(ŎдŎ)[((oェo)+(눈_눈))]+(ŎдŎ)[((눈_눈)+(ŏ_ŏ))]+(ŎдŎ)[((oェo))]+(ŎдŎ)[((oˆ_ˆo))]+(ŎдŎ)[((乛д乛)+ヾˆ_ˆノ)]+(ŎдŎ)[((눈_눈)+(ì_í))]+(ŎдŎ)[ˆωˆ](((QAQ)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((O_o)+(눈_눈)))+(ŎдŎ)[ˆωˆ](((O_o)+(ŏ_ŏ)+(Θ３Θ)))+(ŎдŎ)[ˆωˆ](((QAQ)))+(ŎдŎ)[((oェo)+(눈_눈))]+(ŎдŎ)[((oˇ罒ˇo))]+(ŎдŎ)[((눈_눈)+(ŏ_ŏ))]+(ŎдŎ)[((눈_눈))]+(ŎдŎ)[((oェo))]+(ŎдŎ)[((乛д乛)+(ŏ_ŏ))]+(ŎдŎ)[((乛д乛)+(TAT)+(눈_눈))]+(ŎдŎ)[((Θ３Θ)+(눈_눈))]+(ŎдŎ)[((乛д乛)+(TAT)+(눈_눈))]+(ŎдŎ)[((Θ３Θ)+(o^_^o))]+(ŎдŎ)[((oˇ罒ˇo)+(눈_눈))]+(ŎдŎ)[((oェo)+(눈_눈))]+(ŎдŎ)[((oェo))]+(ŎдŎ)[ˆωˆ](((눈_눈)+(o^_^o)))+(ŎдŎ)[((TAT))]+(ŎдŎ)[((o^_^o))]+(ŎдŎ)[((TAT))]+(ŎдŎ)[((乛д乛)+ヾˆ_ˆノ)]+(ŎдŎ)[((TAT))]+(ŎдŎ)[((Θ３Θ))]+(ŎдŎ)[((ŏ_ŏ)+(乛д乛)+(Θ３Θ))]+(ŎдŎ)[ˆωˆ](((oェo)+(눈_눈)+(O_o)))+(ŎдŎ)[<span class="string">&#x27;O_o&#x27;</span>]+(ŎдŎ)[((oˇ罒ˇo))]+(ŎдŎ)[((TAT))]+(ŎдŎ)[((oェo))],(ŎдŎ))</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;/dev/shm/signed&quot;</span>, <span class="string">&quot;rb&quot;</span>).read()</span><br></pre></td></tr></table></figure>
<p>在晚上的時候有解出來這個<br>透過在中間插一些print emoji的方法來看每個代表甚麼後，可以發現這裡有一些端倪，順著去去找就可以找到priv是啥了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;ˆωˆ&#x27;: &lt;built-in function chr&gt;, &#x27;O_o&#x27;: &#x27; &#x27;, &#x27;QAQ&#x27;: &#x27;e&#x27;, 2: &#x27;Ed25519PrivateKey&#x27;, 3: &#x27;signed&#x27;, 5: &#x27;Ed25519PrivateKey\n&#x27;, 7: &#x27;\ndel &#x27;, 8: &#x27;open(&quot;/dev/shm/&#x27;, 16: &quot;import(&#x27;&quot;, 4: &#x27;data&#x27;, 32: &#x27; = &#x27;, 33: &#x27;priv&#x27;, 6: &quot;&#x27;&quot;, 9: &#x27;)\n&#x27;, 10: &#x27;.&#x27;, 11: &#x27;(&#x27;, 13: &#x27;b&quot;).&#x27;, 15: &#x27;from&#x27;, 17: &#x27;&quot;, &quot;&#x27;, 18: &#x27;sk&#x27;, 19: &#x27;p&#x27;, 21: &#x27;r&#x27;, 12: &#x27;te&#x27;, 20: &#x27;y&#x27;, 34: &#x27;zm&#x27;, 35: &#x27;t&#x27;, 38: &#x27;ri&#x27;, 40: &#x27;b&#x27;, 41: &#x27;h&#x27;, 37: &#x27;64&#x27;, 14: &#x27;T&#x27;, 22: &#x27;de&#x27;, 26: &#x27;).&#x27;, 27: &#x27;as&#x27;, 29: &#x27;N&#x27;, 31: &#x27;w&#x27;, 39: &#x27;F&#x27;, 42: &#x27;M&#x27;, 44: &#x27;2&#x27;, 46: &#x27;m&#x27;, 45: &#x27;V&#x27;&#125;</span><br></pre></td></tr></table></figure>

<p>關題目後<br>我們晚上就調整了一下戰略<br>寫了一些patch跟解了其他隊伍最後一輪的混淆</p>
<h3 id="第一天-Score-board"><a href="#第一天-Score-board" class="headerlink" title="第一天 Score board"></a>第一天 Score board</h3><img src="/2024/11/11/HITCON-CTF-Final-2024/8.png" class="">



<h2 id="DAY-2"><a href="#DAY-2" class="headerlink" title="DAY 2"></a>DAY 2</h2><h3 id="開賽"><a href="#開賽" class="headerlink" title="開賽"></a>開賽</h3><p>因為早上要去講議程(10:00~11:00)所以PM換成afan，我在等議程的時候就開著電腦解<br>開賽的時候第一round，我們打通了11&#x2F;13隊<br>之後開始大家上了晚上寫的patch，變得比較難打通，但是看每隊的攻擊狀況發現，幾乎所有隊伍的patch都在不到5 round內被其他隊伍解出(我們的patch全部都沒撐到一round)</p>
<h3 id="放一些我們上的patch"><a href="#放一些我們上的patch" class="headerlink" title="放一些我們上的patch"></a>放一些我們上的patch</h3><p>開場的patch</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span> (OO0O0O000OO00OOOO :<span class="built_in">bytes</span> )-&gt;<span class="built_in">bytes</span> :</span><br><span class="line">    <span class="built_in">open</span> (<span class="string">&quot;/dev/shm/data&quot;</span>,<span class="string">&quot;wb&quot;</span>).write (OO0O0O000OO00OOOO )</span><br><span class="line">    (OOO00OOOOOO0OO0OO )=_O0OOO0OO000OO0O00 =<span class="number">3</span> ;O0OO00O00O00OO0OO =(OOO00O0OOOOOOO000 )=(OOO00OOOOOO0OO0OO )-(OOO00OOOOOO0OO0OO );<span class="comment">#line:4</span></span><br><span class="line">    O000O0OOO00O000OO =(O0OO0OOOOO0000O0O )=(OO000O00O0O0O0O0O )=(OOO00OOOOOO0OO0OO )//(OOO00OOOOOO0OO0OO );<span class="comment">#line:5</span></span><br><span class="line">    OOO00OOOOOO0OO0OO *=(O000O0OOO00O000OO +<span class="number">4</span> *(O0OO0OOOOO0000O0O )+<span class="number">6</span> *(OO000O00O0O0O0O0O ))<span class="comment">#line:6</span></span><br><span class="line">    _O0OOO0OO000OO0O00 =OOO00OOOOOO0OO0OO +O000O0OOO00O000OO +<span class="number">4</span> *(O0OO0OOOOO0000O0O )-<span class="number">5</span> *(OO000O00O0O0O0O0O )<span class="comment">#line:7</span></span><br><span class="line">    (OOO00OOOOOO0OO0OO )=(O000O0OOO00O000OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO );<span class="comment">#line:8</span></span><br><span class="line">    OO00OO0O00O0OO0OO =(OOOOO0OOO00OO0OO0 )=(OO000O00O0O0O0O0O )+(O0OO0OOOOO0000O0O );(O00O000O0O000OO0O )=(OOOOO0OOO00OO0OO0 )+OO00OO0O00O0OO0OO ;<span class="comment">#line:10</span></span><br><span class="line">    (O0OOO0O00OOOO0O0O )=OO00OO0O00O0OO0OO *(O00O000O0O000OO0O );(OO0O00O00O0O00OO0 )=(OOO00OOOOOO0OO0OO )//OO00OO0O00O0OO0OO ;<span class="comment">#line:12</span></span><br><span class="line">    (OO00OOOOOOO0OO00O )=OO00OO0O00O0OO0OO *(OOO00OOOOOO0OO0OO );(OOOOOOO0O0O000O00 )=O0O000000OOO00O0O =OO00OO0O00O0OO0OO *(OO00OOOOOOO0OO00O );<span class="comment">#line:14</span></span><br><span class="line">    (OO0OOOOO00OO00O00 )=(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO00OOOOOOO0OO00O );<span class="comment">#line:15</span></span><br><span class="line">    (OOO00000OOOOO00OO )=(OOOOO0OOO00OO0OO0 )+(OO000O00O0O0O0O0O );(O0000OOO0OOOO00O0 )=(OO000O00O0O0O0O0O )+(O00O000O0O000OO0O );<span class="comment">#line:17</span></span><br><span class="line">    (O00000O00O0000OO0 )=OO00OO0O00O0OO0OO *(OOOOOOO0O0O000O00 );(O0000OOO0OOOO00O0 )=(OO000O00O0O0O0O0O )+(O00O000O0O000OO0O );<span class="comment">#line:19</span></span><br><span class="line">    (O00O00OO0O00O0OO0 )=(OOOOO0OOO00OO0OO0 )+(O0000OOO0OOOO00O0 );(OO0O0OO0OOO0OO0OO )=(O0000OOO0OOOO00O0 )+(OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O );<span class="comment">#line:21</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )=&#123;(OOO00O0OOOOOOO000 ):(<span class="string">&#x27;c&#x27;</span>),(OO000O00O0O0O0O0O ):<span class="string">&#x27;%&gt;_&lt;%&#x27;</span>[OOO00O0OOOOOOO000 ]&#125;;(OO0O0OOOO0OO0O000 )=<span class="built_in">exec</span> ;<span class="comment">#line:23</span></span><br><span class="line">    (OO0O0OOOO0OO0O000 )(<span class="string">&#x27;(ˆωˆ)&#x27;</span>+<span class="string">&#x27;=&#x27;</span>+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ]+((O0OO0OOOOO0000O0O )[OO000O00O0O0O0O0O ]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ])%((OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+OO00OO0O00O0OO0OO *(OOO00OOOOOO0OO0OO )+(O00O000O0O000OO0O )+(OO000O00O0O0O0O0O )))+((O0OO0OOOOO0000O0O )[OO000O00O0O0O0O0O ]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ])%(((OO0O00O00O0O00OO0 )+(OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO00OOOOOOO0OO00O ))),(O0OO0OOOOO0000O0O ));<span class="comment">#line:24</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ]=(O0OO0OOOOO0000O0O )[<span class="string">&#x27;ˆωˆ&#x27;</span>];<span class="comment">#line:25</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](O000O0OOO00O000OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO );<span class="comment">#line:26</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ]((O00O000O0O000OO0O )+(OO0OOOOO00OO00O00 ));<span class="comment">#line:27</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OOOOO0OOO00OO0OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO0O00O00O0O00OO0 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO00OOOOOOO0OO00O )+(OOO00000OOOOO00OO )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0O0OO0OOO0OO0OO )+(OOO00000OOOOO00OO )));<span class="comment">#line:28</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(OO0OOOOO00OO00O00 )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(OOO00000OOOOO00OO )));<span class="comment">#line:29</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 ))]=(O0OO0OOOOO0000O0O )[((OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(O0OOO0O00OOOO0O0O )));<span class="comment">#line:30</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+OO00OO0O00O0OO0OO ))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>];<span class="comment">#line:31</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O ))]=(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(OOOOO0OOO00OO0OO0 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )));<span class="comment">#line:32</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 ))]=(<span class="string">&#x27;_&#x27;</span>)+(<span class="string">&#x27;_&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(O00O000O0O000OO0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+OO00OO0O00O0OO0OO ))+(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(<span class="string">&#x27;_&#x27;</span>)+(<span class="string">&#x27;_&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )));<span class="comment">#line:33</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(OOO00000OOOOO00OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )));<span class="comment">#line:34</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]=(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>]+(<span class="string">&#x27;=&#x27;</span>)+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>];<span class="comment">#line:35</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ]((OO00OO0O00O0OO0OO +(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O00O000O0O000OO0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:36</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )));<span class="comment">#line:37</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(O0OOO0O00OOOO0O0O )));<span class="comment">#line:38</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )));<span class="comment">#line:39</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )));<span class="comment">#line:40</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))];<span class="comment">#line:41</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O0OO0OOO0OO0OO )))+(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )));<span class="comment">#line:42</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(OO000O00O0O0O0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )));<span class="comment">#line:43</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+OO00OO0O00O0OO0OO )]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )));<span class="comment">#line:44</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:45</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:46</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>];<span class="comment">#line:47</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO )));<span class="comment">#line:48</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O )));<span class="comment">#line:49</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:50</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )));<span class="comment">#line:51</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O00OO0O00O0OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(OO000O00O0O0O0O0O )));<span class="comment">#line:52</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(OO0OOOOO00OO00O00 )));<span class="comment">#line:53</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO0O00O00O0O00OO0 )));<span class="comment">#line:54</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO00OOOOOOO0OO00O )+(OO0O00O00O0O00OO0 )));<span class="comment">#line:55</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(OO0O00O00O0O00OO0 )+(O0000OOO0OOOO00O0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>];<span class="comment">#line:56</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO0O00O00O0O00OO0 )+(OOOOO0OOO00OO0OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))];<span class="comment">#line:57</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:58</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O )+(OO00OOOOOOO0OO00O )));<span class="comment">#line:59</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(OO0O0OO0OOO0OO0OO )));<span class="comment">#line:60</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO00OOOOOOO0OO00O )+(OO000O00O0O0O0O0O )));<span class="comment">#line:61</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )));<span class="comment">#line:62</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO0O00O00O0O00OO0 )));<span class="comment">#line:63</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O )));<span class="comment">#line:64</span></span><br><span class="line">    (O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )+(O00O000O0O000OO0O ))]=(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O )+(OO0O00O00O0O00OO0 )));<span class="comment">#line:65</span></span><br><span class="line">    (OO0O0OOOO0OO0O000 )((O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ]((OO00OO0O00O0OO0OO +(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(OOO00000OOOOO00OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO0O00O00O0O00OO0 )))+(<span class="string">&#x27;0&#x27;</span>)+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(OO0O00O00O0O00OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(OO0O00O00O0O00OO0 )+(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )+(O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOOOO0OOO00OO0OO0 )+(O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(O00O00OO0O00O0OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(<span class="string">&#x27;O&#x27;</span>)+(<span class="string">&#x27;+&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO00OOOOOOO0OO00O )+(OO0O00O00O0O00OO0 )))+(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O00OO0O00O0OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(O0000OOO0OOOO00O0 )+(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O000O0O000OO0O )+(OO00OOOOOOO0OO00O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(OO00OOOOOOO0OO00O )+(OO000O00O0O0O0O0O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )+(O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O00O00OO0O00O0OO0 )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO00OOOOOOO0OO00O )+(O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(<span class="string">&#x27;=&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 )))+(O0OO0OOOOO0000O0O )[((OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 ))]+(<span class="string">&#x27;c&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO000O00O0O0O0O0O )+(OO0OOOOO00OO00O00 )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(<span class="string">&#x27;c&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(O00O000O0O000OO0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(OO0O00O00O0O00OO0 )))+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>]+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[(OO00OO0O00O0OO0OO +(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(<span class="string">&#x27;=&#x27;</span>)+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0O00O00O0O00OO0 )+(OO00OOOOOOO0OO00O )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O00O00O0O00OO0 )+(OO00OOOOOOO0OO00O )+(O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO0O00O00O0O00OO0 )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+OO00OO0O00O0OO0OO )]+(O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]+(O0OO0OOOOO0000O0O )[((OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]+(<span class="string">&#x27;_&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O ))]+(<span class="string">&#x27;_&#x27;</span>)+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0000OOO0OOOO00O0 )+(OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O0OOO0O00OOOO0O0O )+(OOO00000OOOOO00OO ))]+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO0O00O00O0O00OO0 )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(OO0O00O00O0O00OO0 )+(O0000OOO0OOOO00O0 ))]+(<span class="string">&#x27;c&#x27;</span>)+(<span class="string">&#x27;o&#x27;</span>)+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(OO0O00O00O0O00OO0 )+(O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(OO0O00O00O0O00OO0 ))]+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;afan_0918&#x27;</span>]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO ))]+(O0OO0OOOOO0000O0O )[((OOO00OOOOOO0OO0OO ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+OO00OO0O00O0OO0OO )]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OOOOO0OOO00OO0OO0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(O0OOO0O00OOOO0O0O )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0OOOOO00OO00O00 )+(OO000O00O0O0O0O0O )+(O0000OOO0OOOO00O0 )))+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OO0O0OO0OOO0OO0OO )))+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(OO000O00O0O0O0O0O ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+(O00O00OO0O00O0OO0 )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((O0OOO0O00OOOO0O0O )+(O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO )))+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0OO00O00O00OO0OO ^_O0OOO0OO000OO0O00 ^O0OO00O00O00OO0OO ))]+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((OO0O00O00O0O00OO0 )+OO00OO0O00O0OO0OO )]+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[((OO000O00O0O0O0O0O )+(OO0O00O00O0O00OO0 )+(O0000OOO0OOOO00O0 ))]+(O0OO0OOOOO0000O0O )[OOO00O0OOOOOOO000 ](((OOO00000OOOOO00OO )+(O0OOO0O00OOOO0O0O )+(OO0OOOOO00OO00O00 )))+(O0OO0OOOOO0000O0O )[<span class="string">&#x27;O_o&#x27;</span>]+(O0OO0OOOOO0000O0O )[((O00O000O0O000OO0O ))]+(O0OO0OOOOO0000O0O )[((O00O00OO0O00O0OO0 ))]+(O0OO0OOOOO0000O0O )[((OOO00000OOOOO00OO ))],(O0OO0OOOOO0000O0O ))<span class="comment">#line:66</span></span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span> (<span class="string">&quot;/dev/shm/signed&quot;</span>,<span class="string">&quot;rb&quot;</span>).read ()<span class="comment">#line:67</span></span><br><span class="line">sign (<span class="string">b&#x27;a&#x27;</span>)<span class="comment">#line:68</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>還有Curious的patch</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">b = <span class="number">256</span></span><br><span class="line">q = <span class="number">2</span>**<span class="number">255</span> - <span class="number">19</span></span><br><span class="line">l = <span class="number">2</span>**<span class="number">252</span> + <span class="number">27742317777372353535851937790883648493</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">H</span>(<span class="params">OO00OOOOO0OOO00O0</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.sha512(OO00OOOOO0OOO00O0).digest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">COOKING</span>(<span class="params">O0OOOOO00OOO00O0O, OOOOO0OO0O0O00O00</span>):</span><br><span class="line">    <span class="keyword">while</span> OOOOO0OO0O0O00O00 &gt; <span class="number">0</span>:</span><br><span class="line">        O0OOOOO00OOO00O0O = O0OOOOO00OOO00O0O * O0OOOOO00OOO00O0O % q</span><br><span class="line">        OOOOO0OO0O0O00O00 -= <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> O0OOOOO00OOO00O0O</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C00KING</span>(<span class="params">OO0000OO00O000OOO</span>):</span><br><span class="line">    OO0O0000OOOOO0000 = OO0000OO00O000OOO * OO0000OO00O000OOO % q</span><br><span class="line">    OO00000OOO0O000O0 = COOKING(OO0O0000OOOOO0000, <span class="number">2</span>) * OO0000OO00O000OOO % q</span><br><span class="line">    O000O000OOO000OOO = OO00000OOO0O000O0 * OO0O0000OOOOO0000 % q</span><br><span class="line">    OO0OOO000O0OOOO00 = (</span><br><span class="line">        (O000O000OOO000OOO * O000O000OOO000OOO) % q * OO00000OOO0O000O0 % q</span><br><span class="line">    )</span><br><span class="line">    OOO0OO0O0O0O000OO = COOKING(OO0OOO000O0OOOO00, <span class="number">5</span>) * OO0OOO000O0OOOO00 % q</span><br><span class="line">    O000000OO00OO000O = COOKING(OOO0OO0O0O0O000OO, <span class="number">10</span>) * OOO0OO0O0O0O000OO % q</span><br><span class="line">    O00000OO00OOO000O = COOKING(O000000OO00OO000O, <span class="number">20</span>) * O000000OO00OO000O % q</span><br><span class="line">    O0OO000OOOO0O0000 = COOKING(O00000OO00OOO000O, <span class="number">10</span>) * OOO0OO0O0O0O000OO % q</span><br><span class="line">    OO00OOO0O00O00OO0 = COOKING(O0OO000OOOO0O0000, <span class="number">50</span>) * O0OO000OOOO0O0000 % q</span><br><span class="line">    OOOOOOOO0OO00O00O = COOKING(OO00OOO0O00O00OO0, <span class="number">100</span>) * OO00OOO0O00O00OO0 % q</span><br><span class="line">    OOO0000O0O0O0OO0O = COOKING(OOOOOOOO0OO00O00O, <span class="number">50</span>) * O0OO000OOOO0O0000 % q</span><br><span class="line">    <span class="keyword">return</span> COOKING(OOO0000O0O0O0OO0O, <span class="number">5</span>) * O000O000OOO000OOO % q</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">d = -<span class="number">121665</span> * C00KING(<span class="number">121666</span>) % q</span><br><span class="line">I = <span class="built_in">pow</span>(<span class="number">2</span>, (q - <span class="number">1</span>) // <span class="number">4</span>, q)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C0oKING</span>(<span class="params">OO0O00O00OO0O0O00</span>):</span><br><span class="line">    OO00000O0O0OOOOO0 = (OO0O00O00OO0O0O00 * OO0O00O00OO0O0O00 - <span class="number">1</span>) * C00KING(</span><br><span class="line">        d * OO0O00O00OO0O0O00 * OO0O00O00OO0O0O00 + <span class="number">1</span></span><br><span class="line">    )</span><br><span class="line">    O000O0OOOO0OOO0OO = <span class="built_in">pow</span>(OO00000O0O0OOOOO0, (q + <span class="number">3</span>) // <span class="number">8</span>, q)</span><br><span class="line">    <span class="keyword">if</span> (O000O0OOOO0OOO0OO * O000O0OOOO0OOO0OO - OO00000O0O0OOOOO0) % q != <span class="number">0</span>:</span><br><span class="line">        O000O0OOOO0OOO0OO = (O000O0OOOO0OOO0OO * I) % q</span><br><span class="line">    <span class="keyword">if</span> O000O0OOOO0OOO0OO % <span class="number">2</span> != <span class="number">0</span>:</span><br><span class="line">        O000O0OOOO0OOO0OO = q - O000O0OOOO0OOO0OO</span><br><span class="line">    <span class="keyword">return</span> O000O0OOOO0OOO0OO</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">By = <span class="number">4</span> * C00KING(<span class="number">5</span>)</span><br><span class="line">Bx = C0oKING(By)</span><br><span class="line">B = (Bx % q, By % q, <span class="number">1</span>, (Bx * By) % q)</span><br><span class="line">ident = (<span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CooKING</span>(<span class="params">OO00OO00O0O00O0O0, OO0O0O0000OO0O000</span>):</span><br><span class="line">    (</span><br><span class="line">        OOO0OOOO000OOO0O0,</span><br><span class="line">        O000000O0000O0O00,</span><br><span class="line">        O0O0000O0O00OOOO0,</span><br><span class="line">        OO00O0O00OO000000,</span><br><span class="line">    ) = OO00OO00O0O00O0O0</span><br><span class="line">    (</span><br><span class="line">        O00O0O0O00O000OOO,</span><br><span class="line">        OO00000O0OOOOO00O,</span><br><span class="line">        OO000OO0O0O0O00OO,</span><br><span class="line">        O0000OOOO0OOOOO0O,</span><br><span class="line">    ) = OO0O0O0000OO0O000</span><br><span class="line">    OOOO0OO00OO0O000O = (</span><br><span class="line">        (O000000O0000O0O00 - OOO0OOOO000OOO0O0)</span><br><span class="line">        * (OO00000O0OOOOO00O - O00O0O0O00O000OOO)</span><br><span class="line">        % q</span><br><span class="line">    )</span><br><span class="line">    OO0OOO000OO000000 = (</span><br><span class="line">        (O000000O0000O0O00 + OOO0OOOO000OOO0O0)</span><br><span class="line">        * (OO00000O0OOOOO00O + O00O0O0O00O000OOO)</span><br><span class="line">        % q</span><br><span class="line">    )</span><br><span class="line">    O0O0O00OOO0O0OOOO = OO00O0O00OO000000 * <span class="number">2</span> * d * O0000OOOO0OOOOO0O % q</span><br><span class="line">    O0O0O000OO000O0O0 = O0O0000O0O00OOOO0 * <span class="number">2</span> * OO000OO0O0O0O00OO % q</span><br><span class="line">    O0O00OOOOOO000OOO = OO0OOO000OO000000 - OOOO0OO00OO0O000O</span><br><span class="line">    O0OOO00O0OOOO00OO = O0O0O000OO000O0O0 - O0O0O00OOO0O0OOOO</span><br><span class="line">    OO000O0OOOOOO0OOO = O0O0O000OO000O0O0 + O0O0O00OOO0O0OOOO</span><br><span class="line">    O0O0OO0OO000OOOO0 = OO0OOO000OO000000 + OOOO0OO00OO0O000O</span><br><span class="line">    O0O00OO00000O0O0O = O0O00OOOOOO000OOO * O0OOO00O0OOOO00OO</span><br><span class="line">    OO0O0OO0OO0000O0O = OO000O0OOOOOO0OOO * O0O0OO0OO000OOOO0</span><br><span class="line">    O0OOO000O000OO000 = O0O00OOOOOO000OOO * O0O0OO0OO000OOOO0</span><br><span class="line">    OOOOOOOOOO0O0O000 = O0OOO00O0OOOO00OO * OO000O0OOOOOO0OOO</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        O0O00OO00000O0O0O % q,</span><br><span class="line">        OO0O0OO0OO0000O0O % q,</span><br><span class="line">        OOOOOOOOOO0O0O000 % q,</span><br><span class="line">        O0OOO000O000OO000 % q,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Co0o0ooking</span>(<span class="params">O00OO0OOO0O0000OO</span>):</span><br><span class="line">    (</span><br><span class="line">        OO000O00OOO000000,</span><br><span class="line">        O0O000O0OO00OOO0O,</span><br><span class="line">        O0000O0O00OO000OO,</span><br><span class="line">        O000OOO0O0OOOOO00,</span><br><span class="line">    ) = O00OO0OOO0O0000OO</span><br><span class="line">    OOOO000OOOOOOOO00 = OO000O00OOO000000 * OO000O00OOO000000 % q</span><br><span class="line">    OO0OOOOO0OOOOOOO0 = O0O000O0OO00OOO0O * O0O000O0OO00OOO0O % q</span><br><span class="line">    OO00OOOOO00O000O0 = <span class="number">2</span> * O0000O0O00OO000OO * O0000O0O00OO000OO % q</span><br><span class="line">    O000O0000O000O00O = (</span><br><span class="line">        (OO000O00OOO000000 + O0O000O0OO00OOO0O)</span><br><span class="line">        * (OO000O00OOO000000 + O0O000O0OO00OOO0O)</span><br><span class="line">        - OOOO000OOOOOOOO00</span><br><span class="line">        - OO0OOOOO0OOOOOOO0</span><br><span class="line">    ) % q</span><br><span class="line">    OOO000OO0OO00OO00 = -OOOO000OOOOOOOO00 + OO0OOOOO0OOOOOOO0</span><br><span class="line">    OO000OO00O00O0000 = OOO000OO0OO00OO00 - OO00OOOOO00O000O0</span><br><span class="line">    O0O0OOOOO0OOOO0O0 = -OOOO000OOOOOOOO00 - OO0OOOOO0OOOOOOO0</span><br><span class="line">    O0O0O0OOO00OO00OO = O000O0000O000O00O * OO000OO00O00O0000</span><br><span class="line">    O0O0OO00O0O000OOO = OOO000OO0OO00OO00 * O0O0OOOOO0OOOO0O0</span><br><span class="line">    OO000OO00O00OO0OO = O000O0000O000O00O * O0O0OOOOO0OOOO0O0</span><br><span class="line">    O000000O0O00000OO = OO000OO00O00O0000 * OOO000OO0OO00OO00</span><br><span class="line">    <span class="keyword">return</span> (</span><br><span class="line">        O0O0O0OOO00OO00OO % q,</span><br><span class="line">        O0O0OO00O0O000OOO % q,</span><br><span class="line">        O000000O0O00000OO % q,</span><br><span class="line">        OO000OO00O00OO0OO % q,</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">Co0o0oo0king</span>(<span class="params">O000O000OO000O0OO, OO0O000O0O0O0OOOO</span>):</span><br><span class="line">    <span class="keyword">if</span> OO0O000O0O0O0OOOO == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> ident</span><br><span class="line">    OOO0OOOOO00O00O0O = Co0o0oo0king(O000O000OO000O0OO, OO0O000O0O0O0OOOO // <span class="number">2</span>)</span><br><span class="line">    OOO0OOOOO00O00O0O = Co0o0ooking(OOO0OOOOO00O00O0O)</span><br><span class="line">    <span class="keyword">if</span> OO0O000O0O0O0OOOO &amp; <span class="number">1</span>:</span><br><span class="line">        OOO0OOOOO00O00O0O = CooKING(OOO0OOOOO00O00O0O, O000O000OO000O0OO)</span><br><span class="line">    <span class="keyword">return</span> OOO0OOOOO00O00O0O</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Cock1ng = []</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">CooK1ng</span>():</span><br><span class="line">    OOO00OOO00O0000OO = B</span><br><span class="line">    <span class="keyword">for</span> OOOO000OO0OO0O000 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">253</span>):</span><br><span class="line">        Cock1ng.append(OOO00OOO00O0000OO)</span><br><span class="line">        OOO00OOO00O0000OO = Co0o0ooking(OOO00OOO00O0000OO)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">CooK1ng()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C00king</span>(<span class="params">OOOOO0O0O0OOO0OOO</span>):</span><br><span class="line">    OOOOO0O0O0OOO0OOO = OOOOO0O0O0OOO0OOO % l</span><br><span class="line">    OOOO0O0O000O000OO = ident</span><br><span class="line">    <span class="keyword">for</span> O0OOO000000O0OO00 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">253</span>):</span><br><span class="line">        <span class="keyword">if</span> OOOOO0O0O0OOO0OOO &amp; <span class="number">1</span>:</span><br><span class="line">            OOOO0O0O000O000OO = CooKING(OOOO0O0O000O000OO, Cock1ng[O0OOO000000O0OO00])</span><br><span class="line">        OOOOO0O0O0OOO0OOO = OOOOO0O0O0OOO0OOO // <span class="number">2</span></span><br><span class="line">    <span class="keyword">assert</span> OOOOO0O0O0OOO0OOO == <span class="number">0</span>, OOOOO0O0O0OOO0OOO</span><br><span class="line">    <span class="keyword">return</span> OOOO0O0O000O000OO</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C0000king</span>(<span class="params">O00OO0OO000O0OOO0</span>):</span><br><span class="line">    OO00O0OO0OO0OO00O = [</span><br><span class="line">        (O00OO0OO000O0OOO0 &gt;&gt; O0O00OO0O00O0O0OO) &amp; <span class="number">1</span> <span class="keyword">for</span> O0O00OO0O00O0O0OO <span class="keyword">in</span> <span class="built_in">range</span>(b)</span><br><span class="line">    ]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(</span><br><span class="line">        [</span><br><span class="line">            <span class="built_in">sum</span>(</span><br><span class="line">                [</span><br><span class="line">                    OO00O0OO0OO0OO00O[O000O00000OO0O000 * <span class="number">8</span> + OOO0O00000OO0O000]</span><br><span class="line">                    &lt;&lt; OOO0O00000OO0O000</span><br><span class="line">                    <span class="keyword">for</span> OOO0O00000OO0O000 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)</span><br><span class="line">                ]</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">for</span> O000O00000OO0O000 <span class="keyword">in</span> <span class="built_in">range</span>(b // <span class="number">8</span>)</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C00000king</span>(<span class="params">O00O0OOOO000OOO0O</span>):</span><br><span class="line">    (</span><br><span class="line">        OOO0O0000O0OO0O00,</span><br><span class="line">        OOOOO00OOOO0OO0O0,</span><br><span class="line">        O0O0O0OO000O0000O,</span><br><span class="line">        OO0000OO00O0000O0,</span><br><span class="line">    ) = O00O0OOOO000OOO0O</span><br><span class="line">    OO0O00OOOOO0OO0O0 = C00KING(O0O0O0OO000O0000O)</span><br><span class="line">    OOO0O0000O0OO0O00 = (OOO0O0000O0OO0O00 * OO0O00OOOOO0OO0O0) % q</span><br><span class="line">    OOOOO00OOOO0OO0O0 = (OOOOO00OOOO0OO0O0 * OO0O00OOOOO0OO0O0) % q</span><br><span class="line">    O0OOO000000000O0O = [</span><br><span class="line">        (OOOOO00OOOO0OO0O0 &gt;&gt; OOO0O00O00OOOOOOO) &amp; <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> OOO0O00O00OOOOOOO <span class="keyword">in</span> <span class="built_in">range</span>(b - <span class="number">1</span>)</span><br><span class="line">    ] + [OOO0O0000O0OO0O00 &amp; <span class="number">1</span>]</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">bytes</span>(</span><br><span class="line">        [</span><br><span class="line">            <span class="built_in">sum</span>(</span><br><span class="line">                [</span><br><span class="line">                    O0OOO000000000O0O[OOOO0OOO00000OO00 * <span class="number">8</span> + OO0OO00O0OOOOOOOO]</span><br><span class="line">                    &lt;&lt; OO0OO00O0OOOOOOOO</span><br><span class="line">                    <span class="keyword">for</span> OO0OO00O0OOOOOOOO <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>)</span><br><span class="line">                ]</span><br><span class="line">            )</span><br><span class="line">            <span class="keyword">for</span> OOOO0OOO00000OO00 <span class="keyword">in</span> <span class="built_in">range</span>(b // <span class="number">8</span>)</span><br><span class="line">        ]</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C00oooking</span>(<span class="params">OOOO0OOOOO00O000O, O00OOOO0O00OO0OOO</span>):</span><br><span class="line">    <span class="keyword">return</span> (OOOO0OOOOO00O000O[O00OOOO0O00OO0OOO // <span class="number">8</span>] &gt;&gt; (O00OOOO0O00OO0OOO % <span class="number">8</span>)) &amp; <span class="number">1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C0oooking</span>(<span class="params">O0O0O0OO0OO0OO0OO</span>):</span><br><span class="line">    OOOOOO0OO0OO0O000 = H(O0O0O0OO0OO0OO0OO)</span><br><span class="line">    OO000O0O0000OO0OO = <span class="number">2</span> ** (b - <span class="number">2</span>) + <span class="built_in">sum</span>(</span><br><span class="line">        <span class="number">2</span>**OO0O00OOO0O0OOOO0 * C00oooking(OOOOOO0OO0OO0O000, OO0O00OOO0O0OOOO0)</span><br><span class="line">        <span class="keyword">for</span> OO0O00OOO0O0OOOO0 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, b - <span class="number">2</span>)</span><br><span class="line">    )</span><br><span class="line">    O00O0OOOOOOOO0OO0 = C00king(OO000O0O0000OO0OO)</span><br><span class="line">    <span class="keyword">return</span> C00000king(O00O0OOOOOOOO0OO0)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">C0o0ooking</span>(<span class="params">OOO000OOO00OO00O0</span>):</span><br><span class="line">    O00OO0OO0O0000OO0 = H(OOO000OOO00OO00O0)</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">sum</span>(</span><br><span class="line">        <span class="number">2</span>**OOOO0OOO0000OO0O0 * C00oooking(O00OO0OO0O0000OO0, OOOO0OOO0000OO0O0)</span><br><span class="line">        <span class="keyword">for</span> OOOO0OOO0000OO0O0 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">2</span> * b)</span><br><span class="line">    )</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">O0OO0000OO00OOO00</span>):</span><br><span class="line">    O0OOO000O00O000O0 = <span class="string">b&quot;\x81&#x27;\x0eOj\xb8\x12/\x92+\x15\x8c\xb9\x12\xde\xf4\xa4\xd4\xe9\xea\x10\xdc\x95x\xd96X\xeb9\xa8\x88\xc5&quot;</span></span><br><span class="line">    O0O00OO0000000OO0 = <span class="string">b&#x27;\x89A\x87\xbc\x9f\xd8/\x90\xeaF\xf7\xb7%\x95\x0f\xe4\xab\x95\xb6 I\x12\xcf\x99\xef\xc2&#125;\xd9\x95/O\xf1Eh\x0be\xef\x93b\x1b\x838!\xb0\xe1\xd2e\x82,\xb1\x9c3\t\x8c\xad\xd4\xa6\xdbY\xff\x07\xc1\xbb&#125;&#x27;</span></span><br><span class="line">    OOOOO0OOOOO000O00 = <span class="number">2</span> ** (b - <span class="number">2</span>) + <span class="built_in">sum</span>(</span><br><span class="line">        <span class="number">2</span>**O0OO0000OO0OOO000 * C00oooking(O0O00OO0000000OO0, O0OO0000OO0OOO000)</span><br><span class="line">        <span class="keyword">for</span> O0OO0000OO0OOO000 <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>, b - <span class="number">2</span>)</span><br><span class="line">    )</span><br><span class="line">    O0OO0O0OOO00OOOOO = C0o0ooking(</span><br><span class="line">        <span class="built_in">bytes</span>(</span><br><span class="line">            [</span><br><span class="line">                O0O00OO0000000OO0[O00O00OO0O00OO000]</span><br><span class="line">                <span class="keyword">for</span> O00O00OO0O00OO000 <span class="keyword">in</span> <span class="built_in">range</span>(b // <span class="number">8</span>, b // <span class="number">4</span>)</span><br><span class="line">            ]</span><br><span class="line">        )</span><br><span class="line">        + O0OO0000OO00OOO00</span><br><span class="line">    )</span><br><span class="line">    OOO0O00O000OOO0OO = C00king(O0OO0O0OOO00OOOOO)</span><br><span class="line">    OOOOOOO00000O000O = (</span><br><span class="line">        O0OO0O0OOO00OOOOO</span><br><span class="line">        + C0o0ooking(</span><br><span class="line">            C00000king(OOO0O00O000OOO0OO) + O0OOO000O00O000O0 + O0OO0000OO00OOO00</span><br><span class="line">        )</span><br><span class="line">        * OOOOO0OOOOO000O00</span><br><span class="line">    ) % l</span><br><span class="line">    <span class="keyword">return</span> C00000king(OOO0O00O000OOO0OO) + C0000king(OOOOOOO00000O000O)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = sys.stdin.buffer.read()</span><br><span class="line">    sys.stdout.buffer.write(sign(data))</span><br></pre></td></tr></table></figure>

<h3 id="改變策略"><a href="#改變策略" class="headerlink" title="改變策略"></a>改變策略</h3><p>原本這題我們是有key就送，但是其實看規則就會發現，去搶前三名分數會多很多，所以第二天我們就隔兩三輪在去送key，並且也順手去補了前面round的一些坑，很明顯的狀況就比第一天好很多了(多一些round數這題可以超過RePokemonedCollections)<br>不過防禦分幾乎都拿不到(不過其他隊伍也拿不到就是了)，就全力衝攻擊</p>
<p>最後就持續解混淆跟控制送key方法來顧這題</p>
<h3 id="混淆"><a href="#混淆" class="headerlink" title="混淆"></a>混淆</h3><p>基本上第二天patch有幾隊比較特別<br>Friendly Maltese Citizens 跟	Superflat 都用shellcode的方式來做混淆</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">m = mmap.mmap(-<span class="number">1</span>, <span class="built_in">len</span>(data), prot=mmap.PROT_READ | mmap.PROT_WRITE | mmap.PROT_EXEC, flags=mmap.MAP_PRIVATE | mmap.MAP_ANONYMOUS)</span><br><span class="line">m.write(data)</span><br><span class="line"></span><br><span class="line">do_sign = ctypes.CFUNCTYPE(</span><br><span class="line">    <span class="literal">None</span>,</span><br><span class="line">    ctypes.POINTER(ctypes.c_uint8),</span><br><span class="line">    ctypes.c_uint64,</span><br><span class="line">    ctypes.POINTER(ctypes.c_uint8)</span><br><span class="line">)(ctypes.addressof(ctypes.c_size_t.from_buffer(m)))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line">    input_buf = (ctypes.c_uint8 * <span class="built_in">len</span>(data))(*data)</span><br><span class="line">    output_buf = (ctypes.c_uint8 * <span class="number">64</span>)()</span><br><span class="line">    do_sign(input_buf, <span class="built_in">len</span>(data), output_buf)</span><br><span class="line">    <span class="keyword">return</span> output_buf</span><br><span class="line"></span><br><span class="line">data = sys.stdin.buffer.read()</span><br><span class="line">sig = sign(data)</span><br><span class="line">sys.stdout.buffer.write(sig)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">SHELLCODE = gzip.decompress(base64.b64decode(SHELLCODE))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sign</span>(<span class="params">data: <span class="built_in">bytes</span></span>) -&gt; <span class="built_in">bytes</span>:</span><br><span class="line"></span><br><span class="line">    libc = ctypes.CDLL(<span class="literal">None</span>)</span><br><span class="line">    mmap = libc.mmap</span><br><span class="line">    mmap.argtypes = [c_void_p, c_size_t, c_int, c_int, c_int, c_long]</span><br><span class="line">    mmap.restype = c_void_p</span><br><span class="line">    libc.memcpy = libc.memcpy</span><br><span class="line">    libc.memcpy.argtypes = [c_void_p, c_void_p, c_size_t]</span><br><span class="line">    libc.memcpy.restype = c_void_p</span><br><span class="line"></span><br><span class="line">    NR_mmap = <span class="number">9</span></span><br><span class="line">    MAP_SHARED = <span class="number">0x01</span></span><br><span class="line">    MAP_ANONYMOUS = <span class="number">0x20</span></span><br><span class="line">    caddr = mmap(<span class="literal">None</span>, <span class="number">0x10000</span>, <span class="number">7</span>, MAP_SHARED|MAP_ANONYMOUS, -<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    msg = mmap(<span class="literal">None</span>, <span class="number">0x10000</span>, <span class="number">7</span>, MAP_SHARED|MAP_ANONYMOUS, -<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    signature = mmap(<span class="literal">None</span>, <span class="number">0x1000</span>, <span class="number">7</span>, MAP_SHARED|MAP_ANONYMOUS, -<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    public_key = mmap(<span class="literal">None</span>, <span class="number">0x1000</span>, <span class="number">7</span>, MAP_SHARED|MAP_ANONYMOUS, -<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">    private_key = mmap(<span class="literal">None</span>, <span class="number">0x1000</span>, <span class="number">7</span>, MAP_SHARED|MAP_ANONYMOUS, -<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> caddr == -<span class="number">1</span> <span class="keyword">or</span> signature == -<span class="number">1</span> <span class="keyword">or</span> msg == -<span class="number">1</span> <span class="keyword">or</span> public_key == -<span class="number">1</span> <span class="keyword">or</span> private_key == -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;mmap failed&quot;</span>)</span><br><span class="line">    caddr = caddr &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    msg = msg &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line">    signature = signature &amp; <span class="number">0xffffffffffffffff</span></span><br><span class="line"></span><br><span class="line">    public_key &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    private_key &amp;= <span class="number">0xffffffffffffffff</span></span><br><span class="line">    </span><br><span class="line">    libc.memcpy(msg, data, <span class="built_in">len</span>(data))</span><br><span class="line">    libc.memcpy(caddr, SHELLCODE, <span class="built_in">len</span>(SHELLCODE))</span><br><span class="line">    libc.memcpy(public_key, PUBLIC_KEY, <span class="built_in">len</span>(PUBLIC_KEY))</span><br><span class="line">    </span><br><span class="line">    f = ctypes.CFUNCTYPE(c_int, c_void_p, c_void_p, c_size_t, c_void_p)(caddr)(signature, msg, <span class="built_in">len</span>(data), public_key)</span><br><span class="line">    <span class="keyword">if</span> f == -<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">raise</span> Exception(<span class="string">&quot;shellcode failed&quot;</span>)</span><br><span class="line"></span><br><span class="line">    odata = ctypes.create_string_buffer(f)</span><br><span class="line">    libc.memcpy(odata, signature, f)</span><br><span class="line">    <span class="keyword">return</span> odata</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    data = sys.stdin.buffer.read()</span><br><span class="line">    sys.stdout.buffer.write(sign(data))</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>我們轉成assembly後發現也是被混淆的asm了QQ</p>
<p>最後能打通新patch的隊伍大概7組</p>
<h3 id="第二天score-board"><a href="#第二天score-board" class="headerlink" title="第二天score board"></a>第二天score board</h3><p>這題拿到了1414分</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/9.png" class="">

<h2 id="後記"><a href="#後記" class="headerlink" title="後記"></a>後記</h2><p>忘記放題單了，丟一下(偷別人的圖)</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/10.png" class="">


<p>這題蠻好玩的，看別人怎麼寫垃圾Code，跟寫垃圾code<br>我非常喜歡實體賽給人的感覺，一起在同一個空間，認真研究同一題，想怎麼拿分怎麼攻防。<br>打出來一起歡呼的感覺</p>
<p>感謝 @afan、@Curious、@Itiscaleb、@Unicorn、@Triangle_Snake、@Chisheng_Chen 一起在第一題研究。<br>另外也感謝Startburst beef stir-fried bamboofox的其他人在其他題輸出</p>
<img src="/2024/11/11/HITCON-CTF-Final-2024/11.png" class="">



      
    </div>
    <footer class="article-footer">
      
      
      
      
      
      
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/HITCON/" rel="tag">HITCON</a></li><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/web/" rel="tag">web</a></li><li class="article-tag-list-item" data-aos="zoom-in"><a class="article-tag-list-link" href="/tags/writeup/" rel="tag">writeup</a></li></ul>


    </footer>
  </div>
  
  <nav id="article-nav" data-aos="fade-up">
    
      <div class="article-nav-link-wrap article-nav-link-left">
        
          <img data-src="/images/posts_cover/FlareOn11-writeup/FlareOn11-writeup.webp" data-sizes="auto" alt="Flare-On CTF 11-writeup" class="lazyload">
        
        <a href="/2024/11/13/FlareOn-11/"></a>
        <div class="article-nav-caption">Newer</div>
        <h3 class="article-nav-title">
          
            Flare-On CTF 11-writeup
          
        </h3>
      </div>
    
    
    <div class="article-nav-link-wrap article-nav-link-right">
      
        <img data-src="/images/posts_cover/CGGC-2024-Qual-writeup/CGGC-2024-Qual-writeup.webp" data-sizes="auto" alt="2024-CGGC-Qual-writeup" class="lazyload">
      
      <a href="/2024/11/05/2024-CGGC-writeup/"></a>
      <div class="article-nav-caption">Older</div>
      <h3 class="article-nav-title">
        
          2024-CGGC-Qual-writeup
        
      </h3>
    </div>
    
  </nav>


</article>






</section>
        </div>
        
        
        <footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info">
    
    <div>
      <span class="icon-copyright"></span>
      2020-2025
      <span class="footer-info-sep rotate"></span>
      Naup堇姬
    </div>
    
      <div>
        Powered by&nbsp;<a href="https://hexo.io/" rel="noopener external nofollow noreferrer" target="_blank">Hexo</a>&nbsp;
        Theme.<a href="https://github.com/D-Sketon/hexo-theme-reimu" rel="noopener external nofollow noreferrer" target="_blank">Reimu</a>
      </div>
    
    
      <div>
        <span class="icon-brush"></span>
        149.6k
        &nbsp;|&nbsp;
        <span class="icon-coffee"></span>
        13:10
      </div>
    
    
    
    
      <div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv">Number of visits&nbsp;<span id="busuanzi_value_site_pv"></span></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv">Number of visitors&nbsp;<span id="busuanzi_value_site_uv"></span></span>
      </div>
    
  </div>
</footer>

        
          <div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div>
        
        <div id="mask" class="hide"></div>
      </div>
      <nav id="mobile-nav">
  <div class="sidebar-wrap">
    
      <div class="sidebar-toc-sidebar"><div class="sidebar-toc">
  <h3 class="toc-title">Contents</h3>
  <div class="sidebar-toc-wrapper toc-div-class" >
      
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#HITCON-CTF-Final-2024"><span class="toc-number">1.</span> <span class="toc-text">HITCON CTF Final 2024</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Day1"><span class="toc-number">1.2.</span> <span class="toc-text">Day1</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#attack"><span class="toc-number">1.2.1.</span> <span class="toc-text">attack</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#patch%E6%96%B9%E6%B3%95"><span class="toc-number">1.2.2.</span> <span class="toc-text">patch方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#auto-patch"><span class="toc-number">1.2.3.</span> <span class="toc-text">auto patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%A3%E6%B7%B7%E6%B7%86-%E7%9C%8B%E5%88%A5%E5%B0%8Dpatch"><span class="toc-number">1.2.4.</span> <span class="toc-text">解混淆(看別對patch)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%B8%80%E5%A4%A9-Score-board"><span class="toc-number">1.2.5.</span> <span class="toc-text">第一天 Score board</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#DAY-2"><span class="toc-number">1.3.</span> <span class="toc-text">DAY 2</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%96%8B%E8%B3%BD"><span class="toc-number">1.3.1.</span> <span class="toc-text">開賽</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BE%E4%B8%80%E4%BA%9B%E6%88%91%E5%80%91%E4%B8%8A%E7%9A%84patch"><span class="toc-number">1.3.2.</span> <span class="toc-text">放一些我們上的patch</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%B9%E8%AE%8A%E7%AD%96%E7%95%A5"><span class="toc-number">1.3.3.</span> <span class="toc-text">改變策略</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B7%E6%B7%86"><span class="toc-number">1.3.4.</span> <span class="toc-text">混淆</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%AC%E4%BA%8C%E5%A4%A9score-board"><span class="toc-number">1.3.5.</span> <span class="toc-text">第二天score board</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BE%8C%E8%A8%98"><span class="toc-number">1.4.</span> <span class="toc-text">後記</span></a></li></ol></li></ol>
      
  </div>
</div>
</div>
      <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img data-src="/avatar/avatar.webp" data-sizes="auto" alt="Naup堇姬" class="lazyload">
  <div class="sidebar-author-name">Naup堇姬</div>
  <div class="sidebar-description"></div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div>
    <div class="sidebar-state-number">57</div>
  </div>
  <div class="sidebar-state-category">
    <div>Categories</div>
    <div class="sidebar-state-number">0</div>
  </div>
  <div class="sidebar-state-tag">
    <div>Tags</div>
    <div class="sidebar-state-number">16</div>
  </div>
</div>
<div class="sidebar-social">
  
    <div class="icon-email sidebar-social-icon">
      <a href=naup96721@gmail.com itemprop="url" target="_blank" aria-label="email" rel="noopener external nofollow noreferrer"></a>
    </div>
  
    <div class="icon-github sidebar-social-icon">
      <a href=https://github.com/Naupjjin itemprop="url" target="_blank" aria-label="github" rel="noopener external nofollow noreferrer"></a>
    </div>
  
</div>
<div class="sidebar-menu">
  
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/" aria-label="Home"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Home</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/archives" aria-label="Archives"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">Archives</div>
      </div>
    
      <div class="sidebar-menu-link-wrap">
        <a class="sidebar-menu-link-dummy" href="/about" aria-label="About"></a>
        <div class="sidebar-menu-icon icon rotate">
          &#xe62b;
        </div>
        <div class="sidebar-menu-link">About</div>
      </div>
    
  
</div>
</div>
    
  </div>
  
    <div class="sidebar-btn-wrapper">
      <div class="sidebar-toc-btn current"></div>
      <div class="sidebar-common-btn"></div>
    </div>
  
</nav>

    </div>
    
    
<script src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js" integrity="sha384-3gT&#x2F;vsepWkfz&#x2F;ff7PpWNUeMzeWoH3cDhm&#x2F;A8jM7ouoAK0&#x2F;fP&#x2F;9bcHHR5kHq2nf+e" crossorigin="anonymous"></script>


<script src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js" integrity="sha384-J08i8An&#x2F;QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script>



<script src="/js/script.js"></script>



  
<script src="/js/aos.js"></script>

  <script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', aosInit);
    } else {
      aosInit();
    }
  </script>



<script src="/js/pjax_script.js" data-pjax></script>







  
<script src="https://npm.webcache.cn/mouse-firework@0.0.6/dist/index.umd.js" integrity="sha384-vkGvf25gm1C1PbcoD5dNfc137HzNL&#x2F;hr1RKA5HniJOaawtvUmH5lTVFgFAruE9Ge" crossorigin="anonymous"></script>

  <script>
    window.firework && window.firework(JSON.parse('{"excludeElements":["a","button"],"particles":[{"shape":"circle","move":["emit"],"easing":"easeOutExpo","colors":["#ff5252","#ff7c7c","#ffafaf","#ffd0d0"],"number":20,"duration":[1200,1800],"shapeOptions":{"radius":[16,32],"alpha":[0.3,0.5]}},{"shape":"circle","move":["diffuse"],"easing":"easeOutExpo","colors":["#ff0000"],"number":1,"duration":[1200,1800],"shapeOptions":{"radius":20,"alpha":[0.2,0.5],"lineWidth":6}}]}'))
  </script>










<div id="lazy-script">
  <div>
    
      
      
      <script data-pjax>
        window.REIMU_POST = {
          author: "Naup堇姬",
          title: "HITCON CTF Final 2024 record",
          url: "http://example.com/2024/11/11/HITCON-CTF-Final-2024/",
          excerpt: "",
          description: "",
          stripContent: "HITCON CTF Final 2024 Author: 堇姬Naup   Team: Starburst Beef Stir-Fried BambooFoxRank: r.k.10 &amp;amp; Taiwan Star  前言這是是跟台灣大聯隊-Starburst Beef Stir-Fried BambooFox，一起參加的，只有四個人在現場打，我是在飯店remote支援(有在會場附近國聯大飯店、交大、一些線上的人)   賽程在這裡    先說一下這次的結果我們是第10名及拿到了Taiwan",
          date: "Mon Nov 11 2024 18:53:02 GMT+0800",
          updated: "Tue Jan 21 2025 20:44:57 GMT+0800",
          cover: "/images/posts_cover/HITCON-CTF-Final-2024/HITCON-CTF-Final-2024.webp",
        };
      </script>
       
    
    
      
        
<script src="/js/insert_highlight.js" data-pjax></script>

        
      
    
    
      <script type="module" data-pjax>
        const PhotoSwipeLightbox = (await safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe-lightbox.esm.min.js", "sha384-DiL6M/gG+wmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF/N6lrZi/")).default;
        
        const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',
              pswpModule: () => safeImport("https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8+oTJ7m3DfYEWX1fu1scuS4+s")
            }).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script>
      








    
  </div>
</div>


  <script>
    console.log(String.raw`%c 
 ______     ______     __     __    __     __  __    
/\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
\ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
 \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
  \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                  
`,'color: #ff5252;')
    console.log('%c Theme.Reimu v' + '1.3.0' + ' %c https://github.com/D-Sketon/hexo-theme-reimu ', 'color: white; background: #ff5252; padding:5px 0;', 'padding:4px;border:1px solid #ff5252;')
  </script>
  



  
<script src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js" integrity="sha384-0M75wtSkhjIInv4coYlaJU83+OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id+S" crossorigin="anonymous" async></script>




<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.getRegistrations().then((registrations) => {
      for (let registration of registrations) {
        registration.unregister();
      }
    });
  }
</script>







  </body>
  </html>

